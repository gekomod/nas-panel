import{_ as E,s as x,r as p,o as R,b as i,A as S,d as A,e as c,g as s,w as a,F as U,l as $,h as w,f as l,n as H,k as g,I as b,t as u,m,B as O,i as Z,v as C,x as y}from"./index-naspanel.js";const F={class:"power-actions"},L={class:"action-content"},G={class:"card-header"},J={__name:"PowerActions",setup(K){const v=x([{id:"restart",type:"warning",icon:"mdi:restart",title:"Restart systemu",description:"Bezpieczny restart całego systemu NAS",buttonType:"warning",buttonIcon:"mdi:restart",buttonText:"Restartuj",loading:!1,requiresConfirmation:!0,confirmationMessage:"Czy na pewno chcesz zrestartować system?"},{id:"shutdown",type:"danger",icon:"mdi:power",title:"Wyłącz system",description:"Bezpieczne wyłączenie całego systemu NAS",buttonType:"danger",buttonIcon:"mdi:power",buttonText:"Wyłącz",loading:!1,requiresConfirmation:!0,requiresInput:!0,confirmationMessage:"Czy na pewno chcesz wyłączyć system?",inputPlaceholder:'Wpisz "POTWIERDZAM" aby kontynuować'},{id:"sleep",type:"info",icon:"mdi:sleep",title:"Tryb uśpienia",description:"Przełączenie systemu w tryb niskiego poboru mocy",buttonType:"info",buttonIcon:"mdi:sleep",buttonText:"Uśpij",loading:!1,requiresConfirmation:!0,confirmationMessage:"Czy na pewno chcesz uśpić system?"}]),h=p([]),f=p(!1),n=x({visible:!1,title:"",message:"",requiresInput:!1,inputPlaceholder:"",actionId:null}),r=p(""),T=p(null),k=async()=>{f.value=!0;try{const e=await C.get("/power/history");h.value=e.data.history}catch(e){console.error("Błąd podczas ładowania historii:",e),y.error("Nie udało się załadować historii akcji")}finally{f.value=!1}},q=e=>{T.value=e,e.requiresConfirmation?(n.title=e.title,n.message=e.confirmationMessage,n.requiresInput=e.requiresInput||!1,n.inputPlaceholder=e.inputPlaceholder||"",n.actionId=e.id,n.visible=!0,r.value=""):z(e)},P=()=>{if(n.requiresInput&&r.value!=="POTWIERDZAM"){y.warning("Nieprawidłowe potwierdzenie");return}const e=v.find(t=>t.id===n.actionId);e&&z(e),n.visible=!1},z=async e=>{e.loading=!0;try{const t=e.requiresInput?"POTWIERDZAM":void 0;await C.post("/power/action",{action:e.id,confirmation:t}),y.success(`Akcja ${e.title} wykonana pomyślnie`),await k()}catch(t){console.error("Błąd podczas wykonywania akcji:",t),y.error(`Błąd podczas wykonywania akcji: ${t.response?.data?.error||t.message}`)}finally{e.loading=!1}};return R(()=>{k()}),(e,t)=>{const _=i("el-button"),I=i("el-card"),B=i("el-col"),V=i("el-row"),d=i("el-table-column"),j=i("el-tag"),M=i("el-table"),D=i("el-input"),N=i("el-dialog"),W=S("loading");return c(),A("div",F,[s(V,{gutter:20},{default:a(()=>[(c(!0),A(U,null,$(v,o=>(c(),w(B,{span:8,key:o.id},{default:a(()=>[s(I,{shadow:"hover",class:"action-card"},{default:a(()=>[l("div",L,[l("div",{class:H(["action-icon",o.type])},[s(g(b),{icon:o.icon,width:"48"},null,8,["icon"])],2),l("h3",null,u(o.title),1),l("p",null,u(o.description),1),s(_,{type:o.buttonType,loading:o.loading,onClick:Q=>q(o),class:"action-button"},{default:a(()=>[s(g(b),{icon:o.buttonIcon,width:"16"},null,8,["icon"]),m(" "+u(o.buttonText),1)]),_:2},1032,["type","loading","onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),s(I,{shadow:"hover",style:{"margin-top":"20px"}},{header:a(()=>[l("div",G,[s(g(b),{icon:"mdi:history",width:"24"}),t[3]||(t[3]=l("h3",null,"Historia akcji",-1))])]),default:a(()=>[O((c(),w(M,{data:h.value,style:{width:"100%"}},{default:a(()=>[s(d,{prop:"timestamp",label:"Data",width:"160"}),s(d,{prop:"action",label:"Akcja"}),s(d,{prop:"status",label:"Status",width:"100"},{default:a(({row:o})=>[s(j,{type:o.status==="success"?"success":"danger"},{default:a(()=>[m(u(o.status==="success"?"Sukces":"Błąd"),1)]),_:2},1032,["type"])]),_:1}),s(d,{prop:"user",label:"Użytkownik",width:"120"})]),_:1},8,["data"])),[[W,f.value]])]),_:1}),s(N,{modelValue:n.visible,"onUpdate:modelValue":t[2]||(t[2]=o=>n.visible=o),title:n.title,width:"400px"},{footer:a(()=>[s(_,{onClick:t[1]||(t[1]=o=>n.visible=!1)},{default:a(()=>t[4]||(t[4]=[m("Anuluj")])),_:1,__:[4]}),s(_,{type:"primary",disabled:n.requiresInput&&!r.value,onClick:P},{default:a(()=>t[5]||(t[5]=[m(" Potwierdź ")])),_:1,__:[5]},8,["disabled"])]),default:a(()=>[l("p",null,u(n.message),1),n.requiresInput?(c(),w(D,{key:0,modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=o=>r.value=o),placeholder:n.inputPlaceholder,style:{"margin-top":"15px"}},null,8,["modelValue","placeholder"])):Z("",!0)]),_:1},8,["modelValue","title"])])}}},Y=E(J,[["__scopeId","data-v-251d0b12"]]);export{Y as default};
