import{_ as Ee,r as V,s as R,c as je,o as He,b as m,A as Je,d as G,e as g,g as a,f as n,w as t,k as l,I as i,t as d,h as P,m as p,F as ae,l as te,n as se,i as oe,B as Qe,v,x as r,C as ue}from"./index-naspanel.js";import{u as Xe}from"./useTheme-naspanel.js";const Ye={class:"header-content"},Ze={class:"header-left"},ea={class:"header-icon"},aa={class:"header-stats"},ta={class:"stat-item"},sa={class:"stat-icon active"},oa={class:"stat-info"},na={class:"stat-item"},la={class:"stat-icon total"},ia={class:"stat-info"},ra={class:"vpn-content"},da={class:"tab-label"},pa={class:"tab-content"},ca={class:"vpn-actions"},ua={key:1,class:"configs-grid"},fa={class:"config-card-header"},va={class:"config-title"},ma={class:"config-actions"},ga={class:"config-info"},_a={class:"info-row"},ya={class:"value"},wa={class:"info-row"},ba={class:"value"},Va={class:"info-row"},Ca={class:"value"},ka={class:"info-row"},Pa={class:"value"},ha={key:0,class:"info-row"},$a={class:"value"},Na={class:"tab-label"},Ia={class:"tab-content"},Ga={class:"vpn-actions"},Oa={class:"action-group"},Sa={key:1,class:"configs-grid"},Ka={class:"config-card-header"},Fa={class:"config-title"},Wa={class:"config-actions"},Ua={class:"config-info"},Aa={class:"info-row"},xa={class:"value"},za={class:"info-row"},Ba={class:"value"},Ta={key:0,class:"info-row"},Da={class:"value truncated"},Ma={class:"info-row"},qa={class:"value"},La={class:"info-row"},Ra={class:"value"},Ea={class:"tab-label"},ja={class:"tab-content"},Ha={class:"connection-count"},Ja={class:"tab-label"},Qa={class:"tab-content"},Xa={class:"stat-card-header"},Ya={class:"data-value"},Za={class:"stat-card-header"},et={class:"protocol-stats"},at={class:"protocol-item"},tt={class:"protocol-info"},st={class:"protocol-count"},ot={class:"protocol-active"},nt={class:"protocol-item"},lt={class:"protocol-info"},it={class:"protocol-count"},rt={class:"protocol-active"},dt={class:"protocol-item"},pt={class:"protocol-info"},ct={class:"protocol-count"},ut={class:"protocol-active"},ft={class:"status-header"},vt={class:"vpn-type"},mt={class:"key-actions"},gt={__name:"Vpn",setup(_t){const{isDarkMode:fe}=Xe(),ne=V("openvpn"),w=R({overview:!1,openvpn:!1,wireguard:!1,ipsec:!1,connections:!1}),O=R({openvpn:!1,wireguard:!1,ipsec:!1}),E=V(!1),X=V(!1),Y=V(!1),x=V(!1),W=V(!1),M=V(!1),q=V(!1),h=V(null),z=V([]),B=V([]),N=V(null),C=R({psk:"",username:"",password:""}),le=V([]),u=R({id:"",name:"",server:"",port:1194,protocol:"udp",username:"",password:"",config:""}),c=R({interface:"wg0",address:"",listenPort:51820,privateKey:"",publicKey:"",peers:[],config:""}),ve={name:[{required:!0,message:"Config name is required",trigger:"blur"}],server:[{required:!0,message:"Server address is required",trigger:"blur"}]},me={interface:[{required:!0,message:"Interface name is required",trigger:"blur"}],address:[{required:!0,message:"IP address is required",trigger:"blur"}]},ie=je(()=>(h.value?.openvpn?.configs||0)+(h.value?.wireguard?.configs||0)+(N.value?.enabled?1:0)),$=async()=>{try{w.overview=!0;const s=await v.get("/api/vpn/overview");h.value=s.data}catch{r.error("Failed to fetch VPN overview")}finally{w.overview=!1}},I=async()=>{try{w.openvpn=!0;const s=await v.get("/api/vpn/openvpn");z.value=s.data.map(e=>({...e,loading:!1}))}catch{r.error("Failed to fetch OpenVPN configurations")}finally{w.openvpn=!1}},S=async()=>{try{w.wireguard=!0;const s=await v.get("/api/vpn/wireguard");B.value=s.data.map(e=>({...e,loading:!1}))}catch{r.error("Failed to fetch WireGuard configurations")}finally{w.wireguard=!1}},U=async()=>{try{w.ipsec=!0;const s=await v.get("/api/vpn/ipsec");if(N.value=s.data.status,s.data.config?.secrets){const e=s.data.config.secrets.match(/PSK\s+"([^"]+)"/);e&&(C.psk=e[1])}}catch{r.error("Failed to fetch IPSec status")}finally{w.ipsec=!1}},T=async()=>{try{w.connections=!0;const s=await v.get("/api/vpn/connections");le.value=s.data.map(e=>({...e,loading:!1}))}catch{r.error("Failed to fetch connections")}finally{w.connections=!1}},ge=async s=>{try{const e=z.value.find(_=>_.id===s);e&&(e.loading=!0),await v.post(`/api/vpn/openvpn/${s}/start`),r.success(`OpenVPN connection ${s} started`),await I()}catch(e){r.error(`Failed to start OpenVPN: ${e.response?.data?.error||e.message}`)}},_e=async s=>{try{const e=z.value.find(_=>_.id===s);e&&(e.loading=!0),await v.post(`/api/vpn/openvpn/${s}/stop`),r.success(`OpenVPN connection ${s} stopped`),await I()}catch(e){r.error(`Failed to stop OpenVPN: ${e.response?.data?.error||e.message}`)}},ye=async s=>{try{const e=await v.get(`/api/vpn/openvpn/${s.id}`);Object.assign(u,e.data),M.value=!0,x.value=!0}catch{r.error("Failed to load OpenVPN configuration")}},we=async()=>{try{O.openvpn=!0;const s={name:u.name,server:u.server,port:u.port,protocol:u.protocol,username:u.username,password:u.password};if(u.config&&(s.config=u.config),M.value)await v.post(`/api/vpn/openvpn/${u.id}`,s),r.success("OpenVPN configuration updated");else{const e=u.name.toLowerCase().replace(/[^a-z0-9]/g,"-");await v.post(`/api/vpn/openvpn/${e}`,s),r.success("OpenVPN configuration created")}x.value=!1,await I(),await $()}catch(s){r.error(`Failed to save OpenVPN config: ${s.response?.data?.error||s.message}`)}finally{O.openvpn=!1}},be=async s=>{try{await ue.confirm(`Are you sure you want to delete "${s.name}"?`,"Confirm Delete",{type:"warning"}),await v.delete(`/api/vpn/openvpn/${s.id}`),r.success("OpenVPN configuration deleted"),await I(),await $()}catch(e){e!=="cancel"&&r.error(`Failed to delete config: ${e.response?.data?.error||e.message}`)}},Ve=async s=>{try{const e=B.value.find(_=>_.interface===s);e&&(e.loading=!0),await v.post(`/api/vpn/wireguard/${s}/up`),r.success(`WireGuard interface ${s} started`),await S()}catch(e){r.error(`Failed to start WireGuard: ${e.response?.data?.error||e.message}`)}},Ce=async s=>{try{const e=B.value.find(_=>_.interface===s);e&&(e.loading=!0),await v.post(`/api/vpn/wireguard/${s}/down`),r.success(`WireGuard interface ${s} stopped`),await S()}catch(e){r.error(`Failed to stop WireGuard: ${e.response?.data?.error||e.message}`)}},ke=async()=>{try{E.value=!0;const s=await v.get("/api/vpn/wireguard-keys/generate");W.value&&(c.privateKey=s.data.privateKey,c.publicKey=s.data.publicKey),r.success("WireGuard keys generated")}catch{r.error("Failed to generate WireGuard keys")}finally{E.value=!1}},Pe=()=>{const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";let e="";for(let _=0;_<44;_++)e+=s.charAt(Math.floor(Math.random()*s.length));c.privateKey=e,c.publicKey=e.split("").reverse().join("")},he=async s=>{try{const e=await v.get(`/api/vpn/wireguard/${s.interface}`);Object.assign(c,e.data),q.value=!0,W.value=!0}catch{r.error("Failed to load WireGuard configuration")}},$e=async()=>{try{O.wireguard=!0;const s={name:c.interface,address:c.address,listenPort:c.listenPort,privateKey:c.privateKey,peers:c.peers};c.config&&(s.config=c.config),q.value?(await v.post(`/api/vpn/wireguard/${c.interface}`,s),r.success("WireGuard configuration updated")):(await v.post(`/api/vpn/wireguard/${c.interface}`,s),r.success("WireGuard configuration created")),W.value=!1,await S(),await $()}catch(s){r.error(`Failed to save WireGuard config: ${s.response?.data?.error||s.message}`)}finally{O.wireguard=!1}},Ne=async s=>{try{await ue.confirm(`Are you sure you want to delete "${s.interface}"?`,"Confirm Delete",{type:"warning"}),await v.delete(`/api/vpn/wireguard/${s.interface}`),r.success("WireGuard configuration deleted"),await S(),await $()}catch(e){e!=="cancel"&&r.error(`Failed to delete config: ${e.response?.data?.error||e.message}`)}},Ie=()=>{c.peers.push({publicKey:"",allowedIPs:"0.0.0.0/0"})},Ge=s=>{c.peers.splice(s,1)},Oe=async()=>{try{O.ipsec=!0;const s={psk:C.psk,username:C.username,password:C.password};await v.post("/api/vpn/ipsec",s),r.success("IPSec configuration saved"),await U(),await $()}catch(s){r.error(`Failed to save IPSec config: ${s.response?.data?.error||s.message}`)}finally{O.ipsec=!1}},Se=async()=>{try{X.value=!0,await v.post("/api/vpn/ipsec/start"),r.success("IPSec service started"),await U(),await $(),await T()}catch(s){r.error(`Failed to start IPSec: ${s.response?.data?.error||s.message}`)}finally{X.value=!1}},Ke=async()=>{try{Y.value=!0,await v.post("/api/vpn/ipsec/stop"),r.success("IPSec service stopped"),await U(),await $(),await T()}catch(s){r.error(`Failed to stop IPSec: ${s.response?.data?.error||s.message}`)}finally{Y.value=!1}},Fe=async s=>{try{s.loading=!0,s.type==="openvpn"?await v.post(`/api/vpn/openvpn/${s.id}/start`):s.type==="wireguard"?await v.post(`/api/vpn/wireguard/${s.name}/up`):s.type==="ipsec"&&await v.post("/api/vpn/ipsec/start"),r.success(`${s.type} connection started`),await T(),s.type==="openvpn"&&await I(),s.type==="wireguard"&&await S(),s.type==="ipsec"&&await U(),await $()}catch(e){r.error(`Failed to start connection: ${e.response?.data?.error||e.message}`)}},We=async s=>{try{s.loading=!0,s.type==="openvpn"?await v.post(`/api/vpn/openvpn/${s.id}/stop`):s.type==="wireguard"?await v.post(`/api/vpn/wireguard/${s.name}/down`):s.type==="ipsec"&&await v.post("/api/vpn/ipsec/stop"),r.success(`${s.type} connection stopped`),await T(),s.type==="openvpn"&&await I(),s.type==="wireguard"&&await S(),s.type==="ipsec"&&await U(),await $()}catch(e){r.error(`Failed to stop connection: ${e.response?.data?.error||e.message}`)}},Ue=s=>{s.paneName==="openvpn"?I():s.paneName==="wireguard"?S():s.paneName==="ipsec"?U():s.paneName==="stats"&&$()},Ae=()=>{Object.assign(u,{id:"",name:"",server:"",port:1194,protocol:"udp",username:"",password:"",config:""}),M.value=!1},xe=()=>{Object.assign(c,{interface:"wg0",address:"",listenPort:51820,privateKey:"",publicKey:"",peers:[],config:""}),q.value=!1},re=s=>{if(s===0)return"0 B";const e=1024,_=["B","KB","MB","GB","TB"],L=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,L)).toFixed(2))+" "+_[L]},ze=s=>{if(!s)return null;try{return new Date(s).toLocaleString()}catch{return s}},Be=s=>({openvpn:"mdi:lock",wireguard:"mdi:tunnel",ipsec:"mdi:shield-lock"})[s]||"mdi:connection";return He(()=>{$(),I(),T()}),(s,e)=>{const _=m("el-card"),L=m("el-badge"),f=m("el-button"),Z=m("el-alert"),D=m("el-tag"),K=m("el-icon"),j=m("el-tab-pane"),Te=m("el-tooltip"),y=m("el-form-item"),F=m("el-col"),H=m("el-row"),b=m("el-input"),ee=m("el-form"),J=m("el-descriptions-item"),De=m("el-descriptions"),Me=m("el-tabs"),A=m("el-table-column"),qe=m("el-table"),de=m("el-input-number"),pe=m("el-option"),Le=m("el-select"),ce=m("el-dialog"),Re=Je("loading");return g(),G("div",{class:se(["vpn-container",{"dark-mode":l(fe)}])},[a(_,{class:"dashboard-header",shadow:"hover"},{default:t(()=>[n("div",Ye,[n("div",Ze,[n("div",ea,[a(l(i),{icon:"mdi:vpn"})]),e[22]||(e[22]=n("div",{class:"header-text"},[n("h1",null,"VPN Configuration"),n("p",{class:"subtitle"},"Manage VPN connections and secure your network traffic")],-1))]),n("div",aa,[n("div",ta,[n("div",sa,[a(l(i),{icon:"mdi:connection"})]),n("div",oa,[n("h3",null,d(h.value?.statistics?.activeConnections||0),1),e[23]||(e[23]=n("p",null,"Active Connections",-1))])]),n("div",na,[n("div",la,[a(l(i),{icon:"mdi:server-network"})]),n("div",ia,[n("h3",null,d(ie.value),1),e[24]||(e[24]=n("p",null,"Total Configs",-1))])])])])]),_:1}),n("div",ra,[a(_,{class:"vpn-card",shadow:"hover"},{default:t(()=>[a(Me,{modelValue:ne.value,"onUpdate:modelValue":e[5]||(e[5]=o=>ne.value=o),type:"card",class:"vpn-tabs",onTabClick:Ue},{default:t(()=>[a(j,{name:"openvpn"},{label:t(()=>[n("span",da,[a(l(i),{icon:"mdi:lock-outline"}),e[25]||(e[25]=p(" OpenVPN ")),a(L,{value:z.value.length,max:99,class:"tab-badge"},null,8,["value"])])]),default:t(()=>[n("div",pa,[n("div",ca,[a(f,{type:"primary",onClick:e[0]||(e[0]=o=>x.value=!0),class:"add-button"},{default:t(()=>[a(l(i),{icon:"mdi:plus"}),e[26]||(e[26]=p(" Add OpenVPN Config "))]),_:1,__:[26]}),a(f,{type:"info",onClick:I,loading:w.openvpn},{default:t(()=>[a(l(i),{icon:"mdi:refresh"}),e[27]||(e[27]=p(" Refresh Status "))]),_:1,__:[27]},8,["loading"])]),z.value.length===0&&!w.openvpn?(g(),P(Z,{key:0,type:"info",title:"No OpenVPN Configurations",closable:!1,class:"empty-alert"},{icon:t(()=>[a(l(i),{icon:"mdi:information"})]),default:t(()=>[e[28]||(e[28]=n("p",null,"No OpenVPN configurations found. Add your first configuration to get started.",-1))]),_:1,__:[28]})):(g(),G("div",ua,[(g(!0),G(ae,null,te(z.value,o=>(g(),P(_,{key:o.id,class:se(["config-card",{active:o.active}]),shadow:"hover"},{header:t(()=>[n("div",fa,[n("div",va,[a(l(i),{icon:"mdi:lock"}),n("h4",null,d(o.name),1),a(D,{type:o.active?"success":"info",size:"small",effect:"dark"},{default:t(()=>[p(d(o.active?"Active":"Inactive"),1)]),_:2},1032,["type"])]),n("div",ma,[o.active?(g(),P(f,{key:1,type:"danger",size:"small",circle:"",onClick:k=>_e(o.id),loading:o.loading},{default:t(()=>[a(K,null,{default:t(()=>[a(l(i),{icon:"mdi:stop"})]),_:1})]),_:2},1032,["onClick","loading"])):(g(),P(f,{key:0,type:"success",size:"small",circle:"",onClick:k=>ge(o.id),loading:o.loading},{default:t(()=>[a(K,null,{default:t(()=>[a(l(i),{icon:"mdi:play"})]),_:1})]),_:2},1032,["onClick","loading"])),a(f,{type:"warning",size:"small",circle:"",onClick:k=>ye(o)},{default:t(()=>[a(K,null,{default:t(()=>[a(l(i),{icon:"mdi:pencil"})]),_:1})]),_:2},1032,["onClick"]),a(f,{type:"danger",size:"small",circle:"",onClick:k=>be(o)},{default:t(()=>[a(K,null,{default:t(()=>[a(l(i),{icon:"mdi:delete"})]),_:1})]),_:2},1032,["onClick"])])])]),default:t(()=>[n("div",ga,[n("div",_a,[a(l(i),{icon:"mdi:server"}),e[29]||(e[29]=n("span",{class:"label"},"Server:",-1)),n("span",ya,d(o.server),1)]),n("div",wa,[a(l(i),{icon:"mdi:account"}),e[30]||(e[30]=n("span",{class:"label"},"Username:",-1)),n("span",ba,d(o.username),1)]),n("div",Va,[a(l(i),{icon:"mdi:port"}),e[31]||(e[31]=n("span",{class:"label"},"Port:",-1)),n("span",Ca,d(o.port),1)]),n("div",ka,[a(l(i),{icon:"mdi:protocol"}),e[32]||(e[32]=n("span",{class:"label"},"Protocol:",-1)),n("span",Pa,d(o.protocol),1)]),o.uptime?(g(),G("div",ha,[a(l(i),{icon:"mdi:timer"}),e[33]||(e[33]=n("span",{class:"label"},"Uptime:",-1)),n("span",$a,d(o.uptime),1)])):oe("",!0)])]),_:2},1032,["class"]))),128))]))])]),_:1}),a(j,{name:"wireguard"},{label:t(()=>[n("span",Na,[a(l(i),{icon:"mdi:tunnel"}),e[34]||(e[34]=p(" WireGuard ")),a(L,{value:B.value.length,max:99,class:"tab-badge"},null,8,["value"])])]),default:t(()=>[n("div",Ia,[n("div",Ga,[n("div",Oa,[a(f,{type:"primary",onClick:e[1]||(e[1]=o=>W.value=!0),class:"add-button"},{default:t(()=>[a(l(i),{icon:"mdi:plus"}),e[35]||(e[35]=p(" Add WireGuard Config "))]),_:1,__:[35]}),a(f,{type:"success",onClick:ke,loading:E.value},{default:t(()=>[a(l(i),{icon:"mdi:key-variant"}),e[36]||(e[36]=p(" Generate Keys "))]),_:1,__:[36]},8,["loading"])]),a(f,{type:"info",onClick:S,loading:w.wireguard},{default:t(()=>[a(l(i),{icon:"mdi:refresh"}),e[37]||(e[37]=p(" Refresh Status "))]),_:1,__:[37]},8,["loading"])]),B.value.length===0&&!w.wireguard?(g(),P(Z,{key:0,type:"info",title:"No WireGuard Configurations",closable:!1,class:"empty-alert"},{icon:t(()=>[a(l(i),{icon:"mdi:information"})]),default:t(()=>[e[38]||(e[38]=n("p",null,"No WireGuard configurations found. Add your first configuration to get started.",-1))]),_:1,__:[38]})):(g(),G("div",Sa,[(g(!0),G(ae,null,te(B.value,o=>(g(),P(_,{key:o.interface,class:se(["config-card",{active:o.peers&&o.peers.length>0}]),shadow:"hover"},{header:t(()=>[n("div",Ka,[n("div",Fa,[a(l(i),{icon:"mdi:tunnel"}),n("h4",null,d(o.interface),1),a(D,{type:o.peers?.length>0?"success":"info",size:"small",effect:"dark"},{default:t(()=>[p(d(o.peers?.length>0?"Active":"Inactive"),1)]),_:2},1032,["type"])]),n("div",Wa,[o.active?(g(),P(f,{key:1,type:"danger",size:"small",circle:"",onClick:k=>Ce(o.interface),loading:o.loading},{default:t(()=>[a(K,null,{default:t(()=>[a(l(i),{icon:"mdi:stop"})]),_:1})]),_:2},1032,["onClick","loading"])):(g(),P(f,{key:0,type:"success",size:"small",circle:"",onClick:k=>Ve(o.interface),loading:o.loading},{default:t(()=>[a(K,null,{default:t(()=>[a(l(i),{icon:"mdi:play"})]),_:1})]),_:2},1032,["onClick","loading"])),a(f,{type:"warning",size:"small",circle:"",onClick:k=>he(o)},{default:t(()=>[a(K,null,{default:t(()=>[a(l(i),{icon:"mdi:pencil"})]),_:1})]),_:2},1032,["onClick"]),a(f,{type:"danger",size:"small",circle:"",onClick:k=>Ne(o)},{default:t(()=>[a(K,null,{default:t(()=>[a(l(i),{icon:"mdi:delete"})]),_:1})]),_:2},1032,["onClick"])])])]),default:t(()=>[n("div",Ua,[n("div",Aa,[a(l(i),{icon:"mdi:server"}),e[39]||(e[39]=n("span",{class:"label"},"Interface:",-1)),n("span",xa,d(o.interface),1)]),n("div",za,[a(l(i),{icon:"mdi:ip"}),e[40]||(e[40]=n("span",{class:"label"},"Address:",-1)),n("span",Ba,d(o.address||"Not configured"),1)]),o.publicKey?(g(),G("div",Ta,[a(l(i),{icon:"mdi:key"}),e[41]||(e[41]=n("span",{class:"label"},"Public Key:",-1)),a(Te,{content:o.publicKey},{default:t(()=>[n("span",Da,d(o.publicKey.substring(0,20))+"...",1)]),_:2},1032,["content"])])):oe("",!0),n("div",Ma,[a(l(i),{icon:"mdi:account-group"}),e[42]||(e[42]=n("span",{class:"label"},"Peers:",-1)),n("span",qa,d(o.peers?.length||0),1)]),n("div",La,[a(l(i),{icon:"mdi:port"}),e[43]||(e[43]=n("span",{class:"label"},"Port:",-1)),n("span",Ra,d(o.listenPort||"51820"),1)])])]),_:2},1032,["class"]))),128))]))])]),_:1}),a(j,{name:"ipsec"},{label:t(()=>[n("span",Ea,[a(l(i),{icon:"mdi:shield-lock-outline"}),e[44]||(e[44]=p(" IPSec/L2TP "))])]),default:t(()=>[n("div",ja,[a(ee,{model:C,"label-position":"top"},{default:t(()=>[a(H,{gutter:20},{default:t(()=>[a(F,{span:12},{default:t(()=>[a(y,{label:"IPSec Status"},{default:t(()=>[a(D,{type:N.value?.running?"success":"danger",size:"large",effect:"dark"},{default:t(()=>[p(d(N.value?.running?"Running":"Stopped"),1)]),_:1},8,["type"])]),_:1})]),_:1}),a(F,{span:12},{default:t(()=>[a(y,{label:"Active Connections"},{default:t(()=>[n("span",Ha,d(N.value?.connections||0),1)]),_:1})]),_:1})]),_:1}),a(y,{label:"Pre-shared Key (PSK)",prop:"psk"},{default:t(()=>[a(b,{modelValue:C.psk,"onUpdate:modelValue":e[2]||(e[2]=o=>C.psk=o),type:"password","show-password":"",placeholder:"Enter pre-shared key"},null,8,["modelValue"])]),_:1}),a(H,{gutter:20},{default:t(()=>[a(F,{span:12},{default:t(()=>[a(y,{label:"Username",prop:"username"},{default:t(()=>[a(b,{modelValue:C.username,"onUpdate:modelValue":e[3]||(e[3]=o=>C.username=o),placeholder:"VPN username"},null,8,["modelValue"])]),_:1})]),_:1}),a(F,{span:12},{default:t(()=>[a(y,{label:"Password",prop:"password"},{default:t(()=>[a(b,{modelValue:C.password,"onUpdate:modelValue":e[4]||(e[4]=o=>C.password=o),type:"password","show-password":"",placeholder:"VPN password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(y,null,{default:t(()=>[a(f,{type:"primary",onClick:Oe,loading:w.ipsec},{default:t(()=>[a(l(i),{icon:"mdi:content-save"}),e[45]||(e[45]=p(" Save Configuration "))]),_:1,__:[45]},8,["loading"]),a(f,{type:"success",onClick:Se,disabled:!C.enabled,loading:X.value},{default:t(()=>[a(l(i),{icon:"mdi:play"}),e[46]||(e[46]=p(" Start IPSec "))]),_:1,__:[46]},8,["disabled","loading"]),a(f,{type:"danger",onClick:Ke,disabled:!N.value?.running,loading:Y.value},{default:t(()=>[a(l(i),{icon:"mdi:stop"}),e[47]||(e[47]=p(" Stop IPSec "))]),_:1,__:[47]},8,["disabled","loading"]),a(f,{type:"info",onClick:U,loading:w.ipsec},{default:t(()=>[a(l(i),{icon:"mdi:refresh"}),e[48]||(e[48]=p(" Refresh "))]),_:1,__:[48]},8,["loading"])]),_:1})]),_:1},8,["model"]),N.value?.enabled?oe("",!0):(g(),P(Z,{key:0,type:"warning",title:"IPSec/L2TP is not configured",closable:!1,class:"info-alert"},{icon:t(()=>[a(l(i),{icon:"mdi:alert"})]),default:t(()=>[e[49]||(e[49]=n("p",null,"Configure IPSec/L2TP settings and save to enable the VPN server.",-1))]),_:1,__:[49]}))])]),_:1}),a(j,{name:"stats"},{label:t(()=>[n("span",Ja,[a(l(i),{icon:"mdi:chart-box"}),e[50]||(e[50]=p(" Statistics "))])]),default:t(()=>[n("div",Qa,[a(H,{gutter:20},{default:t(()=>[a(F,{span:12},{default:t(()=>[a(_,{shadow:"never",class:"stat-card"},{header:t(()=>[n("div",Xa,[a(l(i),{icon:"mdi:chart-pie"}),e[51]||(e[51]=n("span",null,"Connection Overview",-1))])]),default:t(()=>[a(De,{column:1,border:""},{default:t(()=>[a(J,{label:"Total Configurations"},{default:t(()=>[a(D,{type:"info"},{default:t(()=>[p(d(ie.value),1)]),_:1})]),_:1}),a(J,{label:"Active Connections"},{default:t(()=>[a(D,{type:"success"},{default:t(()=>[p(d(h.value?.statistics?.activeConnections||0),1)]),_:1})]),_:1}),a(J,{label:"Data Transferred"},{default:t(()=>[n("span",Ya,d(re(h.value?.statistics?.totalBytes||0)),1)]),_:1}),a(J,{label:"Last Connection"},{default:t(()=>[p(d(ze(h.value?.statistics?.lastConnection)||"Never"),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(F,{span:12},{default:t(()=>[a(_,{shadow:"never",class:"stat-card"},{header:t(()=>[n("div",Za,[a(l(i),{icon:"mdi:connection"}),e[52]||(e[52]=n("span",null,"Protocol Distribution",-1))])]),default:t(()=>[n("div",et,[n("div",at,[a(l(i),{icon:"mdi:lock",class:"protocol-icon openvpn"}),n("div",tt,[e[53]||(e[53]=n("span",{class:"protocol-name"},"OpenVPN",-1)),n("span",st,d(h.value?.openvpn?.configs||0)+" configs",1)]),n("span",ot,d(h.value?.openvpn?.active?"Active":"Inactive"),1)]),n("div",nt,[a(l(i),{icon:"mdi:tunnel",class:"protocol-icon wireguard"}),n("div",lt,[e[54]||(e[54]=n("span",{class:"protocol-name"},"WireGuard",-1)),n("span",it,d(h.value?.wireguard?.configs||0)+" configs",1)]),n("span",rt,d(h.value?.wireguard?.active?"Active":"Inactive"),1)]),n("div",dt,[a(l(i),{icon:"mdi:shield-lock",class:"protocol-icon ipsec"}),n("div",pt,[e[55]||(e[55]=n("span",{class:"protocol-name"},"IPSec",-1)),n("span",ct,d(N.value?.enabled?"1 config":"Not configured"),1)]),n("span",ut,d(N.value?.running?"Active":"Inactive"),1)])])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(_,{class:"status-card",shadow:"hover"},{header:t(()=>[n("div",ft,[n("h3",null,[a(l(i),{icon:"mdi:connection"}),e[56]||(e[56]=p(" Connection Status "))]),a(f,{size:"small",onClick:T,loading:w.connections},{default:t(()=>[a(l(i),{icon:"mdi:refresh"}),e[57]||(e[57]=p(" Refresh All "))]),_:1,__:[57]},8,["loading"])])]),default:t(()=>[Qe((g(),P(qe,{data:le.value,style:{width:"100%"},"empty-text":"No active VPN connections"},{default:t(()=>[a(A,{label:"VPN Type",width:"120"},{default:t(({row:o})=>[n("div",vt,[a(l(i),{icon:Be(o.type)},null,8,["icon"]),p(" "+d(o.type),1)])]),_:1}),a(A,{prop:"name",label:"Configuration"}),a(A,{label:"Status",width:"120"},{default:t(({row:o})=>[a(D,{type:o.status==="Connected"?"success":"danger",effect:"dark",class:"status-tag"},{default:t(()=>[a(l(i),{icon:o.status==="Connected"?"mdi:check-circle":"mdi:close-circle"},null,8,["icon"]),p(" "+d(o.status),1)]),_:2},1032,["type"])]),_:1}),a(A,{prop:"ip",label:"IP Address",width:"140"}),a(A,{prop:"uptime",label:"Uptime",width:"100"}),a(A,{label:"Data Transferred",width:"140"},{default:t(({row:o})=>[p(d(re(o.bytes)),1)]),_:1}),a(A,{label:"Actions",width:"120"},{default:t(({row:o})=>[o.status==="Connected"?(g(),P(f,{key:0,type:"danger",size:"small",onClick:k=>We(o),loading:o.loading},{default:t(()=>[a(l(i),{icon:"mdi:stop"}),e[58]||(e[58]=p(" Stop "))]),_:2,__:[58]},1032,["onClick","loading"])):(g(),P(f,{key:1,type:"success",size:"small",onClick:k=>Fe(o),loading:o.loading},{default:t(()=>[a(l(i),{icon:"mdi:play"}),e[59]||(e[59]=p(" Start "))]),_:2,__:[59]},1032,["onClick","loading"]))]),_:1})]),_:1},8,["data"])),[[Re,w.connections]])]),_:1})]),a(ce,{modelValue:x.value,"onUpdate:modelValue":e[14]||(e[14]=o=>x.value=o),title:M.value?"Edit OpenVPN Config":"Add OpenVPN Config",width:"600px",onClosed:Ae},{footer:t(()=>[a(f,{onClick:e[13]||(e[13]=o=>x.value=!1)},{default:t(()=>e[60]||(e[60]=[p("Cancel")])),_:1,__:[60]}),a(f,{type:"primary",onClick:we,loading:O.openvpn},{default:t(()=>[p(d(M.value?"Update":"Save"),1)]),_:1},8,["loading"])]),default:t(()=>[a(ee,{model:u,rules:ve,ref:"openVpnForm","label-width":"120px"},{default:t(()=>[a(y,{label:"Config Name",prop:"name"},{default:t(()=>[a(b,{modelValue:u.name,"onUpdate:modelValue":e[6]||(e[6]=o=>u.name=o),placeholder:"My VPN Connection"},null,8,["modelValue"])]),_:1}),a(y,{label:"Server Address",prop:"server"},{default:t(()=>[a(b,{modelValue:u.server,"onUpdate:modelValue":e[7]||(e[7]=o=>u.server=o),placeholder:"vpn.example.com"},null,8,["modelValue"])]),_:1}),a(H,{gutter:20},{default:t(()=>[a(F,{span:12},{default:t(()=>[a(y,{label:"Port",prop:"port"},{default:t(()=>[a(de,{modelValue:u.port,"onUpdate:modelValue":e[8]||(e[8]=o=>u.port=o),min:1,max:65535},null,8,["modelValue"])]),_:1})]),_:1}),a(F,{span:12},{default:t(()=>[a(y,{label:"Protocol",prop:"protocol"},{default:t(()=>[a(Le,{modelValue:u.protocol,"onUpdate:modelValue":e[9]||(e[9]=o=>u.protocol=o)},{default:t(()=>[a(pe,{label:"UDP",value:"udp"}),a(pe,{label:"TCP",value:"tcp"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(y,{label:"Username",prop:"username"},{default:t(()=>[a(b,{modelValue:u.username,"onUpdate:modelValue":e[10]||(e[10]=o=>u.username=o),placeholder:"vpnuser"},null,8,["modelValue"])]),_:1}),a(y,{label:"Password",prop:"password"},{default:t(()=>[a(b,{modelValue:u.password,"onUpdate:modelValue":e[11]||(e[11]=o=>u.password=o),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(y,{label:"Config File (Optional)"},{default:t(()=>[a(b,{modelValue:u.config,"onUpdate:modelValue":e[12]||(e[12]=o=>u.config=o),type:"textarea",rows:6,placeholder:"Paste OpenVPN configuration here, or fill fields above"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),a(ce,{modelValue:W.value,"onUpdate:modelValue":e[21]||(e[21]=o=>W.value=o),title:q.value?"Edit WireGuard Config":"Add WireGuard Config",width:"700px",onClosed:xe},{footer:t(()=>[a(f,{onClick:e[20]||(e[20]=o=>W.value=!1)},{default:t(()=>e[63]||(e[63]=[p("Cancel")])),_:1,__:[63]}),a(f,{type:"primary",onClick:$e,loading:O.wireguard},{default:t(()=>[p(d(q.value?"Update":"Save"),1)]),_:1},8,["loading"])]),default:t(()=>[a(ee,{model:c,rules:me,ref:"wireGuardForm","label-width":"140px"},{default:t(()=>[a(y,{label:"Interface Name",prop:"interface"},{default:t(()=>[a(b,{modelValue:c.interface,"onUpdate:modelValue":e[15]||(e[15]=o=>c.interface=o),placeholder:"wg0"},null,8,["modelValue"])]),_:1}),a(y,{label:"IP Address",prop:"address"},{default:t(()=>[a(b,{modelValue:c.address,"onUpdate:modelValue":e[16]||(e[16]=o=>c.address=o),placeholder:"10.0.0.1/24"},null,8,["modelValue"])]),_:1}),a(y,{label:"Listen Port",prop:"listenPort"},{default:t(()=>[a(de,{modelValue:c.listenPort,"onUpdate:modelValue":e[17]||(e[17]=o=>c.listenPort=o),min:1,max:65535},null,8,["modelValue"])]),_:1}),a(y,{label:"Private Key",prop:"privateKey"},{default:t(()=>[a(b,{modelValue:c.privateKey,"onUpdate:modelValue":e[18]||(e[18]=o=>c.privateKey=o),type:"textarea",rows:3,placeholder:"Base64 encoded private key"},null,8,["modelValue"]),n("div",mt,[a(f,{size:"small",onClick:Pe,loading:E.value},{default:t(()=>[a(l(i),{icon:"mdi:key-variant"}),e[61]||(e[61]=p(" Generate New Keys "))]),_:1,__:[61]},8,["loading"])])]),_:1}),a(y,{label:"Peers"},{default:t(()=>[(g(!0),G(ae,null,te(c.peers,(o,k)=>(g(),G("div",{key:k,class:"peer-item"},[a(b,{modelValue:o.publicKey,"onUpdate:modelValue":Q=>o.publicKey=Q,placeholder:"Peer Public Key",style:{"margin-bottom":"8px"}},null,8,["modelValue","onUpdate:modelValue"]),a(b,{modelValue:o.allowedIPs,"onUpdate:modelValue":Q=>o.allowedIPs=Q,placeholder:"Allowed IPs (e.g., 0.0.0.0/0)"},null,8,["modelValue","onUpdate:modelValue"]),a(f,{type:"danger",size:"small",circle:"",onClick:Q=>Ge(k),style:{"margin-left":"8px"}},{default:t(()=>[a(l(i),{icon:"mdi:delete"})]),_:2},1032,["onClick"])]))),128)),a(f,{onClick:Ie},{default:t(()=>[a(l(i),{icon:"mdi:plus"}),e[62]||(e[62]=p(" Add Peer "))]),_:1,__:[62]})]),_:1}),a(y,{label:"Config File (Optional)"},{default:t(()=>[a(b,{modelValue:c.config,"onUpdate:modelValue":e[19]||(e[19]=o=>c.config=o),type:"textarea",rows:8,placeholder:"Paste full WireGuard configuration here, or fill fields above"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],2)}}},bt=Ee(gt,[["__scopeId","data-v-70829e2f"]]);export{bt as default};
