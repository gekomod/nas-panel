import{_ as Xe,u as Ye,r as p,c as ge,v as Ze,o as xe,W as et,b as $,d as T,e as h,g as t,i as S,h as q,w as n,f as a,k as o,I as r,t as s,m,n as M,a3 as tt,F as se,l as ne,x as ye,C as R,E as at}from"./index-naspanel.js";const st={class:"antivirus-dashboard"},nt={class:"header-content"},it={class:"header-left"},lt={class:"header-icon"},ot={class:"header-text"},rt={class:"subtitle"},ct={class:"header-actions"},ut={key:0,class:"status-cards"},dt={class:"card-content"},vt={class:"card-info"},mt={class:"status-value"},ht={class:"status-detail"},_t={class:"card-content"},pt={class:"card-icon db-icon"},ft={class:"card-info"},gt={class:"status-value"},yt={class:"status-detail"},$t={class:"card-content"},bt={class:"card-icon version-icon"},kt={class:"card-info"},wt={class:"status-value"},St={class:"card-content"},Ct={class:"card-icon realtime-icon"},Tt={class:"card-info"},Et={class:"status-value"},Dt={class:"status-detail"},Vt={class:"card-header"},qt={class:"scan-type-section"},Ut={class:"section-title"},Bt={class:"scan-type-grid"},Pt={class:"scan-type-content"},zt={class:"scan-type-icon quick-icon"},Lt={class:"scan-type-info"},It={class:"scan-description"},Nt={class:"scan-type-content"},Mt={class:"scan-type-icon full-icon"},Rt={class:"scan-type-info"},At={class:"scan-description"},Ft={class:"scan-type-content"},Ot={class:"scan-type-icon custom-icon"},Jt={class:"scan-type-info"},Ht={class:"scan-description"},Kt={key:0,class:"custom-paths-section"},Wt={class:"section-title"},jt={class:"paths-input-container"},Gt={key:0,class:"paths-list"},Qt={class:"paths-header"},Xt={class:"paths-tags"},Yt={class:"scan-controls"},Zt={key:1,class:"scan-progress-section"},xt={class:"progress-header"},ea={class:"progress-stats"},ta={class:"progress-details"},aa={class:"progress-info"},sa={key:2,class:"event-stream-section"},na={class:"section-header"},ia={class:"event-list"},la={class:"event-time"},oa={class:"event-content"},ra={key:3,class:"threats-section"},ca={class:"section-header"},ua={class:"threats-title"},da={class:"threats-actions"},va={class:"threat-name-cell"},ma={class:"threat-name"},ha={class:"file-path-cell"},_a={class:"file-path"},pa={class:"action-buttons"},fa={key:4,class:"results-summary"},ga={class:"summary-content"},ya={class:"summary-info"},$a={class:"summary-stats"},ba={class:"stat-item"},ka={class:"stat-label"},wa={class:"stat-value"},Sa={class:"stat-item"},Ca={class:"stat-label"},Ta={class:"stat-item"},Ea={class:"stat-label"},Da={class:"stat-value"},Va={key:0,class:"stat-item"},qa={class:"stat-label"},Ua={class:"stat-value"},Ba={class:"card-header"},Pa={class:"history-filters"},za={key:0,class:"empty-history"},La={class:"empty-icon"},Ia={class:"history-item-header"},Na={class:"scan-info"},Ma={class:"scan-type"},Ra={class:"scan-stats"},Aa={class:"history-actions"},Fa={class:"card-header"},Oa={class:"setting-description"},Ja={class:"option-content"},Ha={class:"option-content"},Ka={class:"option-content"},Wa={class:"setting-description"},ja={class:"setting-description"},Ga={class:"setting-description"},Qa={class:"form-actions"},Xa={__name:"Antivirus",setup(Ya){const{t:i}=Ye(),E=p("dashboard"),V=p("quick"),W=p(""),U=p([]),D=p(!1),P=p(0),A=p(0),j=p("0:00"),L=p([]),f=p([]),C=p(null),g=p({installed:!1}),X=p(null),H=p(null),ie=p("loading"),F=p("all"),K=p([]),b=p(null),_=p({autoUpdate:!0,updateFrequency:"daily",realtimeProtection:!1,notifications:!0,scanSchedule:"02:00"}),I=p(""),Y=p("--:--"),Z=p(!1),G=p(!1),x=p(!1),B=p(null),$e=ge(()=>g.value.installed?g.value.active?i("antivirus.status_active"):i("antivirus.status_inactive"):i("antivirus.not_installed")),le=ge(()=>{const e=new Date;return K.value.filter(l=>{if(F.value==="all")return!0;if(F.value==="week"){const v=new Date(l.timestamp);return e-v<=7*24*60*60*1e3}if(F.value==="month"){const v=new Date(l.timestamp);return e-v<=30*24*60*60*1e3}return F.value==="threats"?l.threatsDetected>0:!0}).slice(0,50)}),w=Ze.create({baseURL:`${window.location.protocol}//${window.location.hostname}:1112`,timeout:3e4});function be(e){return{info:"mdi:information",status:"mdi:information",warning:"mdi:alert",danger:"mdi:alert-octagon",threat:"mdi:alert-octagon",success:"mdi:check-circle",file_scanned:"mdi:file-document"}[e]||"mdi:information"}function ke(e){return{quick:"mdi:lightning-bolt",full:"mdi:harddisk",custom:"mdi:folder-cog"}[e]||"mdi:shield-scan"}function d(e,l){const v=new Date().toLocaleTimeString(),y={type:e,message:l,time:v};L.value.unshift(y),L.value.length>100&&L.value.pop(),(e==="danger"||e==="threat")&&_.value.notifications&&at.warning({title:i("antivirus.threat_detected"),message:l,position:"bottom-right",duration:5e3})}function oe(){const e=W.value.trim();if(e){if(U.value.includes(e)){d("warning",i("antivirus.path_already_added"));return}U.value.push(e),W.value="",d("success",i("antivirus.path_added",{path:e}))}}function we(e){const l=U.value[e];U.value.splice(e,1),d("info",i("antivirus.path_removed",{path:l}))}async function re(){try{const e=await w.get("/api/antivirus/status");g.value=e.data,ie.value=e.data.active?"active":"inactive",e.data.lastUpdate&&(H.value=new Date(e.data.lastUpdate).toLocaleString()),console.log("Package info:",g.value)}catch(e){console.error("Error checking package:",e),ie.value="error",g.value.installed=!1}}async function ce(){try{const e=await w.get("/api/antivirus/virusdb");X.value=e.data.version,H.value=new Date(e.data.updatedAt).toLocaleString()}catch(e){console.error("Error checking virus DB:",e),d("warning",i("antivirus.virus_db_error"))}}async function Se(){if(!(D.value||!g.value.installed))try{if(V.value==="custom"&&U.value.length===0){ye.warning(i("antivirus.no_custom_paths"));return}D.value=!0,P.value=0,A.value=0,j.value="0:00",Y.value="--:--",L.value=[],f.value=[],C.value=null,I.value="",d("info",i("antivirus.scan_starting")),b.value&&b.value.close();const e={scanType:V.value,paths:V.value==="custom"?U.value:[]};b.value=new EventSource(`${w.defaults.baseURL}/api/antivirus/scan?`+new URLSearchParams({scanType:e.scanType,paths:JSON.stringify(e.paths)}));const l=Date.now();let v;v=setInterval(()=>{if(D.value){const y=Math.floor((Date.now()-l)/1e3);if(j.value=he(y),P.value>0&&P.value<100){const u=y,O=u*100/P.value-u;Y.value=he(Math.max(0,Math.floor(O)))}}else clearInterval(v)},1e3),b.value.onmessage=y=>{try{const u=JSON.parse(y.data);Ce(u)}catch(u){console.error("Error parsing SSE data:",u)}},b.value.onerror=y=>{console.error("SSE error:",y),d("error",i("antivirus.scanner_connection_error")),ue(),v&&clearInterval(v)},b.value.addEventListener("progress",y=>{try{const u=JSON.parse(y.data);P.value=u.progress||0,A.value=u.itemsScanned||A.value,u.message&&d("info",u.message)}catch(u){console.error("Error parsing progress:",u)}}),b.value.addEventListener("threat",y=>{try{const u=JSON.parse(y.data);f.value.some(k=>k.path===u.path&&k.name===u.name)||(f.value.push(u),d("threat",i("antivirus.threat_detected_message",{name:u.name})))}catch(u){console.error("Error parsing threat:",u)}}),b.value.addEventListener("info",y=>{try{const u=JSON.parse(y.data);u.file&&(I.value=u.file),u.message&&d("info",u.message)}catch(u){console.error("Error parsing info:",u)}}),b.value.addEventListener("complete",y=>{try{const u=JSON.parse(y.data);Te(u),v&&clearInterval(v)}catch(u){console.error("Error parsing complete:",u)}}),b.value.addEventListener("error",y=>{try{const u=JSON.parse(y.data);d("error",u.message)}catch(u){console.error("Error parsing error event:",u)}})}catch(e){console.error("Scan start error:",e),d("error",i("antivirus.scan_start_error")),D.value=!1}}function ue(){b.value&&(b.value.close(),b.value=null),D.value=!1,I.value="",d("warning",i("antivirus.scan_stopped"))}function Ce(e){e.progress!==void 0&&(P.value=e.progress),e.itemsScanned!==void 0&&(A.value=e.itemsScanned),e.threat&&(f.value.some(l=>l.path===e.threat.path&&l.name===e.threat.name)||f.value.push(e.threat)),e.message&&d(e.type||"info",e.message)}function Te(e){D.value=!1,P.value=100,I.value="",d("success",i("antivirus.scan_complete")),C.value={scanType:V.value,timestamp:new Date().toISOString(),duration:j.value,itemsScanned:e.itemsScanned||A.value,threatsDetected:f.value.length,threats:[...f.value],dataScanned:e.dataScanned||"0 MB"},Ee(C.value),b.value&&(b.value.close(),b.value=null)}async function Ee(e){try{const l=await w.post("/api/antivirus/scan/history",e);K.value.unshift(l.data),d("info",i("antivirus.scan_results_saved"))}catch(l){console.error("Error saving scan results:",l),d("error",i("antivirus.scan_results_save_error"))}}async function de(){try{const e=await w.get("/api/antivirus/scan/history");K.value=e.data}catch(e){console.error("Error loading history:",e),d("error",i("antivirus.history_load_error"))}}async function De(){try{const e=await w.get("/api/antivirus/settings");_.value={..._.value,...e.data}}catch(e){console.error("Error loading settings:",e),d("warning",i("antivirus.using_default_settings"))}}async function Ve(){x.value=!0;try{const e=await w.put("/api/antivirus/settings",_.value);_.value=e.data,d("success",i("antivirus.settings_saved"))}catch(e){console.error("Error saving settings:",e),d("error",i("antivirus.settings_save_error"))}finally{x.value=!1}}async function qe(){try{await R.confirm(i("antivirus.reset_settings_confirm"),i("antivirus.reset_settings"),{confirmButtonText:i("common.confirm"),cancelButtonText:i("common.cancel"),type:"warning"});const e=await w.delete("/api/antivirus/settings");_.value=e.data,d("success",i("antivirus.settings_reset"))}catch(e){e!=="cancel"&&(console.error("Error resetting settings:",e),d("error",i("antivirus.settings_reset_error")))}}function ve(){_.value.realtimeProtection?ee():B.value&&(B.value.close(),B.value=null,d("info",i("antivirus.realtime_deactivated")))}function ee(){B.value&&B.value.close(),_.value.realtimeProtection&&g.value.installed&&(B.value=new EventSource(`${w.defaults.baseURL}/api/antivirus/realtime`),B.value.onmessage=e=>{try{const l=JSON.parse(e.data);l.message&&d("info",l.message)}catch(l){console.error("Error parsing realtime event:",l)}},B.value.onerror=e=>{console.error("Realtime SSE error:",e),setTimeout(()=>{_.value.realtimeProtection&&ee()},5e3)},d("info",i("antivirus.realtime_activated")))}async function me(){if(!g.value.installed){ye.warning(i("antivirus.install_first"));return}G.value=!0,d("info",i("antivirus.checking_updates"));try{const e=await w.post("/api/antivirus/update");X.value=e.data.version,H.value=new Date(e.data.updatedAt).toLocaleString(),d("success",i("antivirus.virus_db_updated"))}catch(e){console.error("Error checking updates:",e),d("error",i("antivirus.virus_db_update_error"))}finally{G.value=!1}}async function Ue(e){try{await R.confirm(i("antivirus.quarantine_confirm",{name:e.name}),i("antivirus.quarantine"),{confirmButtonText:i("common.confirm"),cancelButtonText:i("common.cancel"),type:"warning"}),await w.post(`/api/antivirus/threats/${e.id}/quarantine`),d("success",i("antivirus.threat_quarantined")),te(e)}catch(l){l!=="cancel"&&d("error",i("antivirus.quarantine_error"))}}async function Be(){if(f.value.length!==0)try{await R.confirm(i("antivirus.quarantine_all_confirm",{count:f.value.length}),i("antivirus.quarantine_all"),{confirmButtonText:i("common.confirm"),cancelButtonText:i("common.cancel"),type:"warning"});for(const e of f.value)await w.post(`/api/antivirus/threats/${e.id}/quarantine`);d("success",i("antivirus.all_threats_quarantined")),f.value=[]}catch(e){e!=="cancel"&&d("error",i("antivirus.quarantine_all_error"))}}async function Pe(e){try{await R.confirm(i("antivirus.remove_confirm",{name:e.name}),i("antivirus.remove_threat"),{confirmButtonText:i("common.confirm"),cancelButtonText:i("common.cancel"),type:"danger"}),await w.delete(`/api/antivirus/threats/${e.id}`),d("success",i("antivirus.threat_removed")),te(e)}catch(l){l!=="cancel"&&d("error",i("antivirus.remove_error"))}}async function ze(){if(f.value.length!==0)try{await R.confirm(i("antivirus.remove_all_confirm",{count:f.value.length}),i("antivirus.remove_all_threats"),{confirmButtonText:i("common.confirm"),cancelButtonText:i("common.cancel"),type:"danger"});for(const e of f.value)await w.delete(`/api/antivirus/threats/${e.id}`);d("success",i("antivirus.all_threats_removed")),f.value=[]}catch(e){e!=="cancel"&&d("error",i("antivirus.remove_all_error"))}}function Le(e){d("info",i("antivirus.threat_ignored",{name:e.name})),te(e)}function te(e){const l=f.value.findIndex(v=>v.path===e.path);l!==-1&&f.value.splice(l,1)}async function Ie(){Z.value=!0;try{await w.post("/api/antivirus/install"),d("success",i("antivirus.install_success")),await re(),await ce()}catch(e){console.error("Error installing antivirus:",e),d("error",i("antivirus.install_error"))}finally{Z.value=!1}}function he(e){const l=Math.floor(e/60),v=Math.floor(e%60);return`${l}:${v<10?"0":""}${v}`}function _e(e){return new Date(e).toLocaleString()}function Ne(e){R.alert(`
    <div class="scan-details">
      <h3>${i("antivirus.scan_details_title")}</h3>
      <div class="detail-item">
        <strong>${i("antivirus.scan_type")}:</strong> ${i(`antivirus.scan_types.${e.scanType}`)}
      </div>
      <div class="detail-item">
        <strong>${i("antivirus.date")}:</strong> ${_e(e.timestamp)}
      </div>
      <div class="detail-item">
        <strong>${i("antivirus.duration")}:</strong> ${e.duration}
      </div>
      <div class="detail-item">
        <strong>${i("antivirus.files_scanned")}:</strong> ${e.itemsScanned}
      </div>
      <div class="detail-item">
        <strong>${i("antivirus.threats_detected")}:</strong> ${e.threatsDetected}
      </div>
      ${e.dataScanned?`<div class="detail-item">
        <strong>${i("antivirus.data_scanned")}:</strong> ${e.dataScanned}
      </div>`:""}
    </div>
    `,i("antivirus.scan_details"),{dangerouslyUseHTMLString:!0,confirmButtonText:i("common.close")})}async function Me(e){try{await R.confirm(i("antivirus.delete_history_confirm"),i("antivirus.delete_history"),{confirmButtonText:i("common.confirm"),cancelButtonText:i("common.cancel"),type:"warning"}),await w.delete(`/api/antivirus/scan/history/${e}`),K.value=K.value.filter(l=>l.id!==e),d("success",i("antivirus.history_deleted"))}catch(l){l!=="cancel"&&d("error",i("antivirus.history_delete_error"))}}async function Re(){await de(),d("info",i("antivirus.history_refreshed"))}function Ae(){f.value=[],C.value=null,L.value=[],d("info",i("antivirus.results_cleared"))}return xe(()=>{re(),De(),de(),ce(),ee()}),et(()=>{b.value&&b.value.close(),B.value&&B.value.close()}),(e,l)=>{const v=$("el-button"),y=$("el-button-group"),u=$("el-card"),k=$("el-tag"),O=$("el-switch"),Fe=$("el-input"),Oe=$("el-progress"),Je=$("el-scrollbar"),Q=$("el-table-column"),ae=$("el-tooltip"),He=$("el-table"),N=$("el-option"),pe=$("el-select"),Ke=$("el-timeline-item"),We=$("el-timeline"),J=$("el-form-item"),je=$("el-time-select"),Ge=$("el-divider"),Qe=$("el-form");return h(),T("div",st,[t(u,{class:"dashboard-header",shadow:"hover"},{default:n(()=>[a("div",nt,[a("div",it,[a("div",lt,[t(o(r),{icon:"mdi:shield-check"})]),a("div",ot,[a("h1",null,s(e.$t("antivirus.title")),1),a("p",rt,s(e.$t("antivirus.subtitle")),1)])]),a("div",ct,[t(y,null,{default:n(()=>[t(v,{type:E.value==="dashboard"?"primary":"default",onClick:l[0]||(l[0]=c=>E.value="dashboard")},{default:n(()=>[t(o(r),{icon:"mdi:view-dashboard"}),m(" "+s(e.$t("antivirus.dashboard")),1)]),_:1},8,["type"]),t(v,{type:E.value==="scanner"?"primary":"default",onClick:l[1]||(l[1]=c=>E.value="scanner")},{default:n(()=>[t(o(r),{icon:"mdi:shield-scan"}),m(" "+s(e.$t("antivirus.scanner")),1)]),_:1},8,["type"]),t(v,{type:E.value==="history"?"primary":"default",onClick:l[2]||(l[2]=c=>E.value="history")},{default:n(()=>[t(o(r),{icon:"mdi:history"}),m(" "+s(e.$t("antivirus.history")),1)]),_:1},8,["type"]),t(v,{type:E.value==="settings"?"primary":"default",onClick:l[3]||(l[3]=c=>E.value="settings")},{default:n(()=>[t(o(r),{icon:"mdi:cog"}),m(" "+s(e.$t("antivirus.settings")),1)]),_:1},8,["type"])]),_:1})])])]),_:1}),E.value==="dashboard"||E.value==="scanner"?(h(),T("div",ut,[t(u,{class:"status-card",shadow:"hover"},{default:n(()=>[a("div",dt,[a("div",{class:M(["card-icon",{installed:g.value.installed,"not-installed":!g.value.installed}])},[t(o(r),{icon:g.value.installed?"mdi:shield-check":"mdi:shield-off"},null,8,["icon"])],2),a("div",vt,[a("h3",null,s(e.$t("antivirus.status")),1),a("p",mt,[t(k,{type:g.value.installed?"success":"danger",size:"large"},{default:n(()=>[m(s(g.value.installed?e.$t("antivirus.installed"):e.$t("antivirus.not_installed")),1)]),_:1},8,["type"])]),a("p",ht,s($e.value),1),g.value.installed?S("",!0):(h(),q(v,{key:0,type:"primary",size:"small",onClick:Ie,loading:Z.value,class:"install-btn"},{default:n(()=>[t(o(r),{icon:"mdi:download"}),m(" "+s(e.$t("antivirus.install")),1)]),_:1},8,["loading"]))])])]),_:1}),t(u,{class:"status-card",shadow:"hover"},{default:n(()=>[a("div",_t,[a("div",pt,[t(o(r),{icon:"mdi:database"})]),a("div",ft,[a("h3",null,s(e.$t("antivirus.virus_db")),1),a("p",gt,s(X.value||e.$t("antivirus.not_loaded")),1),a("p",yt,s(H.value?e.$t("antivirus.last_update")+": "+H.value:""),1),t(v,{type:"primary",size:"small",onClick:me,loading:G.value,disabled:!g.value.installed},{default:n(()=>[t(o(r),{icon:"mdi:cloud-download"}),m(" "+s(e.$t("antivirus.check_updates")),1)]),_:1},8,["loading","disabled"])])])]),_:1}),t(u,{class:"status-card",shadow:"hover"},{default:n(()=>[a("div",$t,[a("div",bt,[t(o(r),{icon:"mdi:tag"})]),a("div",kt,[a("h3",null,s(e.$t("antivirus.version")),1),a("p",wt,s(g.value.version||e.$t("antivirus.unknown")),1),l[17]||(l[17]=a("p",{class:"status-detail"},"ClamAV Antivirus",-1))])])]),_:1}),t(u,{class:"status-card",shadow:"hover"},{default:n(()=>[a("div",St,[a("div",Ct,[t(o(r),{icon:_.value.realtimeProtection?"mdi:shield-sync":"mdi:shield-off"},null,8,["icon"])]),a("div",Tt,[a("h3",null,s(e.$t("antivirus.realtime_protection")),1),a("p",Et,[t(O,{modelValue:_.value.realtimeProtection,"onUpdate:modelValue":l[4]||(l[4]=c=>_.value.realtimeProtection=c),disabled:!g.value.installed,onChange:ve},null,8,["modelValue","disabled"])]),a("p",Dt,s(_.value.realtimeProtection?e.$t("antivirus.realtime_active"):e.$t("antivirus.realtime_inactive")),1)])])]),_:1})])):S("",!0),E.value==="scanner"?(h(),q(u,{key:1,class:"scanner-card",shadow:"hover"},{header:n(()=>[a("div",Vt,[a("h2",null,[t(o(r),{icon:"mdi:shield-scan"}),m(" "+s(e.$t("antivirus.scanner")),1)])])]),default:n(()=>[a("div",qt,[a("h3",Ut,s(e.$t("antivirus.select_scan_type")),1),a("div",Bt,[t(u,{class:M(["scan-type-card",{selected:V.value==="quick"}]),onClick:l[5]||(l[5]=c=>V.value="quick"),shadow:"hover"},{default:n(()=>[a("div",Pt,[a("div",zt,[t(o(r),{icon:"mdi:lightning-bolt"})]),a("div",Lt,[a("h4",null,s(e.$t("antivirus.quick_scan")),1),a("p",It,s(e.$t("antivirus.quick_scan_desc")),1),t(k,{type:"info",size:"small"},{default:n(()=>[t(o(r),{icon:"mdi:clock-fast"}),m(" ~2 "+s(e.$t("antivirus.minutes")),1)]),_:1})])])]),_:1},8,["class"]),t(u,{class:M(["scan-type-card",{selected:V.value==="full"}]),onClick:l[6]||(l[6]=c=>V.value="full"),shadow:"hover"},{default:n(()=>[a("div",Nt,[a("div",Mt,[t(o(r),{icon:"mdi:harddisk"})]),a("div",Rt,[a("h4",null,s(e.$t("antivirus.full_scan")),1),a("p",At,s(e.$t("antivirus.full_scan_desc")),1),t(k,{type:"warning",size:"small"},{default:n(()=>[t(o(r),{icon:"mdi:clock"}),m(" ~20 "+s(e.$t("antivirus.minutes")),1)]),_:1})])])]),_:1},8,["class"]),t(u,{class:M(["scan-type-card",{selected:V.value==="custom"}]),onClick:l[7]||(l[7]=c=>V.value="custom"),shadow:"hover"},{default:n(()=>[a("div",Ft,[a("div",Ot,[t(o(r),{icon:"mdi:folder-cog"})]),a("div",Jt,[a("h4",null,s(e.$t("antivirus.custom_scan")),1),a("p",Ht,s(e.$t("antivirus.custom_scan_desc")),1),t(k,{type:"success",size:"small"},{default:n(()=>[t(o(r),{icon:"mdi:folder-multiple"}),m(" "+s(e.$t("antivirus.custom_paths")),1)]),_:1})])])]),_:1},8,["class"])])]),V.value==="custom"?(h(),T("div",Kt,[a("h3",Wt,s(e.$t("antivirus.custom_paths")),1),a("div",jt,[t(Fe,{modelValue:W.value,"onUpdate:modelValue":l[8]||(l[8]=c=>W.value=c),placeholder:e.$t("antivirus.enter_path_placeholder"),onKeyup:tt(oe,["enter"]),class:"path-input"},{prepend:n(()=>[t(o(r),{icon:"mdi:folder"})]),append:n(()=>[t(v,{onClick:oe,type:"primary"},{default:n(()=>[t(o(r),{icon:"mdi:plus"}),m(" "+s(e.$t("antivirus.add")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),U.value.length>0?(h(),T("div",Gt,[a("div",Qt,[a("span",null,s(e.$t("antivirus.selected_paths"))+" ("+s(U.value.length)+")",1),t(v,{onClick:l[9]||(l[9]=c=>U.value=[]),type:"text",size:"small"},{default:n(()=>[t(o(r),{icon:"mdi:delete"}),m(" "+s(e.$t("antivirus.clear_all")),1)]),_:1})]),a("div",Xt,[(h(!0),T(se,null,ne(U.value,(c,z)=>(h(),q(k,{key:z,closable:"",onClose:fe=>we(z),class:"path-tag"},{default:n(()=>[t(o(r),{icon:"mdi:folder"}),m(" "+s(c),1)]),_:2},1032,["onClose"]))),128))])])):S("",!0)])):S("",!0),a("div",Yt,[t(v,{type:"primary",size:"large",onClick:Se,disabled:D.value||!g.value.installed||V.value==="custom"&&U.value.length===0,loading:D.value,class:"scan-button"},{default:n(()=>[t(o(r),{icon:"mdi:shield-search"}),m(" "+s(D.value?e.$t("antivirus.scanning"):e.$t("antivirus.start_scan")),1)]),_:1},8,["disabled","loading"]),D.value?(h(),q(v,{key:0,onClick:ue,type:"danger",size:"large",class:"stop-button"},{default:n(()=>[t(o(r),{icon:"mdi:stop"}),m(" "+s(e.$t("antivirus.stop_scan")),1)]),_:1})):S("",!0),t(v,{onClick:Ae,type:"info",size:"large",disabled:D.value},{default:n(()=>[t(o(r),{icon:"mdi:broom"}),m(" "+s(e.$t("antivirus.clear_results")),1)]),_:1},8,["disabled"])]),D.value?(h(),T("div",Zt,[a("div",xt,[a("h3",null,[t(o(r),{icon:"mdi:progress-clock"}),m(" "+s(e.$t("antivirus.scan_in_progress")),1)]),a("div",ea,[t(k,{class:"stat-tag"},{default:n(()=>[t(o(r),{icon:"mdi:clock-outline"}),m(" "+s(e.$t("antivirus.duration"))+": "+s(j.value),1)]),_:1}),t(k,{class:"stat-tag"},{default:n(()=>[t(o(r),{icon:"mdi:file-document"}),m(" "+s(e.$t("antivirus.scanned"))+": "+s(A.value),1)]),_:1}),I.value?(h(),q(k,{key:0,class:"stat-tag file-tag"},{default:n(()=>[t(o(r),{icon:"mdi:file"}),m(" "+s(I.value.substring(0,40))+s(I.value.length>40?"...":""),1)]),_:1})):S("",!0)])]),t(Oe,{percentage:P.value,"stroke-width":18,"text-inside":!0,status:"success",class:"progress-bar"},null,8,["percentage"]),a("div",ta,[a("div",aa,[a("span",null,s(P.value)+"% "+s(e.$t("antivirus.complete")),1),a("span",null,s(e.$t("antivirus.estimated_time"))+": "+s(Y.value),1)])])])):S("",!0),D.value||L.value.length>0?(h(),T("div",sa,[a("div",na,[a("h3",null,[t(o(r),{icon:"mdi:message-text"}),m(" "+s(e.$t("antivirus.scan_log")),1)]),t(v,{onClick:l[10]||(l[10]=c=>L.value=[]),type:"text",size:"small"},{default:n(()=>[t(o(r),{icon:"mdi:trash-can"}),m(" "+s(e.$t("antivirus.clear_log")),1)]),_:1})]),t(u,{class:"event-stream-card"},{default:n(()=>[t(Je,{height:"250px"},{default:n(()=>[a("div",ia,[(h(!0),T(se,null,ne(L.value,(c,z)=>(h(),T("div",{key:z,class:M(["event-item",c.type])},[a("div",la,[t(o(r),{icon:"mdi:clock-outline"}),m(" "+s(c.time),1)]),a("div",oa,[t(o(r),{icon:be(c.type),class:"event-icon"},null,8,["icon"]),a("span",null,s(c.message),1)])],2))),128))])]),_:1})]),_:1})])):S("",!0),f.value.length>0?(h(),T("div",ra,[a("div",ca,[a("h3",ua,[t(o(r),{icon:"mdi:alert-octagon"}),m(" "+s(e.$t("antivirus.detected_threats",{count:f.value.length})),1)]),a("div",da,[t(v,{onClick:ze,type:"danger",size:"small"},{default:n(()=>[t(o(r),{icon:"mdi:delete"}),m(" "+s(e.$t("antivirus.remove_all")),1)]),_:1}),t(v,{onClick:Be,type:"warning",size:"small"},{default:n(()=>[t(o(r),{icon:"mdi:lock"}),m(" "+s(e.$t("antivirus.quarantine_all")),1)]),_:1})])]),t(He,{data:f.value,height:"300",stripe:"",class:"threats-table"},{default:n(()=>[t(Q,{prop:"name",label:e.$t("antivirus.threat_name"),width:"200"},{default:n(({row:c})=>[a("div",va,[t(o(r),{icon:"mdi:bug",class:"threat-icon"}),a("span",ma,s(c.name),1)])]),_:1},8,["label"]),t(Q,{prop:"path",label:e.$t("antivirus.path")},{default:n(({row:c})=>[a("div",ha,[t(o(r),{icon:"mdi:file"}),a("span",_a,s(c.path),1)])]),_:1},8,["label"]),t(Q,{prop:"severity",label:e.$t("antivirus.severity"),width:"120"},{default:n(({row:c})=>[t(k,{type:c.severity==="high"?"danger":"warning",class:"severity-tag"},{default:n(()=>[m(s(c.severity||"high"),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(Q,{label:e.$t("antivirus.actions"),width:"150",fixed:"right"},{default:n(({row:c})=>[a("div",pa,[t(ae,{content:e.$t("antivirus.quarantine"),placement:"top"},{default:n(()=>[t(v,{onClick:z=>Ue(c),type:"warning",size:"small",circle:""},{default:n(()=>[t(o(r),{icon:"mdi:lock"})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),t(ae,{content:e.$t("antivirus.remove"),placement:"top"},{default:n(()=>[t(v,{onClick:z=>Pe(c),type:"danger",size:"small",circle:""},{default:n(()=>[t(o(r),{icon:"mdi:delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),t(ae,{content:e.$t("antivirus.ignore"),placement:"top"},{default:n(()=>[t(v,{onClick:z=>Le(c),type:"info",size:"small",circle:""},{default:n(()=>[t(o(r),{icon:"mdi:eye-off"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])])]),_:1},8,["label"])]),_:1},8,["data"])])):S("",!0),C.value?(h(),T("div",fa,[t(u,{class:"summary-card",shadow:"hover"},{default:n(()=>[a("div",ga,[a("div",{class:M(["summary-icon",C.value.threatsDetected>0?"danger":"success"])},[t(o(r),{icon:C.value.threatsDetected>0?"mdi:alert-octagon":"mdi:shield-check"},null,8,["icon"])],2),a("div",ya,[a("h3",null,s(e.$t("antivirus.scan_completed")),1),a("div",$a,[a("div",ba,[t(o(r),{icon:"mdi:file-check"}),a("span",ka,s(e.$t("antivirus.files_scanned"))+":",1),a("span",wa,s(C.value.itemsScanned),1)]),a("div",Sa,[t(o(r),{icon:C.value.threatsDetected>0?"mdi:alert":"mdi:shield"},null,8,["icon"]),a("span",Ca,s(e.$t("antivirus.threats_found"))+":",1),a("span",{class:M(["stat-value",{danger:C.value.threatsDetected>0}])},s(C.value.threatsDetected),3)]),a("div",Ta,[t(o(r),{icon:"mdi:timer"}),a("span",Ea,s(e.$t("antivirus.total_time"))+":",1),a("span",Da,s(C.value.duration),1)]),C.value.dataScanned?(h(),T("div",Va,[t(o(r),{icon:"mdi:database"}),a("span",qa,s(e.$t("antivirus.data_scanned"))+":",1),a("span",Ua,s(C.value.dataScanned),1)])):S("",!0)])])])]),_:1})])):S("",!0)]),_:1})):S("",!0),E.value==="history"?(h(),q(u,{key:2,class:"history-card",shadow:"hover"},{header:n(()=>[a("div",Ba,[a("h2",null,[t(o(r),{icon:"mdi:history"}),m(" "+s(e.$t("antivirus.scan_history")),1)]),a("div",Pa,[t(pe,{modelValue:F.value,"onUpdate:modelValue":l[11]||(l[11]=c=>F.value=c),placeholder:e.$t("antivirus.filter_history"),class:"filter-select"},{default:n(()=>[t(N,{label:e.$t("antivirus.all_scans"),value:"all"},null,8,["label"]),t(N,{label:e.$t("antivirus.last_week"),value:"week"},null,8,["label"]),t(N,{label:e.$t("antivirus.last_month"),value:"month"},null,8,["label"]),t(N,{label:e.$t("antivirus.only_threats"),value:"threats"},null,8,["label"])]),_:1},8,["modelValue","placeholder"]),t(v,{onClick:Re,type:"primary"},{default:n(()=>[t(o(r),{icon:"mdi:refresh"}),m(" "+s(e.$t("antivirus.refresh")),1)]),_:1})])])]),default:n(()=>[le.value.length===0?(h(),T("div",za,[a("div",La,[t(o(r),{icon:"mdi:file-document-outline"})]),a("h3",null,s(e.$t("antivirus.no_history")),1),a("p",null,s(e.$t("antivirus.no_history_desc")),1)])):(h(),q(We,{key:1,class:"history-timeline"},{default:n(()=>[(h(!0),T(se,null,ne(le.value,(c,z)=>(h(),q(Ke,{key:z,timestamp:_e(c.timestamp),placement:"top",type:c.threatsDetected>0?"danger":"success",icon:c.threatsDetected>0?"mdi:alert-octagon":"mdi:check-circle",size:"large"},{default:n(()=>[t(u,{class:"history-item",shadow:"hover"},{default:n(()=>[a("div",Ia,[a("div",Na,[a("h4",Ma,[t(o(r),{icon:ke(c.scanType)},null,8,["icon"]),m(" "+s(e.$t(`antivirus.scan_types.${c.scanType}`)),1)]),a("div",Ra,[t(k,{class:"stat-badge"},{default:n(()=>[t(o(r),{icon:"mdi:clock-outline"}),m(" "+s(c.duration),1)]),_:2},1024),t(k,{class:"stat-badge"},{default:n(()=>[t(o(r),{icon:"mdi:file-document"}),m(" "+s(c.itemsScanned),1)]),_:2},1024),c.threatsDetected>0?(h(),q(k,{key:0,type:"danger",class:"threat-badge"},{default:n(()=>[t(o(r),{icon:"mdi:alert"}),m(" "+s(c.threatsDetected)+" "+s(e.$t("antivirus.threats")),1)]),_:2},1024)):(h(),q(k,{key:1,type:"success",class:"safe-badge"},{default:n(()=>[t(o(r),{icon:"mdi:shield-check"}),m(" "+s(e.$t("antivirus.safe")),1)]),_:1}))])]),a("div",Aa,[t(v,{onClick:fe=>Ne(c),type:"primary",text:""},{default:n(()=>[t(o(r),{icon:"mdi:information"}),m(" "+s(e.$t("antivirus.details")),1)]),_:2},1032,["onClick"]),t(v,{onClick:fe=>Me(c.id),type:"danger",text:""},{default:n(()=>[t(o(r),{icon:"mdi:delete"}),m(" "+s(e.$t("antivirus.delete")),1)]),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1032,["timestamp","type","icon"]))),128))]),_:1}))]),_:1})):S("",!0),E.value==="settings"?(h(),q(u,{key:3,class:"settings-card",shadow:"hover"},{header:n(()=>[a("div",Fa,[a("h2",null,[t(o(r),{icon:"mdi:cog"}),m(" "+s(e.$t("antivirus.settings")),1)])])]),default:n(()=>[t(Qe,{model:_.value,"label-width":"200px",class:"settings-form"},{default:n(()=>[t(J,{label:e.$t("antivirus.auto_updates")},{default:n(()=>[t(O,{modelValue:_.value.autoUpdate,"onUpdate:modelValue":l[12]||(l[12]=c=>_.value.autoUpdate=c),disabled:!g.value.installed,"inline-prompt":"","active-text":e.$t("common.on"),"inactive-text":e.$t("common.off")},null,8,["modelValue","disabled","active-text","inactive-text"]),a("div",Oa,s(e.$t("antivirus.auto_updates_desc")),1)]),_:1},8,["label"]),_.value.autoUpdate?(h(),q(J,{key:0,label:e.$t("antivirus.update_frequency")},{default:n(()=>[t(pe,{modelValue:_.value.updateFrequency,"onUpdate:modelValue":l[13]||(l[13]=c=>_.value.updateFrequency=c),class:"frequency-select"},{default:n(()=>[t(N,{label:e.$t("antivirus.daily"),value:"daily"},{default:n(()=>[a("div",Ja,[t(o(r),{icon:"mdi:calendar-today"}),a("span",null,s(e.$t("antivirus.daily")),1)])]),_:1},8,["label"]),t(N,{label:e.$t("antivirus.weekly"),value:"weekly"},{default:n(()=>[a("div",Ha,[t(o(r),{icon:"mdi:calendar-week"}),a("span",null,s(e.$t("antivirus.weekly")),1)])]),_:1},8,["label"]),t(N,{label:e.$t("antivirus.monthly"),value:"monthly"},{default:n(()=>[a("div",Ka,[t(o(r),{icon:"mdi:calendar-month"}),a("span",null,s(e.$t("antivirus.monthly")),1)])]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])):S("",!0),t(J,{label:e.$t("antivirus.realtime_protection")},{default:n(()=>[t(O,{modelValue:_.value.realtimeProtection,"onUpdate:modelValue":l[14]||(l[14]=c=>_.value.realtimeProtection=c),disabled:!g.value.installed,"inline-prompt":"","active-text":e.$t("common.on"),"inactive-text":e.$t("common.off"),onChange:ve},null,8,["modelValue","disabled","active-text","inactive-text"]),a("div",Wa,s(e.$t("antivirus.realtime_protection_desc")),1)]),_:1},8,["label"]),t(J,{label:e.$t("antivirus.threat_notifications")},{default:n(()=>[t(O,{modelValue:_.value.notifications,"onUpdate:modelValue":l[15]||(l[15]=c=>_.value.notifications=c),"inline-prompt":"","active-text":e.$t("common.on"),"inactive-text":e.$t("common.off")},null,8,["modelValue","active-text","inactive-text"]),a("div",ja,s(e.$t("antivirus.threat_notifications_desc")),1)]),_:1},8,["label"]),t(J,{label:e.$t("antivirus.scan_schedule")},{default:n(()=>[t(je,{modelValue:_.value.scanSchedule,"onUpdate:modelValue":l[16]||(l[16]=c=>_.value.scanSchedule=c),placeholder:e.$t("antivirus.select_time"),start:"00:00",step:"01:00",end:"23:00",disabled:!g.value.installed},null,8,["modelValue","placeholder","disabled"]),a("div",Ga,s(e.$t("antivirus.scan_schedule_desc")),1)]),_:1},8,["label"]),t(Ge),t(J,null,{default:n(()=>[a("div",Qa,[t(v,{type:"primary",onClick:Ve,loading:x.value},{default:n(()=>[t(o(r),{icon:"mdi:content-save"}),m(" "+s(e.$t("antivirus.save_settings")),1)]),_:1},8,["loading"]),t(v,{onClick:qe},{default:n(()=>[t(o(r),{icon:"mdi:restore"}),m(" "+s(e.$t("antivirus.reset_defaults")),1)]),_:1}),t(v,{onClick:me,type:"success",loading:G.value},{default:n(()=>[t(o(r),{icon:"mdi:cloud-download"}),m(" "+s(e.$t("antivirus.check_updates_now")),1)]),_:1},8,["loading"])])]),_:1})]),_:1},8,["model"])]),_:1})):S("",!0)])}}},xa=Xe(Xa,[["__scopeId","data-v-6e6775fe"]]);export{xa as default};
