import{_ as Ge,r as f,c as V,o as He,D as _e,b as y,d as w,e as g,g as t,f as a,w as o,k as r,I as u,m as p,t as d,h as q,i as x,n as j,F as U,l as O,G as be,v as z,x as h,E as B,C as re}from"./index-naspanel.js";const Ze={class:"load-balancer-dashboard"},Ke={class:"header-content"},Je={class:"header-left"},Ye={class:"header-icon"},Qe={class:"header-actions"},Xe={class:"stats-overview"},ea={class:"stat-content"},aa={class:"stat-info"},ta={class:"stat-value"},sa={class:"stat-sub"},la={class:"stat-content"},oa={class:"stat-info"},na={class:"stat-value"},ia={class:"stat-trend"},da={class:"stat-content"},ra={class:"stat-info"},ua={class:"stat-value"},ca={class:"stat-trend"},ma={class:"stat-content"},pa={class:"stat-info"},va={class:"stat-value"},ga={class:"stat-trend"},ha={class:"load-balancer-content"},fa={class:"card-header"},wa={class:"card-header-actions"},ya={class:"servers-list"},_a={class:"server-header"},ba={class:"server-title"},za={class:"server-address"},ka={class:"server-protocol"},Sa={class:"server-actions"},Ca={class:"server-config"},Ta={class:"config-grid"},Va={class:"config-item"},xa={class:"config-value"},Ra={class:"config-item"},Ma={class:"config-value"},ja={class:"config-item"},Ua={class:"config-value"},Na={class:"config-item"},Ia={class:"config-value"},La={class:"weight-control"},Pa={class:"weight-slider-container"},Ea={class:"server-stats"},Oa={class:"stats-grid"},Ba={class:"stat-item"},Aa={class:"stat-info"},$a={class:"stat-value"},Da={class:"stat-item"},Fa={class:"stat-info"},Wa={class:"stat-value"},qa={class:"stat-item"},Ga={class:"stat-info"},Ha={class:"stat-value"},Za={class:"stat-item"},Ka={class:"stat-info"},Ja={class:"stat-value"},Ya={class:"total-weight-info"},Qa={key:0},Xa={key:1},et={class:"card-header"},at={class:"card-header-actions"},tt={class:"algorithm-config"},st={class:"algorithm-option"},lt={class:"algorithm-option"},ot={class:"algorithm-option"},nt={class:"algorithm-option"},it={class:"hint"},dt={class:"card-header"},rt={class:"card-header-actions"},ut={class:"statistics-content"},ct={class:"chart-container"},mt={class:"traffic-chart"},pt=["title"],vt={class:"bar-label"},gt={class:"traffic-legend"},ht={class:"legend-text"},ft={class:"legend-value"},wt={class:"timeline-container"},yt={class:"timeline"},_t={class:"event-time"},bt={class:"event-details"},zt={class:"event-text"},kt={key:0,class:"no-events"},St={key:0,class:"test-results"},Ct={class:"results-grid"},Tt={class:"result-header"},Vt={class:"result-server"},xt={class:"result-stats"},Rt={class:"result-stat"},Mt={class:"stat-value"},jt={class:"result-stat"},Ut={class:"stat-value"},Nt={class:"result-stat"},It={class:"stat-value"},Lt={class:"results-summary"},Pt={class:"summary-text"},Et={class:"dialog-footer"},Ot={class:"logs-container"},Bt={class:"logs-header"},At={class:"logs-content"},$t={class:"log-timestamp"},Dt={class:"log-type"},Ft={class:"log-message"},Wt={key:0,class:"no-logs"},qt={__name:"LoadBalancer",setup(Gt){const i=f([]),m=f({enabled:!1,type:"weighted",healthCheck:!0,healthCheckInterval:"30s",failThreshold:3,stickySessions:!0,sessionTimeout:30}),N=f(!1),I=f(!1),M=f(!1),L=f(!1),X=f(!1),T=f(null),ee=f(!1),G=f(!1),H=f(!1),v=f({name:"",ip:"",port:8080,protocol:"http",maxConnections:1e3,timeout:5e3,weight:50}),A=f([]),Z=f([]),$=f(""),K=f(""),k=f(null),D=f("unknown"),S=f({requestTrend:0,responseTrend:0,errorTrend:0}),P=V(()=>i.value.reduce((s,e)=>s+(e.weight||0),0)),ue=V(()=>i.value.length>=2&&P.value===100&&m.value.enabled),ae=V(()=>i.value.length),te=V(()=>i.value.filter(s=>s.status==="healthy").length),ze=V(()=>i.value.reduce((s,e)=>s+(e.requestsPerMinute||0),0)),ke=V(()=>{const s=i.value.filter(e=>e.status==="healthy"&&e.responseTime);return s.length===0?0:Math.round(s.reduce((e,n)=>e+n.responseTime,0)/s.length)}),Se=V(()=>i.value.length===0?0:i.value.filter(e=>e.status!=="healthy").length/i.value.length*100),Ce=V(()=>{switch(D.value){case"operational":return"Działa poprawnie";case"degraded":return"Obniżona wydajność";case"failed":return"Awaria";default:return"Nieznany"}}),ce=V(()=>Z.value.filter(s=>{const e=!$.value||s.message.toLowerCase().includes($.value.toLowerCase())||JSON.stringify(s.details).toLowerCase().includes($.value.toLowerCase()),n=!K.value||s.type===K.value;return e&&n}).slice(0,100)),Te={name:[{required:!0,message:"Nazwa serwera jest wymagana",trigger:"blur"}],ip:[{required:!0,message:"Adres IP jest wymagany",trigger:"blur"},{validator:(s,e,n)=>{/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)?n():n(new Error("Nieprawidłowy adres IP"))},trigger:"blur"}],port:[{required:!0,message:"Port jest wymagany",trigger:"blur"}]};function me(s){return{healthy:"Działa",degraded:"Obniżona wydajność",down:"Nie działa",warning:"Ostrzeżenie",info:"Informacja"}[s]||s}function Ve(s){return{healthy:"mdi:server",degraded:"mdi:server-network",down:"mdi:server-off",warning:"mdi:server-alert",info:"mdi:server-security"}[s]||"mdi:help-circle"}function xe(s){return{healthy:"mdi:check-circle",degraded:"mdi:alert-circle",down:"mdi:close-circle",warning:"mdi:alert",info:"mdi:information"}[s]||"mdi:help-circle"}function Re(s){return{INFO:"info",WARNING:"warning",ERROR:"danger",CONFIG:"success",SERVER_ADD:"success",SERVER_REMOVE:"danger",SERVER_UPDATE:"warning"}[s]||"default"}function Me(s){return{INFO:"info",WARNING:"warning",ERROR:"danger",CONFIG:"success",TEST:"primary"}[s]||"default"}function je(s){return{excellent:"mdi:check-circle",good:"mdi:check",degraded:"mdi:alert-circle",poor:"mdi:close-circle"}[s]||"mdi:help-circle"}function pe(s){return{healthy:"#10b981",degraded:"#f59e0b",down:"#ef4444",warning:"#f59e0b",info:"#3b82f6"}[s.status]||"#64748b"}function se(s){return s?new Date(s).toLocaleTimeString("pl-PL",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}function Ue(){if(i.value.length>=10){h.warning("Maksymalnie można dodać 10 serwerów");return}T.value=null,v.value={name:`Serwer ${i.value.length+1}`,ip:"",port:8080,protocol:"http",maxConnections:1e3,timeout:5e3,weight:Math.floor(100/(i.value.length+1))},L.value=!0}function Ne(s){T.value=s;const e=i.value[s];v.value={name:e.name,ip:e.ip,port:e.port,protocol:e.protocol||"http",maxConnections:e.maxConnections||1e3,timeout:e.timeout||5e3,weight:e.weight},L.value=!0}async function Ie(){if(!v.value.ip||!v.value.port){h.warning("Podaj adres IP i port serwera");return}G.value=!0;try{(await z.get("/api/loadbalancer/test-server",{params:{ip:v.value.ip,port:v.value.port}})).data.success?h.success("Serwer odpowiada poprawnie"):h.warning("Serwer nie odpowiada lub zwraca błąd")}catch{h.error("Nie udało się połączyć z serwerem")}finally{G.value=!1}}async function Le(s){const e=i.value[s];e.healthCheckLoading=!0;try{const n=await z.get("/api/loadbalancer/check-health",{params:{ip:e.ip,port:e.port}});n.data.healthy?(e.status="healthy",e.responseTime=n.data.responseTime,e.lastChecked=new Date().toISOString(),h.success("Serwer działa poprawnie")):(e.status="down",h.warning("Serwer nie odpowiada"))}catch{e.status="down",h.error("Błąd podczas sprawdzania zdrowia serwera")}finally{e.healthCheckLoading=!1}}async function Pe(s){if(i.value.length<=2){h.warning("Musisz mieć co najmniej 2 serwery dla load balancingu");return}const e=i.value[s];try{if(await re.confirm(`Czy na pewno chcesz usunąć serwer "${e.name||e.ip}"?`,"Potwierdzenie usunięcia",{type:"warning",confirmButtonText:"Usuń",cancelButtonText:"Anuluj",distinguishCancelAndClose:!0})==="confirm"){const c=await z.delete(`/api/loadbalancer/servers/${e.id}`);if(c.data.success)i.value.splice(s,1),h.success("Serwer został usunięty"),ge();else throw new Error(c.data.error)}}catch(n){n!=="cancel"&&n!=="close"&&h.error("Błąd podczas usuwania serwera: "+n.message)}}async function Ee(){try{if(ee.value=!0,!v.value.ip){h.error("Adres IP jest wymagany");return}if(T.value!==null)(await z.put(`/api/loadbalancer/servers/${i.value[T.value].id}`,v.value)).data.success&&(i.value[T.value]={...i.value[T.value],...v.value},h.success("Serwer zaktualizowany"));else{const s=await z.post("/api/loadbalancer/servers",{server:v.value});s.data.success&&(i.value.push({...s.data.server,status:"healthy",requestsPerMinute:Math.floor(Math.random()*500)+500,responseTime:Math.floor(Math.random()*50)+30,cpuUsage:Math.floor(Math.random()*30)+40,memoryUsage:Math.floor(Math.random()*30)+40,lastChecked:new Date().toISOString()}),h.success("Nowy serwer dodany"),ge())}L.value=!1}catch(s){h.error("Błąd podczas zapisywania serwera: "+(s.response?.data?.error||s.message))}finally{ee.value=!1}}function Oe(s){const e=i.value.reduce((n,c)=>n+c.weight,0);if(e!==100){const n=e-100,c=i.value.filter((J,_)=>_!==s);if(c.length>0){const J=n/c.length;i.value.forEach((R,F)=>{F!==s&&(R.weight=Math.max(1,Math.min(100,Math.round(R.weight-J))))});const _=i.value.reduce((R,F)=>R+F.weight,0);_!==100&&(i.value[s].weight+=100-_,i.value[s].weight=Math.max(1,Math.min(100,i.value[s].weight)))}}}function ve(){if(i.value.length===0)return;const s=Math.floor(100/i.value.length),e=100-s*i.value.length;i.value.forEach((n,c)=>{n.weight=s+(c<e?1:0)}),h.success("Wagi automatycznie zrównoważone")}function ge(){if(i.value.length===0)return;const s=Math.floor(100/i.value.length),e=100-s*i.value.length;i.value.forEach((n,c)=>{n.weight=s+(c<e?1:0)})}async function Be(s){try{const e={...m.value,enabled:s,servers:i.value.map(c=>({ip:c.ip,port:c.port,weight:c.weight,name:c.name}))};(await z.post("/api/loadbalancer/config",{config:e})).data.success&&(m.value.enabled=s,B({title:s?"Włączono":"Wyłączono",message:s?"Load balancer został włączony":"Load balancer został wyłączony",type:"success",duration:3e3}))}catch{m.value.enabled=!s,B({title:"Błąd",message:"Nie udało się zmienić stanu load balancera",type:"error",duration:3e3})}}async function Ae(){try{N.value=!0;const s={...m.value,servers:i.value.map(n=>({ip:n.ip,port:n.port,weight:n.weight,name:n.name,protocol:n.protocol,maxConnections:n.maxConnections,timeout:n.timeout}))};(await z.post("/api/loadbalancer/apply",{config:s})).data.success&&(A.value.unshift({id:Date.now(),timestamp:new Date().toISOString(),status:"info",type:"CONFIG",message:`Zastosowano konfigurację load balancingu (${m.value.type})`}),B({title:"Sukces",message:"Konfiguracja load balancingu została zastosowana",type:"success",duration:3e3}),await he())}catch{B({title:"Błąd",message:"Nie udało się zastosować konfiguracji",type:"error",duration:3e3})}finally{N.value=!1}}async function $e(){try{I.value=!0;const s={...m.value,servers:i.value.map(n=>({ip:n.ip,port:n.port,weight:n.weight}))},e=await z.post("/api/loadbalancer/test",{config:s});e.data.success&&(k.value=e.data,e.data.results.forEach((n,c)=>{i.value[c]&&(i.value[c].responseTime=n.avgResponseTime,i.value[c].status=n.successRate>=95?"healthy":n.successRate>=80?"degraded":"down")}),A.value.unshift({id:Date.now(),timestamp:new Date().toISOString(),status:k.value.summary.overallStatus==="PASS"?"healthy":"warning",type:"TEST",message:`Przeprowadzono test load balancingu: ${k.value.summary.overallStatus}`}),B({title:"Test zakończony",message:e.data.message,type:k.value.summary.overallStatus==="PASS"?"success":"warning",duration:3e3}))}catch{B({title:"Błąd testu",message:"Nie udało się przeprowadzić testu",type:"error",duration:3e3})}finally{I.value=!1}}async function he(){await Promise.all([fe(),oe(),le()])}async function fe(){try{M.value=!0;const s=await z.get("/api/loadbalancer/stats");s.data.success&&(A.value=s.data.history||[],S.value=s.data.trends||{}),i.value.forEach(e=>{const n=Math.random()*.2-.1;e.requestsPerMinute=Math.max(100,Math.round((e.requestsPerMinute||500)*(1+n))),e.responseTime=Math.max(10,Math.round((e.responseTime||50)*(1+n))),e.cpuUsage=Math.max(10,Math.min(95,Math.round((e.cpuUsage||50)*(1+n)))),e.memoryUsage=Math.max(10,Math.min(95,Math.round((e.memoryUsage||50)*(1+n)))),e.cpuUsage>80||e.memoryUsage>85?e.status="degraded":e.cpuUsage>90||e.memoryUsage>95?e.status="warning":e.status="healthy"}),h.success("Statystyki odświeżone")}catch{h.error("Błąd podczas odświeżania statystyk")}finally{M.value=!1}}async function le(){try{const s=await z.get("/api/loadbalancer/status");s.data.success&&(i.value=s.data.config.servers||[],m.value={enabled:s.data.config.enabled||!1,type:s.data.config.algorithm||"weighted",healthCheck:s.data.config.healthCheck||!0,healthCheckInterval:s.data.config.healthCheckInterval||"30s",failThreshold:s.data.config.failThreshold||3,stickySessions:s.data.config.stickySessions||!0,sessionTimeout:s.data.config.sessionTimeout||30},D.value=s.data.overallStatus||"unknown")}catch(s){console.error("Failed to fetch load balancer status:",s)}}async function oe(){try{H.value=!0;const s=await z.get("/api/loadbalancer/logs");s.data.success&&(Z.value=s.data.logs||[])}catch{h.error("Błąd podczas ładowania logów")}finally{H.value=!1}}async function De(){try{await re.confirm("Czy na pewno chcesz wyczyścić wszystkie logi?","Potwierdzenie",{type:"warning",confirmButtonText:"Wyczyść",cancelButtonText:"Anuluj"})==="confirm"&&(await z.delete("/api/loadbalancer/logs")).data.success&&(Z.value=[],h.success("Logi zostały wyczyszczone"))}catch(s){s!=="cancel"&&h.error("Błąd podczas czyszczenia logów")}}function Fe(s){re.alert(`<pre>${JSON.stringify(s.details,null,2)}</pre>`,"Szczegóły logu",{dangerouslyUseHTMLString:!0,confirmButtonText:"OK",customClass:"log-details-dialog"})}return He(async()=>{await le(),await oe(),setInterval(async()=>{M.value||await le()},3e4)}),_e(()=>m.value,s=>{s.enabled&&h.info("Load balancer włączony")},{deep:!0}),_e(P,s=>{s!==100&&i.value.length>0&&h.warning(`Suma wag musi wynosić 100% (aktualnie: ${s}%)`)}),(s,e)=>{const n=y("el-tag"),c=y("el-button"),J=y("el-button-group"),_=y("el-card"),R=y("el-slider"),F=y("el-tooltip"),We=y("el-alert"),ne=y("el-switch"),Y=y("el-radio"),qe=y("el-radio-group"),b=y("el-form-item"),C=y("el-option"),ie=y("el-select"),Q=y("el-input-number"),we=y("el-form"),de=y("el-input"),ye=y("el-dialog");return g(),w("div",Ze,[t(_,{class:"dashboard-header",shadow:"hover"},{default:o(()=>[a("div",Ke,[a("div",Je,[a("div",Ye,[t(r(u),{icon:"mdi:server-network"})]),e[20]||(e[20]=a("div",{class:"header-text"},[a("h1",null,"Równoważenie obciążenia"),a("p",{class:"subtitle"},"Zarządzaj rozkładem obciążenia między serwerami")],-1))]),a("div",Qe,[t(n,{type:D.value==="operational"?"success":D.value==="degraded"?"warning":"danger",size:"large",class:"status-tag"},{default:o(()=>[t(r(u),{icon:D.value==="operational"?"mdi:check-circle":"mdi:alert-circle"},null,8,["icon"]),p(" "+d(Ce.value),1)]),_:1},8,["type"]),t(J,null,{default:o(()=>[t(c,{type:"primary",onClick:Ae,disabled:N.value||!ue.value,loading:N.value},{default:o(()=>[t(r(u),{icon:N.value?"mdi:loading":"mdi:check"},null,8,["icon"]),p(" "+d(N.value?"Stosowanie...":"Zastosuj konfigurację"),1)]),_:1},8,["disabled","loading"]),t(c,{type:"success",onClick:$e,disabled:I.value||!ue.value,loading:I.value},{default:o(()=>[t(r(u),{icon:I.value?"mdi:loading":"mdi:play"},null,8,["icon"]),p(" "+d(I.value?"Testowanie...":"Testuj konfigurację"),1)]),_:1},8,["disabled","loading"]),t(c,{type:"info",onClick:he,loading:M.value},{default:o(()=>[t(r(u),{icon:M.value?"mdi:loading":"mdi:refresh"},null,8,["icon"]),e[21]||(e[21]=p(" Odśwież "))]),_:1,__:[21]},8,["loading"])]),_:1})])])]),_:1}),a("div",Xe,[t(_,{class:"stat-card",shadow:"hover"},{default:o(()=>[a("div",ea,[t(r(u),{icon:"mdi:server",class:"stat-icon"}),a("div",aa,[a("div",ta,d(ae.value),1),e[22]||(e[22]=a("div",{class:"stat-label"},"Aktywnych serwerów",-1)),a("div",sa,[t(n,{size:"small",type:"success"},{default:o(()=>[p(d(te.value)+" zdrowych",1)]),_:1}),ae.value-te.value>0?(g(),q(n,{key:0,size:"small",type:"warning"},{default:o(()=>[p(d(ae.value-te.value)+" z problemami",1)]),_:1})):x("",!0)])])])]),_:1}),t(_,{class:"stat-card",shadow:"hover"},{default:o(()=>[a("div",la,[t(r(u),{icon:"mdi:chart-line",class:"stat-icon"}),a("div",oa,[a("div",na,d(ze.value.toLocaleString())+"/min",1),e[23]||(e[23]=a("div",{class:"stat-label"},"Żądań na minutę",-1)),a("div",ia,[t(r(u),{icon:S.value.requestTrend>0?"mdi:arrow-up":"mdi:arrow-down",class:j(S.value.requestTrend>0?"trend-up":"trend-down")},null,8,["icon","class"]),a("span",null,d(Math.abs(S.value.requestTrend))+"%",1)])])])]),_:1}),t(_,{class:"stat-card",shadow:"hover"},{default:o(()=>[a("div",da,[t(r(u),{icon:"mdi:timer-outline",class:"stat-icon"}),a("div",ra,[a("div",ua,d(ke.value)+"ms",1),e[24]||(e[24]=a("div",{class:"stat-label"},"Średni czas odpowiedzi",-1)),a("div",ca,[t(r(u),{icon:S.value.responseTrend<0?"mdi:arrow-down":"mdi:arrow-up",class:j(S.value.responseTrend<0?"trend-up":"trend-down")},null,8,["icon","class"]),a("span",null,d(Math.abs(S.value.responseTrend))+"%",1)])])])]),_:1}),t(_,{class:"stat-card",shadow:"hover"},{default:o(()=>[a("div",ma,[t(r(u),{icon:"mdi:alert-circle",class:"stat-icon"}),a("div",pa,[a("div",va,d(Se.value.toFixed(2))+"%",1),e[25]||(e[25]=a("div",{class:"stat-label"},"Wskaźnik błędów",-1)),a("div",ga,[t(r(u),{icon:S.value.errorTrend<0?"mdi:arrow-down":"mdi:arrow-up",class:j(S.value.errorTrend<0?"trend-up":"trend-down")},null,8,["icon","class"]),a("span",null,d(Math.abs(S.value.errorTrend))+"%",1)])])])]),_:1})]),a("div",ha,[t(_,{class:"servers-card",shadow:"hover"},{header:o(()=>[a("div",fa,[a("h2",null,[t(r(u),{icon:"mdi:server"}),e[26]||(e[26]=p(" Konfiguracja serwerów "))]),a("div",wa,[t(c,{type:"primary",onClick:Ue,disabled:i.value.length>=10},{default:o(()=>[t(r(u),{icon:"mdi:plus"}),e[27]||(e[27]=p(" Dodaj serwer "))]),_:1,__:[27]},8,["disabled"])])])]),default:o(()=>[a("div",ya,[(g(!0),w(U,null,O(i.value,(l,E)=>(g(),w("div",{key:l.id,class:j(["server-item",`status-${l.status}`])},[a("div",_a,[a("div",ba,[a("h3",null,[t(r(u),{icon:Ve(l.status)},null,8,["icon"]),p(" "+d(l.name||`Serwer ${E+1}`)+" ",1),l.status!=="healthy"?(g(),q(n,{key:0,type:l.status==="degraded"?"warning":"danger",size:"small",class:"status-tag-inline"},{default:o(()=>[p(d(me(l.status)),1)]),_:2},1032,["type"])):x("",!0)]),a("div",za,[t(r(u),{icon:"mdi:ip-network"}),p(" "+d(l.ip)+":"+d(l.port)+" ",1),a("span",ka,d(l.protocol?.toUpperCase()),1)])]),a("div",Sa,[t(c,{size:"small",circle:"",onClick:W=>Ne(E),disabled:l.status==="down"},{default:o(()=>[t(r(u),{icon:"mdi:pencil"})]),_:2},1032,["onClick","disabled"]),t(c,{size:"small",circle:"",onClick:W=>Le(E),loading:l.healthCheckLoading},{default:o(()=>[t(r(u),{icon:"mdi:heart-pulse"})]),_:2},1032,["onClick","loading"]),t(c,{size:"small",type:"danger",circle:"",onClick:W=>Pe(E),disabled:i.value.length<=2},{default:o(()=>[t(r(u),{icon:"mdi:delete"})]),_:2},1032,["onClick","disabled"])])]),a("div",Ca,[a("div",Ta,[a("div",Va,[e[28]||(e[28]=a("label",null,"Waga:",-1)),a("span",xa,d(l.weight)+"%",1)]),a("div",Ra,[e[29]||(e[29]=a("label",null,"Max połączeń:",-1)),a("span",Ma,d(l.maxConnections?.toLocaleString()||"1000"),1)]),a("div",ja,[e[30]||(e[30]=a("label",null,"Timeout:",-1)),a("span",Ua,d(l.timeout)+"ms",1)]),a("div",Na,[e[31]||(e[31]=a("label",null,"Ostatnie sprawdzenie:",-1)),a("span",Ia,d(se(l.lastChecked)),1)])]),a("div",La,[e[32]||(e[32]=a("label",null,"Rozkład obciążenia:",-1)),a("div",Pa,[t(R,{modelValue:l.weight,"onUpdate:modelValue":W=>l.weight=W,min:1,max:100,step:1,"show-stops":"","show-input":"",disabled:l.status==="down",onChange:W=>Oe(E)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),t(F,{content:"Automatyczne równoważenie wag",placement:"top"},{default:o(()=>[t(c,{size:"small",circle:"",onClick:ve},{default:o(()=>[t(r(u),{icon:"mdi:scale-balance"})]),_:1})]),_:1})])])]),a("div",Ea,[a("div",Oa,[a("div",Ba,[t(r(u),{icon:"mdi:chart-line",class:"stat-icon"}),a("div",Aa,[a("div",$a,d(l.requestsPerMinute?.toLocaleString()||0),1),e[33]||(e[33]=a("div",{class:"stat-label"},"Żądań/min",-1))])]),a("div",Da,[t(r(u),{icon:"mdi:timer-outline",class:"stat-icon"}),a("div",Fa,[a("div",Wa,d(l.responseTime||0)+"ms",1),e[34]||(e[34]=a("div",{class:"stat-label"},"Czas odpowiedzi",-1))])]),a("div",qa,[t(r(u),{icon:"mdi:memory",class:"stat-icon"}),a("div",Ga,[a("div",Ha,d(l.cpuUsage||0)+"%",1),e[35]||(e[35]=a("div",{class:"stat-label"},"CPU",-1))])]),a("div",Za,[t(r(u),{icon:"mdi:memory",class:"stat-icon"}),a("div",Ka,[a("div",Ja,d(l.memoryUsage||0)+"%",1),e[36]||(e[36]=a("div",{class:"stat-label"},"RAM",-1))])])])])],2))),128))]),a("div",Ya,[t(We,{title:`Suma wag: ${P.value}%`,type:P.value===100?"success":"warning",closable:!1,"show-icon":""},{default:o(()=>[P.value===100?(g(),w("span",Qa," Konfiguracja poprawna. Obciążenie będzie rozłożone zgodnie z wagami. ")):(g(),w("span",Xa,[p(" Suma wag musi wynosić 100%. Aktualnie: "+d(P.value)+"% ",1),t(c,{type:"text",onClick:ve},{default:o(()=>e[37]||(e[37]=[p("Automatycznie równoważ")])),_:1,__:[37]})]))]),_:1},8,["title","type"])])]),_:1}),t(_,{class:"algorithm-card",shadow:"hover"},{header:o(()=>[a("div",et,[a("h2",null,[t(r(u),{icon:"mdi:algorithm"}),e[38]||(e[38]=p(" Algorytm równoważenia "))]),a("div",at,[t(ne,{modelValue:m.value.enabled,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value.enabled=l),"active-text":"Włączony","inactive-text":"Wyłączony",onChange:Be},null,8,["modelValue"])])])]),default:o(()=>[a("div",tt,[t(we,{model:m.value,"label-width":"200px"},{default:o(()=>[t(b,{label:"Typ algorytmu"},{default:o(()=>[t(qe,{modelValue:m.value.type,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value.type=l),disabled:!m.value.enabled},{default:o(()=>[t(Y,{label:"round-robin"},{default:o(()=>[a("div",st,[t(r(u),{icon:"mdi:refresh",class:"option-icon"}),e[39]||(e[39]=a("div",{class:"option-text"},[a("div",{class:"option-title"},"Round Robin"),a("div",{class:"option-desc"},"Równomierne przełączanie między serwerami")],-1))])]),_:1}),t(Y,{label:"weighted"},{default:o(()=>[a("div",lt,[t(r(u),{icon:"mdi:scale-balance",class:"option-icon"}),e[40]||(e[40]=a("div",{class:"option-text"},[a("div",{class:"option-title"},"Waży (Weighted)"),a("div",{class:"option-desc"},"Rozkład proporcjonalny do wagi serwerów")],-1))])]),_:1}),t(Y,{label:"least-connections"},{default:o(()=>[a("div",ot,[t(r(u),{icon:"mdi:connection",class:"option-icon"}),e[41]||(e[41]=a("div",{class:"option-text"},[a("div",{class:"option-title"},"Najmniej połączeń"),a("div",{class:"option-desc"},"Kierowanie do serwera z najmniejszą liczbą połączeń")],-1))])]),_:1}),t(Y,{label:"ip-hash"},{default:o(()=>[a("div",nt,[t(r(u),{icon:"mdi:fingerprint",class:"option-icon"}),e[42]||(e[42]=a("div",{class:"option-text"},[a("div",{class:"option-title"},"Hash IP"),a("div",{class:"option-desc"},"Klient zawsze trafia do tego samego serwera")],-1))])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),t(b,{label:"Sprawdzanie zdrowia"},{default:o(()=>[t(ne,{modelValue:m.value.healthCheck,"onUpdate:modelValue":e[2]||(e[2]=l=>m.value.healthCheck=l),disabled:!m.value.enabled},null,8,["modelValue","disabled"]),e[43]||(e[43]=a("span",{class:"hint"},"Automatycznie wykrywaj i omijaj uszkodzone serwery",-1))]),_:1,__:[43]}),m.value.healthCheck?(g(),w(U,{key:0},[t(b,{label:"Interwał sprawdzania"},{default:o(()=>[t(ie,{modelValue:m.value.healthCheckInterval,"onUpdate:modelValue":e[3]||(e[3]=l=>m.value.healthCheckInterval=l),style:{width:"200px"},disabled:!m.value.enabled},{default:o(()=>[t(C,{label:"Co 10 sekund",value:"10s"}),t(C,{label:"Co 30 sekund",value:"30s"}),t(C,{label:"Co 1 minutę",value:"1m"}),t(C,{label:"Co 5 minut",value:"5m"})]),_:1},8,["modelValue","disabled"])]),_:1}),t(b,{label:"Próg awarii"},{default:o(()=>[t(R,{modelValue:m.value.failThreshold,"onUpdate:modelValue":e[4]||(e[4]=l=>m.value.failThreshold=l),min:1,max:10,step:1,"show-stops":"","show-input":"",disabled:!m.value.enabled},null,8,["modelValue","disabled"]),a("span",it,d(m.value.failThreshold)+" nieudanych prób z rzędu oznacza awarię",1)]),_:1})],64)):x("",!0),t(b,{label:"Sticky sessions"},{default:o(()=>[t(ne,{modelValue:m.value.stickySessions,"onUpdate:modelValue":e[5]||(e[5]=l=>m.value.stickySessions=l),disabled:!m.value.enabled},null,8,["modelValue","disabled"]),e[44]||(e[44]=a("span",{class:"hint"},"Zachowaj sesję użytkownika na tym samym serwerze",-1))]),_:1,__:[44]}),m.value.stickySessions?(g(),q(b,{key:1,label:"Czas trwania sesji"},{default:o(()=>[t(Q,{modelValue:m.value.sessionTimeout,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value.sessionTimeout=l),min:1,max:120,step:1,"controls-position":"right",disabled:!m.value.enabled},null,8,["modelValue","disabled"]),e[45]||(e[45]=a("span",{class:"hint"},"minut",-1))]),_:1,__:[45]})):x("",!0)]),_:1},8,["model"])])]),_:1}),t(_,{class:"statistics-card",shadow:"hover"},{header:o(()=>[a("div",dt,[a("h2",null,[t(r(u),{icon:"mdi:chart-bar"}),e[46]||(e[46]=p(" Statystyki i monitoring "))]),a("div",rt,[t(c,{type:"info",onClick:fe,loading:M.value},{default:o(()=>[t(r(u),{icon:M.value?"mdi:loading":"mdi:refresh"},null,8,["icon"]),e[47]||(e[47]=p(" Odśwież "))]),_:1,__:[47]},8,["loading"]),t(c,{type:"default",onClick:e[7]||(e[7]=l=>X.value=!0)},{default:o(()=>[t(r(u),{icon:"mdi:text-box-outline"}),e[48]||(e[48]=p(" Pokaż logi "))]),_:1,__:[48]})])])]),default:o(()=>[a("div",ut,[a("div",ct,[e[49]||(e[49]=a("h3",null,"Rozkład ruchu",-1)),a("div",mt,[(g(!0),w(U,null,O(i.value,l=>(g(),w("div",{key:l.id,class:"traffic-bar",style:be({width:`${l.weight}%`,backgroundColor:pe(l)}),title:`${l.name||l.ip}: ${l.weight}%`},[a("span",vt,d(l.weight)+"%",1)],12,pt))),128))]),a("div",gt,[(g(!0),w(U,null,O(i.value,l=>(g(),w("div",{key:l.id,class:"legend-item"},[a("span",{class:"legend-color",style:be({backgroundColor:pe(l)})},null,4),a("span",ht,d(l.name||l.ip),1),a("span",ft,d(l.weight)+"%",1),t(n,{size:"small",type:l.status==="healthy"?"success":l.status==="degraded"?"warning":"danger"},{default:o(()=>[p(d(me(l.status)),1)]),_:2},1032,["type"])]))),128))])]),a("div",wt,[e[51]||(e[51]=a("h3",null,"Historia statusów",-1)),a("div",yt,[(g(!0),w(U,null,O(A.value,l=>(g(),w("div",{key:l.id,class:j(["timeline-event",`status-${l.status||"info"}`])},[a("div",_t,d(se(l.timestamp)),1),a("div",bt,[t(r(u),{icon:xe(l.status||"info"),class:"event-icon"},null,8,["icon"]),a("span",zt,d(l.message),1)]),l.type?(g(),q(n,{key:0,size:"small",type:Re(l.type),class:"event-type"},{default:o(()=>[p(d(l.type),1)]),_:2},1032,["type"])):x("",!0)],2))),128)),A.value.length===0?(g(),w("div",kt,[t(r(u),{icon:"mdi:information-outline"}),e[50]||(e[50]=a("span",null,"Brak historii zdarzeń",-1))])):x("",!0)])]),k.value?(g(),w("div",St,[e[55]||(e[55]=a("h3",null,"Ostatni test konfiguracji",-1)),a("div",Ct,[(g(!0),w(U,null,O(k.value.results,l=>(g(),w("div",{key:l.ip,class:j(["result-card",`result-${l.status}`])},[a("div",Tt,[t(r(u),{icon:je(l.status)},null,8,["icon"]),a("span",Vt,d(l.ip)+":"+d(l.port),1)]),a("div",xt,[a("div",Rt,[e[52]||(e[52]=a("span",{class:"stat-label"},"Sukces:",-1)),a("span",Mt,d(l.successRate.toFixed(1))+"%",1)]),a("div",jt,[e[53]||(e[53]=a("span",{class:"stat-label"},"Średni czas:",-1)),a("span",Ut,d(l.avgResponseTime)+"ms",1)]),a("div",Nt,[e[54]||(e[54]=a("span",{class:"stat-label"},"Testy:",-1)),a("span",It,d(l.successful)+"/"+d(l.successful+l.failed),1)])])],2))),128))]),a("div",Lt,[t(n,{type:k.value.summary.overallStatus==="PASS"?"success":"danger",size:"large"},{default:o(()=>[p(d(k.value.summary.overallStatus==="PASS"?"TEST PRZESZŁY":"TEST NIEUDANY"),1)]),_:1},8,["type"]),a("span",Pt,d(k.value.summary.serversPassing)+"/"+d(k.value.summary.totalServers)+" serwerów działa poprawnie ",1)])])):x("",!0)])]),_:1})]),t(ye,{modelValue:L.value,"onUpdate:modelValue":e[16]||(e[16]=l=>L.value=l),title:T.value!==null?"Edytuj serwer":"Dodaj nowy serwer",width:"500px"},{footer:o(()=>[a("span",Et,[t(c,{onClick:e[15]||(e[15]=l=>L.value=!1)},{default:o(()=>e[57]||(e[57]=[p("Anuluj")])),_:1,__:[57]}),t(c,{type:"primary",onClick:Ee,loading:ee.value},{default:o(()=>[p(d(T.value!==null?"Zapisz zmiany":"Dodaj serwer"),1)]),_:1},8,["loading"])])]),default:o(()=>[t(we,{model:v.value,"label-width":"120px",ref:"serverFormRef",rules:Te},{default:o(()=>[t(b,{label:"Nazwa serwera",prop:"name"},{default:o(()=>[t(de,{modelValue:v.value.name,"onUpdate:modelValue":e[8]||(e[8]=l=>v.value.name=l),placeholder:"np. Serwer produkcyjny 1"},null,8,["modelValue"])]),_:1}),t(b,{label:"Adres IP",prop:"ip",required:""},{default:o(()=>[t(de,{modelValue:v.value.ip,"onUpdate:modelValue":e[9]||(e[9]=l=>v.value.ip=l),placeholder:"192.168.1.100"},{append:o(()=>[t(c,{onClick:Ie,loading:G.value},{default:o(()=>[t(r(u),{icon:G.value?"mdi:loading":"mdi:connection"},null,8,["icon"]),e[56]||(e[56]=p(" Testuj "))]),_:1,__:[56]},8,["loading"])]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"Port",prop:"port",required:""},{default:o(()=>[t(Q,{modelValue:v.value.port,"onUpdate:modelValue":e[10]||(e[10]=l=>v.value.port=l),min:1,max:65535,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(b,{label:"Protokół"},{default:o(()=>[t(ie,{modelValue:v.value.protocol,"onUpdate:modelValue":e[11]||(e[11]=l=>v.value.protocol=l),style:{width:"100%"}},{default:o(()=>[t(C,{label:"HTTP",value:"http"}),t(C,{label:"HTTPS",value:"https"})]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"Maks. połączeń"},{default:o(()=>[t(Q,{modelValue:v.value.maxConnections,"onUpdate:modelValue":e[12]||(e[12]=l=>v.value.maxConnections=l),min:1,max:1e4,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(b,{label:"Timeout (ms)"},{default:o(()=>[t(Q,{modelValue:v.value.timeout,"onUpdate:modelValue":e[13]||(e[13]=l=>v.value.timeout=l),min:100,max:3e4,step:100,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(b,{label:"Waga początkowa"},{default:o(()=>[t(R,{modelValue:v.value.weight,"onUpdate:modelValue":e[14]||(e[14]=l=>v.value.weight=l),min:1,max:100,step:1,"show-input":"",disabled:T.value===null},null,8,["modelValue","disabled"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(ye,{modelValue:X.value,"onUpdate:modelValue":e[19]||(e[19]=l=>X.value=l),title:"Logi Load Balancera",width:"800px",top:"5vh"},{default:o(()=>[a("div",Ot,[a("div",Bt,[t(de,{modelValue:$.value,"onUpdate:modelValue":e[17]||(e[17]=l=>$.value=l),placeholder:"Filtruj logi...",clearable:"",style:{width:"300px"}},{prefix:o(()=>[t(r(u),{icon:"mdi:magnify"})]),_:1},8,["modelValue"]),t(ie,{modelValue:K.value,"onUpdate:modelValue":e[18]||(e[18]=l=>K.value=l),placeholder:"Filtruj typ",clearable:"",style:{width:"150px"}},{default:o(()=>[t(C,{label:"INFO",value:"INFO"}),t(C,{label:"WARNING",value:"WARNING"}),t(C,{label:"ERROR",value:"ERROR"}),t(C,{label:"CONFIG",value:"CONFIG"})]),_:1},8,["modelValue"]),t(c,{onClick:oe,loading:H.value},{default:o(()=>[t(r(u),{icon:H.value?"mdi:loading":"mdi:refresh"},null,8,["icon"]),e[58]||(e[58]=p(" Odśwież "))]),_:1,__:[58]},8,["loading"]),t(c,{type:"danger",onClick:De,disabled:Z.value.length===0},{default:o(()=>[t(r(u),{icon:"mdi:delete"}),e[59]||(e[59]=p(" Wyczyść logi "))]),_:1,__:[59]},8,["disabled"])]),a("div",At,[(g(!0),w(U,null,O(ce.value,l=>(g(),w("div",{key:l.timestamp,class:j(["log-entry",`log-${l.type?.toLowerCase()}`])},[a("div",$t,d(se(l.timestamp)),1),a("div",Dt,[t(n,{type:Me(l.type),size:"small"},{default:o(()=>[p(d(l.type),1)]),_:2},1032,["type"])]),a("div",Ft,d(l.message),1),l.details?(g(),q(c,{key:0,size:"small",type:"text",onClick:E=>Fe(l)},{default:o(()=>[t(r(u),{icon:"mdi:information-outline"}),e[60]||(e[60]=p(" Szczegóły "))]),_:2,__:[60]},1032,["onClick"])):x("",!0)],2))),128)),ce.value.length===0?(g(),w("div",Wt,[t(r(u),{icon:"mdi:text-box-remove-outline"}),e[61]||(e[61]=a("span",null,"Brak logów do wyświetlenia",-1))])):x("",!0)])])]),_:1},8,["modelValue"])])}}},Zt=Ge(qt,[["__scopeId","data-v-c98ea8e4"]]);export{Zt as default};
