import{_ as T,r as g,s as q,o as G,b as d,A as J,d as S,e as k,g as t,w as a,B as K,h as N,f as w,k as i,I as r,t as C,F as Q,l as X,m as s,v as h,x as y,C as Y}from"./index-naspanel.js";const ee={class:"power-schedule"},te={class:"card-header"},ae={class:"header-title"},le={class:"action-cell"},oe={__name:"Schedule",setup(ne){const z=g(!1),m=g(!1),c=g(null),_=g([]),n=q({action:"restart",time:"00:00",days:[],enabled:!0}),W=async()=>{z.value=!0;try{const o=await h.get("/power/schedules");_.value=o.data.schedules}catch(o){console.error("Błąd podczas ładowania harmonogramów:",o),y.error("Nie udało się załadować harmonogramów")}finally{z.value=!1}},j=o=>({shutdown:"mdi:power",restart:"mdi:restart",wake:"mdi:power-on"})[o]||"mdi:clock",A=o=>({shutdown:"Wyłącz",restart:"Restart",wake:"Włącz"})[o]||o,B=o=>({monday:"Pn",tuesday:"Wt",wednesday:"Śr",thursday:"Cz",friday:"Pt",saturday:"Sb",sunday:"Nd"})[o]||o,H=o=>{c.value=o,Object.assign(n,o),m.value=!0},D=async o=>{try{await Y.confirm("Czy na pewno chcesz usunąć harmonogram?","Potwierdzenie usunięcia",{type:"warning"}),await h.delete(`/power/schedules/${o.id}`),_.value=_.value.filter(e=>e.id!==o.id),y.success("Harmonogram usunięty")}catch{}},P=async()=>{try{if(c.value)await h.post("/power/schedules",{schedule:n}),Object.assign(c.value,n),y.success("Harmonogram zaktualizowany");else{const e={id:(await h.post("/power/schedules",{schedule:n})).data.id,...n};_.value.push(e),y.success("Harmonogram dodany")}m.value=!1,c.value=null,U()}catch(o){console.error("Błąd podczas zapisywania harmonogramu:",o),y.error("Nie udało się zapisać harmonogramu")}},U=()=>{Object.assign(n,{action:"restart",time:"00:00",days:[],enabled:!0})};return G(()=>{W()}),(o,e)=>{const p=d("el-button"),f=d("el-table-column"),x=d("el-tag"),$=d("el-table"),V=d("el-option"),E=d("el-select"),b=d("el-form-item"),I=d("el-time-picker"),u=d("el-checkbox"),O=d("el-checkbox-group"),F=d("el-switch"),M=d("el-form"),R=d("el-dialog"),L=d("el-card"),Z=J("loading");return k(),S("div",ee,[t(L,{shadow:"hover"},{header:a(()=>[w("div",te,[w("div",ae,[t(i(r),{icon:"mdi:clock-outline",width:"24"}),e[7]||(e[7]=w("h2",null,"Harmonogram Zasilania",-1))]),t(p,{type:"primary",onClick:e[0]||(e[0]=l=>m.value=!0)},{default:a(()=>[t(i(r),{icon:"mdi:plus",width:"16"}),e[8]||(e[8]=s(" Nowy harmonogram "))]),_:1,__:[8]})])]),default:a(()=>[K((k(),N($,{data:_.value,style:{width:"100%"}},{default:a(()=>[t(f,{label:"Akcja",width:"120"},{default:a(({row:l})=>[w("div",le,[t(i(r),{icon:j(l.action),width:"20"},null,8,["icon"]),w("span",null,C(A(l.action)),1)])]),_:1}),t(f,{prop:"time",label:"Czas",width:"100"}),t(f,{label:"Dni tygodnia",width:"200"},{default:a(({row:l})=>[(k(!0),S(Q,null,X(l.days,v=>(k(),N(x,{key:v,size:"small",class:"day-tag"},{default:a(()=>[s(C(B(v)),1)]),_:2},1024))),128))]),_:1}),t(f,{label:"Status",width:"100"},{default:a(({row:l})=>[t(x,{type:l.enabled?"success":"info"},{default:a(()=>[s(C(l.enabled?"Aktywny":"Nieaktywny"),1)]),_:2},1032,["type"])]),_:1}),t(f,{label:"Operacje",width:"150"},{default:a(({row:l})=>[t(p,{size:"small",onClick:v=>H(l)},{default:a(()=>[t(i(r),{icon:"mdi:pencil",width:"14"})]),_:2},1032,["onClick"]),t(p,{size:"small",type:"danger",onClick:v=>D(l)},{default:a(()=>[t(i(r),{icon:"mdi:delete",width:"14"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Z,z.value]]),t(R,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value=l),title:c.value?"Edytuj harmonogram":"Nowy harmonogram",width:"500px"},{footer:a(()=>[t(p,{onClick:e[5]||(e[5]=l=>m.value=!1)},{default:a(()=>e[19]||(e[19]=[s("Anuluj")])),_:1,__:[19]}),t(p,{type:"primary",onClick:P},{default:a(()=>e[20]||(e[20]=[s(" Zapisz ")])),_:1,__:[20]})]),default:a(()=>[t(M,{model:n,"label-width":"120px"},{default:a(()=>[t(b,{label:"Akcja"},{default:a(()=>[t(E,{modelValue:n.action,"onUpdate:modelValue":e[1]||(e[1]=l=>n.action=l),placeholder:"Wybierz akcję"},{default:a(()=>[t(V,{value:"shutdown",label:"Wyłącz"},{default:a(()=>[t(i(r),{icon:"mdi:power",width:"16"}),e[9]||(e[9]=s(" Wyłącz "))]),_:1,__:[9]}),t(V,{value:"restart",label:"Restart"},{default:a(()=>[t(i(r),{icon:"mdi:restart",width:"16"}),e[10]||(e[10]=s(" Restart "))]),_:1,__:[10]}),t(V,{value:"wake",label:"Włącz"},{default:a(()=>[t(i(r),{icon:"mdi:power-on",width:"16"}),e[11]||(e[11]=s(" Włącz "))]),_:1,__:[11]})]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"Czas"},{default:a(()=>[t(I,{modelValue:n.time,"onUpdate:modelValue":e[2]||(e[2]=l=>n.time=l),format:"HH:mm","value-format":"HH:mm",placeholder:"Wybierz czas"},null,8,["modelValue"])]),_:1}),t(b,{label:"Dni tygodnia"},{default:a(()=>[t(O,{modelValue:n.days,"onUpdate:modelValue":e[3]||(e[3]=l=>n.days=l)},{default:a(()=>[t(u,{label:"monday"},{default:a(()=>e[12]||(e[12]=[s("Poniedziałek")])),_:1,__:[12]}),t(u,{label:"tuesday"},{default:a(()=>e[13]||(e[13]=[s("Wtorek")])),_:1,__:[13]}),t(u,{label:"wednesday"},{default:a(()=>e[14]||(e[14]=[s("Środa")])),_:1,__:[14]}),t(u,{label:"thursday"},{default:a(()=>e[15]||(e[15]=[s("Czwartek")])),_:1,__:[15]}),t(u,{label:"friday"},{default:a(()=>e[16]||(e[16]=[s("Piątek")])),_:1,__:[16]}),t(u,{label:"saturday"},{default:a(()=>e[17]||(e[17]=[s("Sobota")])),_:1,__:[17]}),t(u,{label:"sunday"},{default:a(()=>e[18]||(e[18]=[s("Niedziela")])),_:1,__:[18]})]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"Status"},{default:a(()=>[t(F,{modelValue:n.enabled,"onUpdate:modelValue":e[4]||(e[4]=l=>n.enabled=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})])}}},de=T(oe,[["__scopeId","data-v-41df496f"]]);export{de as default};
