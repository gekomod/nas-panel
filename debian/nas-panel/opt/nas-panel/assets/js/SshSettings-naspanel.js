import{_ as ns,u as is,r as _,o as as,H as ls,b as v,d as $,e as b,f as t,g as e,w as a,k as l,I as c,m as u,t as o,i as K,h as cs,F as ds,l as rs,n as us,v as y,x as h,C as vs}from"./index-naspanel.js";const hs={class:"ssh-settings-modern"},gs={class:"ssh-header-panel"},ps={class:"service-header"},ms={class:"service-icon-container"},_s={class:"service-status-badge"},fs={class:"service-info"},Ss={class:"service-title"},bs={class:"service-meta"},ws={key:0,class:"version-info"},$s={class:"port-info"},ys={class:"update-time"},Vs={class:"service-actions"},ks={class:"service-toggle"},Cs={class:"toggle-label"},As={class:"config-section"},Us={class:"tab-content"},Ls={class:"config-grid"},zs={class:"config-group"},Ts={class:"config-group-header"},Is={class:"config-item"},Rs={class:"config-label"},Os={class:"config-hint"},Bs={class:"config-group"},Ns={class:"config-group-header"},Es={class:"config-item"},Hs={class:"config-label"},Ds={class:"config-switch-wrapper"},Fs={class:"config-hint"},Ks={class:"config-item"},qs={class:"config-label"},Ps={class:"config-switch-wrapper"},js={class:"config-hint"},Ms={class:"config-item"},Qs={class:"config-label"},Js={class:"config-switch-wrapper"},Ws={class:"config-hint warning-hint"},Gs={class:"config-group"},Xs={class:"config-group-header"},Ys={class:"config-item"},Zs={class:"config-label"},xs={class:"config-switch-wrapper"},st={class:"config-hint"},tt={class:"config-item"},et={class:"config-label"},ot={class:"config-switch-wrapper"},nt={class:"config-hint"},it={class:"config-item"},at={class:"config-label"},lt={class:"config-hint"},ct={class:"advanced-options"},dt={class:"advanced-options-header"},rt={class:"config-actions"},ut={class:"tab-content"},vt={class:"status-grid"},ht={class:"status-card"},gt={class:"status-header"},pt={class:"status-details"},mt={class:"status-item"},_t={class:"status-item"},ft={class:"status-value"},St={class:"status-item"},bt={class:"status-item"},wt={class:"status-item"},$t={class:"status-card logs-card"},yt={class:"status-header"},Vt={class:"logs-container"},kt={class:"status-output"},Ct={class:"logs-actions"},At={class:"tab-content"},Ut={class:"connections-header"},Lt={class:"connections-info"},zt={class:"connections-actions"},Tt={key:0,class:"empty-state"},It={key:1,class:"connections-grid"},Rt={class:"connection-header"},Ot={class:"connection-icon"},Bt={class:"conn-user"},Nt={class:"conn-username"},Et={class:"conn-pid"},Ht={class:"connection-details"},Dt={class:"conn-address"},Ft={class:"address-item"},Kt={class:"address-value"},qt={class:"address-item"},Pt={class:"address-value"},jt={class:"conn-meta"},Mt={class:"meta-item"},Qt={class:"meta-item"},Jt={class:"connection-actions"},Wt={__name:"SshSettings",setup(Gt){const{t:g}=is(),T=_("basic"),f=_(!1),I=_(!1),R=_(!1),V=_(!1),H=_(""),r=_({installed:!1,active:!1,version:"",details:""}),w=_([]),O={port:22,allowRootLogin:!1,passwordAuthentication:!0,publicKeyAuthentication:!0,tcpForwarding:!1,compression:!1,maxSessions:10,additionalOptions:""},d=_({...O}),C=_(22),A=_(!1),q=()=>{H.value=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},P=s=>s?s.includes("ESTAB")?"success":s.includes("TIME_WAIT")?"warning":"info":"info",j=()=>{navigator.clipboard.writeText(r.value.details).then(()=>h.success(g("sshSettings.copied"))).catch(()=>h.error(g("sshSettings.copyError")))},M=()=>{C.value=d.value.port,A.value=d.value.allowRootLogin,V.value=!0},Q=async()=>{try{d.value.port=C.value,d.value.allowRootLogin=A.value,await D(),V.value=!1}catch(s){h.error(s.message)}},J=()=>{const s=JSON.stringify(w.value,null,2),n=new Blob([s],{type:"application/json"}),L=URL.createObjectURL(n),p=document.createElement("a");p.href=L,p.download=`ssh-connections-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(L),h.success(g("sshSettings.exported"))},W=async s=>{try{await vs.confirm(g("sshSettings.confirmKillConnection",{pid:s}),g("sshSettings.warning"),{confirmButtonText:g("sshSettings.confirm"),cancelButtonText:g("sshSettings.cancel"),type:"warning"}),(await y.post("/services/ssh/kill-connection",{pid:s})).data.success&&(h.success(g("sshSettings.connectionKilled")),await U())}catch(n){n!=="cancel"&&h.error(n.response?.data?.error||n.message)}},k=async()=>{try{f.value=!0;const s=await y.get("/services/ssh/status");r.value=s.data,q()}catch(s){h.error(s.response?.data?.error||s.message)}finally{f.value=!1}},G=async()=>{try{const s=await y.get("/services/ssh/config");s.data.config&&(d.value={...O,...s.data.config})}catch(s){h.error(s.response?.data?.error||s.message)}},U=async()=>{try{R.value=!0;const s=await y.get("/services/ssh/connections");w.value=s.data.connections||[]}catch(s){h.error(s.response?.data?.error||s.message)}finally{R.value=!1}},X=async()=>{try{f.value=!0;const s=r.value.active?"start":"stop";(await y.post("/services/ssh/toggle",{action:s})).data.success&&(h.success(g("sshSettings.serviceToggleSuccess",{action:s})),await k())}catch(s){r.value.active=!r.value.active,h.error(s.response?.data?.error||s.message)}finally{f.value=!1}},D=async()=>{try{I.value=!0,(await y.post("/services/ssh/config",{config:d.value})).data.success&&(h.success(g("sshSettings.settingsSaved")),await k())}catch(s){h.error(s.response?.data?.error||s.message)}finally{I.value=!1}},Y=()=>{d.value={...O},h.info(g("sshSettings.settingsReset"))};let B=null;return as(()=>{k(),G(),U(),B=setInterval(()=>{T.value==="connections"&&r.value.active&&U()},3e4)}),ls(()=>{B&&clearInterval(B)}),(s,n)=>{const L=v("el-icon"),p=v("el-tag"),S=v("el-switch"),m=v("el-button"),Z=v("el-button-group"),z=v("el-card"),N=v("el-input-number"),x=v("el-input"),E=v("el-tab-pane"),ss=v("el-tooltip"),ts=v("el-tabs"),F=v("el-form-item"),es=v("el-form"),os=v("el-dialog");return b(),$("div",hs,[t("div",gs,[e(z,{shadow:"hover",class:"service-card"},{default:a(()=>[t("div",ps,[t("div",ms,[e(L,{size:"42",class:"service-icon"},{default:a(()=>[e(l(c),{icon:"mdi:console-network"})]),_:1}),t("div",_s,[e(p,{type:r.value.active?"success":"danger",size:"small",class:"status-tag"},{default:a(()=>[e(l(c),{icon:r.value.active?"mdi:play-circle":"mdi:stop-circle",width:"12"},null,8,["icon"]),u(" "+o(r.value.active?s.$t("sshSettings.running"):s.$t("sshSettings.stopped")),1)]),_:1},8,["type"])])]),t("div",fs,[t("h2",Ss,o(s.$t("sshSettings.title")),1),t("div",bs,[r.value.version?(b(),$("span",ws,[e(l(c),{icon:"mdi:tag",width:"12"}),u(" v"+o(r.value.version),1)])):K("",!0),t("span",$s,[e(l(c),{icon:"mdi:network-port",width:"12"}),u(" "+o(s.$t("sshSettings.port"))+": "+o(d.value.port||22),1)]),t("span",ys,[e(l(c),{icon:"mdi:update",width:"12"}),u(" "+o(s.$t("common.update"))+": "+o(H.value),1)])])]),t("div",Vs,[t("div",ks,[t("label",Cs,o(s.$t("sshSettings.serviceState")),1),e(S,{modelValue:r.value.active,"onUpdate:modelValue":n[0]||(n[0]=i=>r.value.active=i),onChange:X,loading:f.value,"active-text":s.$t("sshSettings.enabled"),"inactive-text":s.$t("sshSettings.disabled"),"inline-prompt":"","active-color":"var(--el-color-success)","inactive-color":"var(--el-color-danger)"},null,8,["modelValue","loading","active-text","inactive-text"])]),e(Z,{class:"service-buttons"},{default:a(()=>[e(m,{onClick:k,loading:f.value,circle:"",class:"action-btn"},{default:a(()=>[e(l(c),{icon:"mdi:refresh",width:"14"})]),_:1},8,["loading"]),e(m,{onClick:M,circle:"",type:"primary",class:"action-btn"},{default:a(()=>[e(l(c),{icon:"mdi:cog",width:"14"})]),_:1})]),_:1})])])]),_:1})]),t("div",As,[e(ts,{modelValue:T.value,"onUpdate:modelValue":n[9]||(n[9]=i=>T.value=i),type:"border-card",class:"compact-tabs"},{default:a(()=>[e(E,{label:s.$t("sshSettings.basicSettings"),name:"basic"},{default:a(()=>[t("div",Us,[e(z,{shadow:"hover",class:"compact-card"},{default:a(()=>[t("div",Ls,[t("div",zs,[t("div",Ts,[e(l(c),{icon:"mdi:connection",width:"16"}),t("h4",null,o(s.$t("sshSettings.connectionSettings")),1)]),t("div",Is,[t("label",Rs,o(s.$t("sshSettings.port")),1),e(N,{modelValue:d.value.port,"onUpdate:modelValue":n[1]||(n[1]=i=>d.value.port=i),min:1,max:65535,"controls-position":"right",class:"compact-input"},null,8,["modelValue"]),t("div",Os,o(s.$t("sshSettings.portHint")),1)])]),t("div",Bs,[t("div",Ns,[e(l(c),{icon:"mdi:lock",width:"16"}),t("h4",null,o(s.$t("sshSettings.authentication")),1)]),t("div",Es,[t("label",Hs,o(s.$t("sshSettings.passwordAuth")),1),t("div",Ds,[e(S,{modelValue:d.value.passwordAuthentication,"onUpdate:modelValue":n[2]||(n[2]=i=>d.value.passwordAuthentication=i),"inline-prompt":"","active-text":s.$t("sshSettings.enabled"),"inactive-text":s.$t("sshSettings.disabled"),"active-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),t("div",Fs,o(s.$t("sshSettings.passwordAuthHint")),1)]),t("div",Ks,[t("label",qs,o(s.$t("sshSettings.publicKeyAuth")),1),t("div",Ps,[e(S,{modelValue:d.value.publicKeyAuthentication,"onUpdate:modelValue":n[3]||(n[3]=i=>d.value.publicKeyAuthentication=i),"inline-prompt":"","active-text":s.$t("sshSettings.enabled"),"inactive-text":s.$t("sshSettings.disabled"),"active-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),t("div",js,o(s.$t("sshSettings.publicKeyAuthHint")),1)]),t("div",Ms,[t("label",Qs,o(s.$t("sshSettings.rootLogin")),1),t("div",Js,[e(S,{modelValue:d.value.allowRootLogin,"onUpdate:modelValue":n[4]||(n[4]=i=>d.value.allowRootLogin=i),"inline-prompt":"","active-text":s.$t("sshSettings.yes"),"inactive-text":s.$t("sshSettings.no"),"active-color":"var(--el-color-danger)","inactive-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),t("div",Ws,[e(l(c),{icon:"mdi:alert-circle",width:"12"}),u(" "+o(s.$t("sshSettings.rootLoginHint")),1)])])]),t("div",Gs,[t("div",Xs,[e(l(c),{icon:"mdi:tune-variant",width:"16"}),t("h4",null,o(s.$t("sshSettings.advancedSettings")),1)]),t("div",Ys,[t("label",Zs,o(s.$t("sshSettings.tcpForwarding")),1),t("div",xs,[e(S,{modelValue:d.value.tcpForwarding,"onUpdate:modelValue":n[5]||(n[5]=i=>d.value.tcpForwarding=i),"inline-prompt":"","active-text":s.$t("sshSettings.enabled"),"inactive-text":s.$t("sshSettings.disabled"),"active-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),t("div",st,o(s.$t("sshSettings.tcpForwardingHint")),1)]),t("div",tt,[t("label",et,o(s.$t("sshSettings.compression")),1),t("div",ot,[e(S,{modelValue:d.value.compression,"onUpdate:modelValue":n[6]||(n[6]=i=>d.value.compression=i),"inline-prompt":"","active-text":s.$t("sshSettings.enabled"),"inactive-text":s.$t("sshSettings.disabled"),"active-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),t("div",nt,o(s.$t("sshSettings.compressionHint")),1)]),t("div",it,[t("label",at,o(s.$t("sshSettings.maxSessions")),1),e(N,{modelValue:d.value.maxSessions,"onUpdate:modelValue":n[7]||(n[7]=i=>d.value.maxSessions=i),min:1,max:100,"controls-position":"right",class:"compact-input"},null,8,["modelValue"]),t("div",lt,o(s.$t("sshSettings.maxSessionsHint")),1)])])]),t("div",ct,[t("div",dt,[e(l(c),{icon:"mdi:code-braces",width:"16"}),t("h4",null,o(s.$t("sshSettings.additionalOptions")),1)]),e(x,{modelValue:d.value.additionalOptions,"onUpdate:modelValue":n[8]||(n[8]=i=>d.value.additionalOptions=i),type:"textarea",rows:4,placeholder:s.$t("sshSettings.additionalOptionsPlaceholder"),class:"advanced-textarea",resize:"none"},null,8,["modelValue","placeholder"])]),t("div",rt,[e(m,{type:"primary",onClick:D,loading:I.value,size:"large",class:"save-btn"},{default:a(()=>[e(l(c),{icon:"mdi:content-save",width:"16"}),u(" "+o(s.$t("sshSettings.saveSettings")),1)]),_:1},8,["loading"]),e(m,{onClick:Y,size:"large",class:"reset-btn"},{default:a(()=>[e(l(c),{icon:"mdi:restore",width:"16"}),u(" "+o(s.$t("sshSettings.reset")),1)]),_:1})])]),_:1})])]),_:1},8,["label"]),e(E,{label:s.$t("sshSettings.serviceStatus"),name:"status"},{default:a(()=>[t("div",ut,[e(z,{shadow:"hover",class:"compact-card"},{default:a(()=>[t("div",vt,[t("div",ht,[t("div",gt,[e(l(c),{icon:"mdi:information-outline",width:"20",class:"status-icon"}),t("h4",null,o(s.$t("sshSettings.serviceDetails")),1)]),t("div",pt,[t("div",mt,[t("label",null,o(s.$t("sshSettings.status")),1),e(p,{type:r.value.active?"success":"danger",class:"status-value-tag"},{default:a(()=>[e(l(c),{icon:r.value.active?"mdi:check-circle":"mdi:close-circle",width:"12"},null,8,["icon"]),u(" "+o(r.value.active?s.$t("sshSettings.running"):s.$t("sshSettings.stopped")),1)]),_:1},8,["type"])]),t("div",_t,[t("label",null,o(s.$t("sshSettings.version")),1),t("span",ft,o(r.value.version||"N/A"),1)]),t("div",St,[t("label",null,o(s.$t("sshSettings.installed")),1),e(p,{type:r.value.installed?"success":"warning",class:"status-value-tag"},{default:a(()=>[u(o(r.value.installed?s.$t("sshSettings.yes"):s.$t("sshSettings.no")),1)]),_:1},8,["type"])]),t("div",bt,[t("label",null,o(s.$t("sshSettings.configPath")),1),n[14]||(n[14]=t("span",{class:"status-value"},"/etc/ssh/sshd_config",-1))]),t("div",wt,[t("label",null,o(s.$t("sshSettings.servicePath")),1),n[15]||(n[15]=t("span",{class:"status-value"},"/usr/sbin/sshd",-1))])])]),t("div",$t,[t("div",yt,[e(l(c),{icon:"mdi:clipboard-text-outline",width:"20",class:"status-icon"}),t("h4",null,o(s.$t("sshSettings.statusOutput")),1)]),t("div",Vt,[t("pre",kt,o(r.value.details||s.$t("sshSettings.noStatusData")),1)]),t("div",Ct,[e(m,{onClick:j,size:"small",class:"log-action-btn"},{default:a(()=>[e(l(c),{icon:"mdi:content-copy",width:"12"}),u(" "+o(s.$t("sshSettings.copy")),1)]),_:1}),e(m,{onClick:k,loading:f.value,size:"small",class:"log-action-btn"},{default:a(()=>[e(l(c),{icon:"mdi:refresh",width:"12"}),u(" "+o(s.$t("sshSettings.refresh")),1)]),_:1},8,["loading"])])])])]),_:1})])]),_:1},8,["label"]),e(E,{label:s.$t("sshSettings.activeConnections"),name:"connections"},{default:a(()=>[t("div",At,[e(z,{shadow:"hover",class:"compact-card"},{default:a(()=>[t("div",Ut,[t("div",Lt,[t("h4",null,o(s.$t("sshSettings.currentConnections")),1),w.value.length>0?(b(),cs(p,{key:0,type:"info",size:"small",class:"connections-count"},{default:a(()=>[u(o(w.value.length)+" "+o(s.$t("sshSettings.connections")),1)]),_:1})):K("",!0)]),t("div",zt,[e(m,{onClick:U,loading:R.value,size:"small",class:"connection-action-btn"},{default:a(()=>[e(l(c),{icon:"mdi:refresh",width:"12"}),u(" "+o(s.$t("sshSettings.refresh")),1)]),_:1},8,["loading"]),e(m,{onClick:J,size:"small",class:"connection-action-btn"},{default:a(()=>[e(l(c),{icon:"mdi:download",width:"12"}),u(" "+o(s.$t("sshSettings.export")),1)]),_:1})])]),w.value.length===0?(b(),$("div",Tt,[e(l(c),{icon:"mdi:connection-off",size:"48"}),t("p",null,o(s.$t("sshSettings.noConnections")),1)])):(b(),$("div",It,[(b(!0),$(ds,null,rs(w.value,i=>(b(),$("div",{key:i.pid,class:us(["connection-card",{"connection-card-system":i.user==="root"}])},[t("div",Rt,[t("div",Ot,[e(l(c),{icon:"mdi:account-network",width:"20"})]),t("div",Bt,[t("span",Nt,o(i.user||"unknown"),1),e(p,{type:P(i.state),size:"small",class:"conn-state"},{default:a(()=>[u(o(i.state||"ESTABLISHED"),1)]),_:2},1032,["type"])]),t("div",Et,"PID: "+o(i.pid),1)]),t("div",Ht,[t("div",Dt,[t("div",Ft,[t("label",null,o(s.$t("sshSettings.localAddress")),1),t("span",Kt,o(i.local||"N/A"),1)]),t("div",qt,[t("label",null,o(s.$t("sshSettings.remoteAddress")),1),t("span",Pt,o(i.remote||"N/A"),1)])]),t("div",jt,[t("div",Mt,[e(l(c),{icon:"mdi:clock-outline",width:"12"}),t("span",null,o(i.duration||"N/A"),1)]),t("div",Qt,[e(l(c),{icon:"mdi:memory",width:"12"}),t("span",null,o(i.memory||"N/A"),1)])])]),t("div",Jt,[e(ss,{content:s.$t("sshSettings.killConnection"),placement:"top"},{default:a(()=>[e(m,{onClick:Xt=>W(i.pid),size:"small",type:"danger",circle:"",plain:"",class:"kill-btn"},{default:a(()=>[e(l(c),{icon:"mdi:close",width:"14"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])])],2))),128))]))]),_:1})])]),_:1},8,["label"])]),_:1},8,["modelValue"])]),e(os,{modelValue:V.value,"onUpdate:modelValue":n[13]||(n[13]=i=>V.value=i),title:s.$t("sshSettings.quickConfig"),width:"400px",class:"quick-config-modal"},{footer:a(()=>[e(m,{onClick:n[12]||(n[12]=i=>V.value=!1),class:"dialog-btn"},{default:a(()=>[u(o(s.$t("sshSettings.cancel")),1)]),_:1}),e(m,{type:"primary",onClick:Q,class:"dialog-btn"},{default:a(()=>[u(o(s.$t("sshSettings.apply")),1)]),_:1})]),default:a(()=>[e(es,{"label-position":"top",class:"quick-form"},{default:a(()=>[e(F,{label:s.$t("sshSettings.changePort")},{default:a(()=>[e(N,{modelValue:C.value,"onUpdate:modelValue":n[10]||(n[10]=i=>C.value=i),min:1,max:65535,"controls-position":"right",class:"compact-input"},null,8,["modelValue"])]),_:1},8,["label"]),e(F,{label:s.$t("sshSettings.enableRoot")},{default:a(()=>[e(S,{modelValue:A.value,"onUpdate:modelValue":n[11]||(n[11]=i=>A.value=i),"inline-prompt":"","active-text":s.$t("sshSettings.yes"),"inactive-text":s.$t("sshSettings.no"),"active-color":"var(--el-color-danger)","inactive-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue","title"])])}}},Zt=ns(Wt,[["__scopeId","data-v-c90b5042"]]);export{Zt as default};
