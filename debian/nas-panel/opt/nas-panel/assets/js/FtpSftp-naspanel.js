import{_ as Ke,u as We,a as je,r as _,D as Je,o as Qe,H as Xe,b as g,d as T,e as v,f,h as C,i as S,g as t,w as s,k as r,I as i,t as n,m as p,v as b,E as m,x as O,C as Z}from"./index-naspanel.js";const Ye={class:"ftp-sftp-container"},Ze={class:"service-cards"},xe={class:"card-header"},et={key:0,class:"loading-spinner"},tt={key:1},st={key:0,class:"install-mini-prompt"},at={key:1,class:"status-content"},lt={class:"action-buttons"},ot={class:"card-header"},nt={key:0,class:"loading-spinner"},rt={key:1},it={key:0,class:"install-mini-prompt"},pt={key:1,class:"status-content"},ft={class:"action-buttons"},dt={class:"config-section"},ut={class:"form-hint"},ct={class:"form-hint"},mt={class:"passive-ports"},_t={class:"form-hint"},vt={class:"form-hint"},gt={class:"form-hint"},yt={class:"unit"},bt={class:"form-hint"},ht={class:"form-hint"},wt={class:"form-hint"},$t={class:"card-header"},kt={class:"users-content"},Vt={class:"add-user"},Ct={class:"card-header"},Pt={class:"shares-content"},Ut={class:"add-share"},Tt={class:"config-section"},St={class:"card-header"},Ft={class:"connections-content"},Dt={key:1,class:"config-actions"},Bt={class:"install-content"},Et={class:"install-options"},zt={class:"custom-tree-node"},It={style:{"margin-left":"6px"}},Nt={__name:"FtpSftp",setup(Lt){const{t:o}=We(),$e=je(),L=_(!0),F=_(!1),re=_(!1),ie=_(!1),A=_(!1),G=_("ftp"),me=_("ftp"),z=_(!1),I=_(""),x=_([]),R=_(null),ke={label:"name",children:"children",isLeaf:"isLeaf"},w=_({installed:!1,running:!1}),h=_({installed:!1,running:!1}),d=_({port:21,anonymousLogin:!1,passivePorts:{min:49152,max:65534},maxClients:50,maxClientsPerIP:5,timeout:300,sslEnabled:!1,sslCertPath:"",ftpUser:"ftpuser",ftpGroup:"nogroup",additionalOptions:[]}),_e=_([]),ve=_([]),pe=_([]),fe=_([]),K=_(!1),W=_(!1),j=_(!1),D=_({path:"",options:{allowOverwrite:!1,allowResume:!1}}),V=_({username:"",password:"",homeDirectory:""}),$=_({username:"",newPassword:"",confirmPassword:""});let N=null;const Ve=e=>e.includes("ESTAB")?"success":e.includes("TIME_WAIT")?"warning":"info",Ce=e=>{R.value=e.path},Pe=()=>{$e.push("/services/ssh")},Ue=()=>{R.value?(I.value===o("ftp_sftp.select_share_directory")?D.value.path=R.value:I.value===o("ftp_sftp.select_home_directory")?V.value.homeDirectory=R.value:I.value===o("ftp_sftp.select_certificate_directory")&&(d.value.sslCertPath=R.value),z.value=!1,O.success(o("ftp_sftp.directory_selected"))):O.warning(o("ftp_sftp.no_directory_selected"))},Te=async()=>{try{const e=await b.post("/api/filesystems/browse-directory",{path:D.value.path||"/"});x.value=e.data.directories,I.value=o("ftp_sftp.select_share_directory"),z.value=!0}catch(e){O.error("Failed to browse directory"),console.error("Browse error:",e)}},Se=async()=>{try{const e=await b.post("/api/filesystems/browse-directory",{path:V.value.homeDirectory||"/home"});x.value=e.data.directories,I.value=o("ftp_sftp.select_home_directory"),z.value=!0}catch(e){O.error("Failed to browse directory"),console.error("Browse error:",e)}},Fe=async()=>{try{const e=await b.post("/api/filesystems/browse-directory",{path:d.value.sslCertPath||"/etc/ssl/certs"});x.value=e.data.directories,I.value=o("ftp_sftp.select_certificate_directory"),z.value=!0}catch(e){O.error("Failed to browse directory"),console.error("Browse error:",e)}},De=async(e,a)=>{try{const c=e?.data?.path||"/",u=(await b.post("/api/filesystems/browse-directory",{path:c})).data.directories.map(P=>({...P,children:[]}));a(u)}catch(c){console.error("Error loading directories:",c),a([])}},M=async(e,a)=>{try{F.value=!0;const c=await b.post("/api/services/ftp-sftp/toggle",{action:a,service:e});c.data.success&&(await J(),m.success({title:o("ftp_sftp.success"),message:c.data.message}))}catch(c){m.error({title:o("ftp_sftp.error"),message:c.response?.data?.error||o("ftp_sftp.service_toggle_error")})}finally{F.value=!1}},ee=async e=>{try{A.value=!0;const a=await b.post("/api/services/ftp-sftp/install",{service:e});a.data.success&&(await J(),m.success({title:o("ftp_sftp.success"),message:a.data.message}))}catch(a){m.error({title:o("ftp_sftp.error"),message:a.response?.data?.error||o("ftp_sftp.install_error")})}finally{A.value=!1}},Be=async()=>{try{re.value=!0;const e=await b.post("/api/services/ftp-sftp/config",{config:d.value});e.data.success&&(m.success({title:o("ftp_sftp.success"),message:e.data.message}),await te(),await se(),await J())}catch(e){let a=e.response?.data?.error||o("ftp_sftp.config_save_error");m.error({title:o("ftp_sftp.error"),message:a,duration:5e3})}finally{re.value=!1}},Ee=async()=>{try{ie.value=!0,await de(),m.success({title:o("ftp_sftp.success"),message:o("ftp_sftp.config_reset")})}catch{m.error({title:o("ftp_sftp.error"),message:o("ftp_sftp.config_reset_error")})}finally{ie.value=!1}},ze=async()=>{try{await Z.confirm("This will reset FTP configuration to default. Continue?","Repair Configuration",{confirmButtonText:"Repair",cancelButtonText:"Cancel",type:"warning"});const e=await b.post("/api/services/ftp-sftp/repair-config");e.data.success&&(m.success({title:o("ftp_sftp.success"),message:e.data.message}),await J(),await de())}catch(e){e!=="cancel"&&m.error({title:o("ftp_sftp.error"),message:e.response?.data?.error||"Failed to repair configuration"})}},Ie=async()=>{try{const e=await b.get("/api/services/ftp-sftp/test-config");e.data.success&&(m.info({title:"Config Test",message:e.data.configValid?"Configuration is valid":"Configuration has errors",duration:5e3}),Z.alert(`<pre style="background: #f5f5f5; padding: 10px; border-radius: 4px; overflow: auto; max-height: 400px;">${e.data.output||e.data.error}</pre>`,"Configuration Test Output",{dangerouslyUseHTMLString:!0,confirmButtonText:"OK"}))}catch{m.error({title:o("ftp_sftp.error"),message:"Failed to test configuration"})}},J=async()=>{try{L.value=!0;const e=await b.get("/api/services/ftp-sftp/status");w.value=e.data.ftp,h.value=e.data.sftp}catch{m.error({title:o("ftp_sftp.error"),message:o("ftp_sftp.status_fetch_error")})}finally{L.value=!1}},de=async()=>{try{L.value=!0;const e=await b.get("/api/services/ftp-sftp/config");e.data.success&&(d.value={...d.value,...e.data.config}),await te(),await se()}catch{m.error({title:o("ftp_sftp.error"),message:o("ftp_sftp.config_fetch_error")})}finally{L.value=!1}},te=async()=>{try{const e=await b.get("/api/services/ftp-sftp/shares");e.data.success&&(_e.value=e.data.shares)}catch(e){console.error("Error fetching FTP shares:",e)}},se=async()=>{try{const e=await b.get("/api/services/ftp-sftp/users");e.data.success&&(ve.value=e.data.users)}catch(e){console.error("Error fetching FTP users:",e)}},ue=async()=>{try{if(pe.value=[],fe.value=[],w.value.installed&&w.value.running){const e=await b.get("/api/services/ftp-sftp/connections");e.data.success&&(pe.value=e.data.connections)}if(h.value.installed&&h.value.running)try{const e=await b.get("/services/ssh/connections");e.data.success&&(fe.value=e.data.connections)}catch(e){console.error("Error fetching SFTP connections:",e)}}catch(e){console.error("Error fetching connections:",e)}},Ne=()=>{D.value={path:"",options:{allowOverwrite:!1,allowResume:!1}},K.value=!0},Le=()=>{V.value={username:"",password:"",homeDirectory:""},W.value=!0},Ae=e=>{$.value={username:e,newPassword:"",confirmPassword:""},j.value=!0},Re=async e=>{try{await Z.confirm(o("ftp_sftp.confirm_delete_share",{path:e.path}),o("ftp_sftp.warning"),{confirmButtonText:o("ftp_sftp.confirm"),cancelButtonText:o("ftp_sftp.cancel"),type:"warning"});const a=await b.post("/api/services/ftp-sftp/shares",{action:"remove",share:e});a.data.success&&(m.success({title:o("ftp_sftp.success"),message:a.data.message}),await te())}catch(a){a!=="cancel"&&m.error({title:o("ftp_sftp.error"),message:a.response?.data?.error||o("ftp_sftp.share_delete_error")})}},Me=async()=>{try{const e=await b.post("/api/services/ftp-sftp/shares",{action:"add",share:D.value});e.data.success&&(m.success({title:o("ftp_sftp.success"),message:e.data.message}),K.value=!1,await te())}catch(e){m.error({title:o("ftp_sftp.error"),message:e.response?.data?.error||o("ftp_sftp.share_save_error")})}},qe=async()=>{try{const e=await b.post("/api/services/ftp-sftp/users",V.value);e.data.success&&(m.success({title:o("ftp_sftp.success"),message:e.data.message}),W.value=!1,await se())}catch(e){m.error({title:o("ftp_sftp.error"),message:e.response?.data?.error||o("ftp_sftp.user_add_error")})}},He=async()=>{try{if($.value.newPassword!==$.value.confirmPassword){O.error(o("ftp_sftp.passwords_do_not_match"));return}const e=await b.post(`/api/services/ftp-sftp/users/${$.value.username}/change-password`,{password:$.value.newPassword});e.data.success&&(m.success({title:o("ftp_sftp.success"),message:e.data.message}),j.value=!1)}catch(e){m.error({title:o("ftp_sftp.error"),message:e.response?.data?.error||o("ftp_sftp.password_change_error")})}},Oe=async e=>{try{await Z.confirm(o("ftp_sftp.confirm_delete_user",{username:e}),o("ftp_sftp.warning"),{confirmButtonText:o("ftp_sftp.confirm"),cancelButtonText:o("ftp_sftp.cancel"),type:"warning"});const a=await b.delete(`/api/services/ftp-sftp/users/${e}`);a.data.success&&(m.success({title:o("ftp_sftp.success"),message:a.data.message}),await se())}catch(a){a!=="cancel"&&m.error({title:o("ftp_sftp.error"),message:a.response?.data?.error||o("ftp_sftp.user_delete_error")})}},ge=async(e,a)=>{try{await Z.confirm(o("ftp_sftp.confirm_kill_connection",{pid:e}),o("ftp_sftp.warning"),{confirmButtonText:o("ftp_sftp.confirm"),cancelButtonText:o("ftp_sftp.cancel"),type:"warning"}),(await b.post("/api/services/ftp-sftp/kill-connection",{pid:e,service:a})).data.success&&(m.success({title:o("ftp_sftp.success"),message:o("ftp_sftp.connection_killed")}),await ue())}catch(c){c!=="cancel"&&m.error({title:o("ftp_sftp.error"),message:c.response?.data?.error||o("ftp_sftp.connection_kill_error")})}};return Je([w,h],([e,a])=>{e.installed?G.value="ftp":a.installed&&(G.value="sftp"),e.installed||a.installed?N||(ue(),N=setInterval(ue,1e4)):N&&(clearInterval(N),N=null)},{deep:!0}),Qe(()=>{J().then(()=>{w.value.installed&&de()})}),Xe(()=>{N&&clearInterval(N)}),(e,a)=>{const c=g("el-tag"),ce=g("el-icon"),u=g("el-button"),P=g("el-descriptions-item"),ye=g("el-descriptions"),B=g("el-card"),q=g("el-input-number"),y=g("el-form-item"),E=g("el-col"),be=g("el-switch"),ae=g("el-row"),U=g("el-input"),Q=g("el-form"),k=g("el-table-column"),X=g("el-tooltip"),he=g("el-button-group"),le=g("el-table"),oe=g("el-alert"),Y=g("el-tab-pane"),we=g("el-tabs"),ne=g("el-dialog"),Ge=g("el-tree");return v(),T("div",Ye,[f("div",Ze,[t(B,{shadow:"hover",class:"status-card"},{header:s(()=>[f("div",xe,[t(r(i),{icon:"carbon:ftp",width:"24",height:"24"}),f("span",null,n(e.$t("ftp_sftp.ftp_service")),1),w.value.installed?S("",!0):(v(),C(c,{key:0,size:"small",type:"warning",class:"install-tag"},{default:s(()=>[t(r(i),{icon:"material-symbols:download"}),p(" "+n(e.$t("ftp_sftp.not_installed")),1)]),_:1}))])]),default:s(()=>[L.value?(v(),T("div",et,[t(ce,{size:32,class:"is-loading"},{default:s(()=>[t(r(i),{icon:"svg-spinners:180-ring"})]),_:1})])):(v(),T("div",tt,[w.value.installed?(v(),T("div",at,[t(ye,{column:1,border:""},{default:s(()=>[t(P,{label:e.$t("ftp_sftp.status")},{default:s(()=>[t(c,{type:w.value.running?"success":"danger"},{default:s(()=>[t(r(i),{icon:w.value.running?"material-symbols:check-circle-outline":"material-symbols:error-outline"},null,8,["icon"]),p(" "+n(w.value.running?e.$t("ftp_sftp.running"):e.$t("ftp_sftp.stopped")),1)]),_:1},8,["type"])]),_:1},8,["label"]),t(P,{label:e.$t("ftp_sftp.port")},{default:s(()=>[t(c,null,{default:s(()=>[p(n(d.value.port||21),1)]),_:1})]),_:1},8,["label"]),t(P,{label:e.$t("ftp_sftp.anonymous_login")},{default:s(()=>[t(c,{type:d.value.anonymousLogin?"warning":"success"},{default:s(()=>[t(r(i),{icon:d.value.anonymousLogin?"mdi:account-eye":"mdi:account-lock"},null,8,["icon"]),p(" "+n(d.value.anonymousLogin?e.$t("ftp_sftp.enabled"):e.$t("ftp_sftp.disabled")),1)]),_:1},8,["type"])]),_:1},8,["label"]),t(P,{label:e.$t("ftp_sftp.ftp_user")},{default:s(()=>[t(c,null,{default:s(()=>[p(n(d.value.ftpUser||"ftpuser"),1)]),_:1})]),_:1},8,["label"]),t(P,{label:e.$t("ftp_sftp.ftp_group")},{default:s(()=>[t(c,null,{default:s(()=>[p(n(d.value.ftpGroup||"nogroup"),1)]),_:1})]),_:1},8,["label"])]),_:1}),f("div",lt,[w.value.running?(v(),C(u,{key:1,type:"danger",onClick:a[2]||(a[2]=l=>M("ftp","stop")),loading:F.value,plain:"",round:""},{icon:s(()=>[t(r(i),{icon:"material-symbols:stop"})]),default:s(()=>[p(" "+n(e.$t("ftp_sftp.stop_service")),1)]),_:1},8,["loading"])):(v(),C(u,{key:0,type:"success",onClick:a[1]||(a[1]=l=>M("ftp","start")),loading:F.value,plain:"",round:""},{icon:s(()=>[t(r(i),{icon:"material-symbols:play-arrow"})]),default:s(()=>[p(" "+n(e.$t("ftp_sftp.start_service")),1)]),_:1},8,["loading"])),t(u,{type:"warning",onClick:a[3]||(a[3]=l=>M("ftp","restart")),loading:F.value,plain:"",round:""},{icon:s(()=>[t(r(i),{icon:"material-symbols:restart-alt"})]),default:s(()=>[p(" "+n(e.$t("ftp_sftp.restart_service")),1)]),_:1},8,["loading"])])])):(v(),T("div",st,[f("p",null,n(e.$t("ftp_sftp.ftp_install_prompt")),1),t(u,{type:"primary",size:"small",onClick:a[0]||(a[0]=l=>ee("ftp")),loading:A.value,plain:""},{default:s(()=>[t(r(i),{icon:"material-symbols:download"}),p(" "+n(e.$t("ftp_sftp.install_ftp")),1)]),_:1},8,["loading"])]))]))]),_:1}),t(B,{shadow:"hover",class:"status-card"},{header:s(()=>[f("div",ot,[t(r(i),{icon:"material-symbols:lock",width:"24",height:"24"}),f("span",null,n(e.$t("ftp_sftp.sftp_service")),1),h.value.installed?S("",!0):(v(),C(c,{key:0,size:"small",type:"warning",class:"install-tag"},{default:s(()=>[t(r(i),{icon:"material-symbols:download"}),p(" "+n(e.$t("ftp_sftp.not_installed")),1)]),_:1}))])]),default:s(()=>[L.value?(v(),T("div",nt,[t(ce,{size:32,class:"is-loading"},{default:s(()=>[t(r(i),{icon:"svg-spinners:180-ring"})]),_:1})])):(v(),T("div",rt,[h.value.installed?(v(),T("div",pt,[t(ye,{column:1,border:""},{default:s(()=>[t(P,{label:e.$t("ftp_sftp.status")},{default:s(()=>[t(c,{type:h.value.running?"success":"danger"},{default:s(()=>[t(r(i),{icon:h.value.running?"material-symbols:check-circle-outline":"material-symbols:error-outline"},null,8,["icon"]),p(" "+n(h.value.running?e.$t("ftp_sftp.running"):e.$t("ftp_sftp.stopped")),1)]),_:1},8,["type"])]),_:1},8,["label"]),t(P,{label:e.$t("ftp_sftp.port")},{default:s(()=>[t(c,null,{default:s(()=>a[38]||(a[38]=[p("22 (SSH)")])),_:1,__:[38]})]),_:1},8,["label"]),t(P,{label:e.$t("ftp_sftp.protocol")},{default:s(()=>[t(c,{type:"info"},{default:s(()=>a[39]||(a[39]=[p("SFTP (SSH)")])),_:1,__:[39]})]),_:1},8,["label"])]),_:1}),f("div",ft,[h.value.running?(v(),C(u,{key:1,type:"danger",onClick:a[6]||(a[6]=l=>M("sftp","stop")),loading:F.value,plain:"",round:""},{icon:s(()=>[t(r(i),{icon:"material-symbols:stop"})]),default:s(()=>[p(" "+n(e.$t("ftp_sftp.stop_service")),1)]),_:1},8,["loading"])):(v(),C(u,{key:0,type:"success",onClick:a[5]||(a[5]=l=>M("sftp","start")),loading:F.value,plain:"",round:""},{icon:s(()=>[t(r(i),{icon:"material-symbols:play-arrow"})]),default:s(()=>[p(" "+n(e.$t("ftp_sftp.start_service")),1)]),_:1},8,["loading"])),t(u,{type:"warning",onClick:a[7]||(a[7]=l=>M("sftp","restart")),loading:F.value,plain:"",round:""},{icon:s(()=>[t(r(i),{icon:"material-symbols:restart-alt"})]),default:s(()=>[p(" "+n(e.$t("ftp_sftp.restart_service")),1)]),_:1},8,["loading"])])])):(v(),T("div",it,[f("p",null,n(e.$t("ftp_sftp.sftp_install_prompt")),1),t(u,{type:"success",size:"small",onClick:a[4]||(a[4]=l=>ee("sftp")),loading:A.value,plain:""},{default:s(()=>[t(r(i),{icon:"material-symbols:download"}),p(" "+n(e.$t("ftp_sftp.install_sftp")),1)]),_:1},8,["loading"])]))]))]),_:1})]),w.value.installed||h.value.installed?(v(),C(we,{key:0,modelValue:G.value,"onUpdate:modelValue":a[20]||(a[20]=l=>G.value=l),class:"config-tabs"},{default:s(()=>[w.value.installed?(v(),C(Y,{key:0,label:e.$t("ftp_sftp.ftp_config"),name:"ftp"},{default:s(()=>[t(B,{shadow:"hover",class:"config-card"},{default:s(()=>[f("div",dt,[t(Q,{"label-position":"top"},{default:s(()=>[t(ae,{gutter:20},{default:s(()=>[t(E,{span:12},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.port")},{default:s(()=>[t(q,{modelValue:d.value.port,"onUpdate:modelValue":a[8]||(a[8]=l=>d.value.port=l),min:1,max:65535,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(E,{span:12},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.anonymous_login")},{default:s(()=>[t(be,{modelValue:d.value.anonymousLogin,"onUpdate:modelValue":a[9]||(a[9]=l=>d.value.anonymousLogin=l),"active-text":e.$t("ftp_sftp.yes"),"inactive-text":e.$t("ftp_sftp.no"),"inline-prompt":"","active-color":"#13ce66"},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1})]),_:1}),t(ae,{gutter:20},{default:s(()=>[t(E,{span:12},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.ftp_user")},{default:s(()=>[t(U,{modelValue:d.value.ftpUser,"onUpdate:modelValue":a[10]||(a[10]=l=>d.value.ftpUser=l),placeholder:"ftpuser"},null,8,["modelValue"]),f("div",ut,n(e.$t("ftp_sftp.ftp_user_hint")),1)]),_:1},8,["label"])]),_:1}),t(E,{span:12},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.ftp_group")},{default:s(()=>[t(U,{modelValue:d.value.ftpGroup,"onUpdate:modelValue":a[11]||(a[11]=l=>d.value.ftpGroup=l),placeholder:"nogroup"},null,8,["modelValue"]),f("div",ct,n(e.$t("ftp_sftp.ftp_group_hint")),1)]),_:1},8,["label"])]),_:1})]),_:1}),t(y,{label:e.$t("ftp_sftp.passive_ports")},{default:s(()=>[f("div",mt,[t(q,{modelValue:d.value.passivePorts.min,"onUpdate:modelValue":a[12]||(a[12]=l=>d.value.passivePorts.min=l),min:1024,max:65534,"controls-position":"right"},null,8,["modelValue"]),a[40]||(a[40]=f("span",{class:"port-separator"},"-",-1)),t(q,{modelValue:d.value.passivePorts.max,"onUpdate:modelValue":a[13]||(a[13]=l=>d.value.passivePorts.max=l),min:d.value.passivePorts.min+1,max:65535,"controls-position":"right"},null,8,["modelValue","min"])]),f("div",_t,n(e.$t("ftp_sftp.passive_ports_hint")),1)]),_:1},8,["label"]),t(ae,{gutter:20},{default:s(()=>[t(E,{span:12},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.max_connections")},{default:s(()=>[t(q,{modelValue:d.value.maxClients,"onUpdate:modelValue":a[14]||(a[14]=l=>d.value.maxClients=l),min:1,max:1e3,"controls-position":"right"},null,8,["modelValue"]),f("div",vt,n(e.$t("ftp_sftp.max_connections_hint")),1)]),_:1},8,["label"])]),_:1}),t(E,{span:12},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.max_per_ip")},{default:s(()=>[t(q,{modelValue:d.value.maxClientsPerIP,"onUpdate:modelValue":a[15]||(a[15]=l=>d.value.maxClientsPerIP=l),min:1,max:100,"controls-position":"right"},null,8,["modelValue"]),f("div",gt,n(e.$t("ftp_sftp.max_per_ip_hint")),1)]),_:1},8,["label"])]),_:1})]),_:1}),t(ae,{gutter:20},{default:s(()=>[t(E,{span:12},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.timeout")},{default:s(()=>[t(q,{modelValue:d.value.timeout,"onUpdate:modelValue":a[16]||(a[16]=l=>d.value.timeout=l),min:30,max:3600,"controls-position":"right"},null,8,["modelValue"]),f("span",yt,n(e.$t("ftp_sftp.seconds")),1),f("div",bt,n(e.$t("ftp_sftp.timeout_hint")),1)]),_:1},8,["label"])]),_:1}),t(E,{span:12},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.ssl_tls")},{default:s(()=>[t(be,{modelValue:d.value.sslEnabled,"onUpdate:modelValue":a[17]||(a[17]=l=>d.value.sslEnabled=l),"active-text":e.$t("ftp_sftp.enabled"),"inactive-text":e.$t("ftp_sftp.disabled"),"inline-prompt":"","active-color":"#13ce66"},null,8,["modelValue","active-text","inactive-text"]),f("div",ht,n(e.$t("ftp_sftp.ssl_tls_hint")),1)]),_:1},8,["label"])]),_:1})]),_:1}),d.value.sslEnabled?(v(),C(y,{key:0,label:e.$t("ftp_sftp.ssl_cert_path")},{default:s(()=>[t(U,{modelValue:d.value.sslCertPath,"onUpdate:modelValue":a[18]||(a[18]=l=>d.value.sslCertPath=l),placeholder:"/etc/ssl/certs/proftpd.crt"},null,8,["modelValue"]),t(u,{type:"primary",plain:"",class:"browse-btn",onClick:Fe},{default:s(()=>[t(r(i),{icon:"material-symbols:folder-open"}),p(" "+n(e.$t("ftp_sftp.browse")),1)]),_:1}),f("div",wt,n(e.$t("ftp_sftp.ssl_cert_path_hint")),1)]),_:1},8,["label"])):S("",!0)]),_:1})])]),_:1}),t(B,{shadow:"hover",class:"users-card"},{header:s(()=>[f("div",$t,[t(r(i),{icon:"mdi:account-group"}),f("span",null,n(e.$t("ftp_sftp.ftp_users")),1)])]),default:s(()=>[f("div",kt,[t(le,{data:ve.value,style:{width:"100%"},"empty-text":"No FTP users"},{default:s(()=>[t(k,{prop:"username",label:e.$t("ftp_sftp.username")},null,8,["label"]),t(k,{prop:"uid",label:e.$t("ftp_sftp.user_id"),width:"120"},null,8,["label"]),t(k,{prop:"home",label:e.$t("ftp_sftp.home_directory")},null,8,["label"]),t(k,{label:e.$t("ftp_sftp.actions"),width:"150",align:"right"},{default:s(({row:l})=>[t(he,null,{default:s(()=>[t(X,{content:e.$t("ftp_sftp.change_password"),placement:"top"},{default:s(()=>[t(u,{size:"small",onClick:H=>Ae(l.username),circle:""},{default:s(()=>[t(r(i),{icon:"material-symbols:key"})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),t(X,{content:e.$t("ftp_sftp.delete_user"),placement:"top"},{default:s(()=>[t(u,{size:"small",type:"danger",onClick:H=>Oe(l.username),circle:""},{default:s(()=>[t(r(i),{icon:"material-symbols:delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),f("div",Vt,[t(u,{type:"primary",onClick:Le,plain:""},{default:s(()=>[t(r(i),{icon:"material-symbols:person-add"}),p(" "+n(e.$t("ftp_sftp.add_ftp_user")),1)]),_:1})])])]),_:1}),t(B,{shadow:"hover",class:"shares-card"},{header:s(()=>[f("div",Ct,[t(r(i),{icon:"mdi:folder-shared"}),f("span",null,n(e.$t("ftp_sftp.shared_folders")),1)])]),default:s(()=>[f("div",Pt,[t(oe,{title:"Note: Simple configuration mode",type:"info",closable:!1,"show-icon":"",class:"share-alert"},{default:s(()=>a[41]||(a[41]=[f("p",null,"Currently using simple configuration. All directories have full access.",-1)])),_:1}),t(le,{data:_e.value,style:{width:"100%"},"empty-text":"No shared folders"},{default:s(()=>[t(k,{prop:"path",label:e.$t("ftp_sftp.path")},null,8,["label"]),t(k,{label:e.$t("ftp_sftp.options"),width:"200"},{default:s(l=>[t(c,{size:"small",type:"info",class:"option-tag"},{default:s(()=>[t(r(i),{icon:"material-symbols:check"}),a[42]||(a[42]=p(" Full Access "))]),_:1,__:[42]})]),_:1},8,["label"]),t(k,{label:e.$t("ftp_sftp.actions"),width:"150",align:"right"},{default:s(l=>[t(he,null,{default:s(()=>[t(X,{content:e.$t("ftp_sftp.remove"),placement:"top"},{default:s(()=>[t(u,{size:"small",type:"danger",onClick:H=>Re(l.row),circle:""},{default:s(()=>[t(r(i),{icon:"material-symbols:delete"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"]),f("div",Ut,[t(u,{type:"primary",onClick:Ne,plain:""},{default:s(()=>[t(r(i),{icon:"material-symbols:add"}),p(" "+n(e.$t("ftp_sftp.add_share")),1)]),_:1})])])]),_:1})]),_:1},8,["label"])):S("",!0),h.value.installed?(v(),C(Y,{key:1,label:e.$t("ftp_sftp.sftp_config"),name:"sftp"},{default:s(()=>[t(B,{shadow:"hover",class:"config-card"},{default:s(()=>[f("div",Tt,[t(oe,{title:e.$t("ftp_sftp.sftp_note"),type:"info",closable:!1,"show-icon":""},null,8,["title"]),t(Q,{"label-position":"top",class:"sftp-form"},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.sftp_status")},{default:s(()=>[t(c,{type:h.value.running?"success":"danger"},{default:s(()=>[t(r(i),{icon:h.value.running?"material-symbols:check-circle-outline":"material-symbols:error-outline"},null,8,["icon"]),p(" "+n(h.value.running?e.$t("ftp_sftp.running"):e.$t("ftp_sftp.stopped")),1)]),_:1},8,["type"])]),_:1},8,["label"]),t(y,{label:e.$t("ftp_sftp.sftp_port")},{default:s(()=>[t(c,{type:"info"},{default:s(()=>[t(r(i),{icon:"mdi:network-port"}),p(" 22 ("+n(e.$t("ftp_sftp.same_as_ssh"))+") ",1)]),_:1})]),_:1},8,["label"]),t(y,{label:e.$t("ftp_sftp.sftp_users")},{default:s(()=>[t(oe,{title:e.$t("ftp_sftp.sftp_users_note"),type:"info",closable:!1,"show-icon":""},null,8,["title"])]),_:1},8,["label"]),t(y,null,{default:s(()=>[t(u,{type:"primary",onClick:Pe},{default:s(()=>[t(r(i),{icon:"material-symbols:settings"}),p(" "+n(e.$t("ftp_sftp.configure_ssh")),1)]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["label"])):S("",!0),t(Y,{label:e.$t("ftp_sftp.connections"),name:"connections"},{default:s(()=>[t(B,{shadow:"hover",class:"connections-card"},{header:s(()=>[f("div",St,[t(r(i),{icon:"material-symbols:network-node"}),f("span",null,n(e.$t("ftp_sftp.active_connections")),1)])]),default:s(()=>[f("div",Ft,[t(we,{modelValue:me.value,"onUpdate:modelValue":a[19]||(a[19]=l=>me.value=l)},{default:s(()=>[w.value.installed?(v(),C(Y,{key:0,label:e.$t("ftp_sftp.ftp_connections"),name:"ftp"},{default:s(()=>[t(le,{data:pe.value,style:{width:"100%"},"empty-text":"No active FTP connections"},{default:s(()=>[t(k,{prop:"user",label:e.$t("ftp_sftp.user")},{default:s(({row:l})=>[t(c,null,{default:s(()=>[t(r(i),{icon:"mdi:account"}),p(" "+n(l.user),1)]),_:2},1024)]),_:1},8,["label"]),t(k,{prop:"remote",label:e.$t("ftp_sftp.remote_address")},null,8,["label"]),t(k,{prop:"status",label:e.$t("ftp_sftp.status")},{default:s(({row:l})=>[t(c,{type:l.status==="established"?"success":"info"},{default:s(()=>[p(n(l.status),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(k,{prop:"pid",label:e.$t("ftp_sftp.pid"),width:"100"},null,8,["label"]),t(k,{label:e.$t("ftp_sftp.actions"),width:"100",align:"right"},{default:s(({row:l})=>[t(X,{content:e.$t("ftp_sftp.disconnect"),placement:"top"},{default:s(()=>[t(u,{size:"small",type:"danger",onClick:H=>ge(l.pid,"ftp"),circle:"",disabled:l.pid==="N/A"},{default:s(()=>[t(r(i),{icon:"material-symbols:close"})]),_:2},1032,["onClick","disabled"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["label"])):S("",!0),h.value.installed?(v(),C(Y,{key:1,label:e.$t("ftp_sftp.sftp_connections"),name:"sftp"},{default:s(()=>[t(le,{data:fe.value,style:{width:"100%"},"empty-text":"No active SFTP connections"},{default:s(()=>[t(k,{prop:"user",label:e.$t("ftp_sftp.user")},{default:s(({row:l})=>[t(c,null,{default:s(()=>[t(r(i),{icon:"mdi:account"}),p(" "+n(l.user||"unknown"),1)]),_:2},1024)]),_:1},8,["label"]),t(k,{prop:"remote",label:e.$t("ftp_sftp.remote")},null,8,["label"]),t(k,{prop:"state",label:e.$t("ftp_sftp.state")},{default:s(({row:l})=>[t(c,{type:Ve(l.state)},{default:s(()=>[p(n(l.state),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(k,{label:e.$t("ftp_sftp.actions"),width:"100",align:"right"},{default:s(({row:l})=>[t(X,{content:e.$t("ftp_sftp.disconnect"),placement:"top"},{default:s(()=>[t(u,{size:"small",type:"danger",onClick:H=>ge(l.pid,"sftp"),circle:"",disabled:!l.pid||l.pid==="N/A"},{default:s(()=>[t(r(i),{icon:"material-symbols:close"})]),_:2},1032,["onClick","disabled"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["label"])):S("",!0)]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])):S("",!0),w.value.installed&&G.value==="ftp"?(v(),T("div",Dt,[t(u,{type:"primary",onClick:Be,loading:re.value,round:""},{default:s(()=>[t(r(i),{icon:"material-symbols:save"}),p(" "+n(e.$t("ftp_sftp.save_config")),1)]),_:1},8,["loading"]),t(u,{onClick:Ee,loading:ie.value,round:""},{default:s(()=>[t(r(i),{icon:"material-symbols:restart-alt"}),p(" "+n(e.$t("ftp_sftp.reset")),1)]),_:1},8,["loading"]),t(u,{type:"info",onClick:Ie,round:""},{default:s(()=>[t(r(i),{icon:"material-symbols:bug-report"}),a[43]||(a[43]=p(" Test Config "))]),_:1,__:[43]}),t(u,{type:"warning",onClick:ze,round:""},{default:s(()=>[t(r(i),{icon:"material-symbols:handyman"}),a[44]||(a[44]=p(" Repair Config "))]),_:1,__:[44]})])):S("",!0),!w.value.installed&&!h.value.installed?(v(),C(B,{key:2,shadow:"hover",class:"install-prompt"},{default:s(()=>[f("div",Bt,[t(r(i),{icon:"material-symbols:warning",width:"48",height:"48",class:"warning-icon"}),f("h3",null,n(e.$t("ftp_sftp.no_services_installed")),1),f("p",null,n(e.$t("ftp_sftp.install_prompt")),1),f("div",Et,[t(u,{type:"primary",onClick:a[21]||(a[21]=l=>ee("ftp")),loading:A.value},{default:s(()=>[t(r(i),{icon:"carbon:ftp"}),p(" "+n(e.$t("ftp_sftp.install_ftp")),1)]),_:1},8,["loading"]),t(u,{type:"success",onClick:a[22]||(a[22]=l=>ee("sftp")),loading:A.value},{default:s(()=>[t(r(i),{icon:"material-symbols:lock"}),p(" "+n(e.$t("ftp_sftp.install_sftp")),1)]),_:1},8,["loading"])])])]),_:1})):S("",!0),t(ne,{modelValue:K.value,"onUpdate:modelValue":a[25]||(a[25]=l=>K.value=l),title:e.$t("ftp_sftp.add_share"),width:"50%"},{footer:s(()=>[t(u,{onClick:a[24]||(a[24]=l=>K.value=!1)},{default:s(()=>[t(r(i),{icon:"material-symbols:cancel"}),p(" "+n(e.$t("ftp_sftp.cancel")),1)]),_:1}),t(u,{type:"primary",onClick:Me,disabled:!D.value.path},{default:s(()=>[t(r(i),{icon:"material-symbols:check"}),p(" "+n(e.$t("ftp_sftp.confirm")),1)]),_:1},8,["disabled"])]),default:s(()=>[t(oe,{title:"Simple Share Configuration",type:"info",closable:!1,"show-icon":"",class:"dialog-alert"},{default:s(()=>a[45]||(a[45]=[f("p",null,"All directories added will have full access permissions.",-1)])),_:1}),t(Q,{model:D.value,"label-position":"top"},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.path"),required:""},{default:s(()=>[t(U,{modelValue:D.value.path,"onUpdate:modelValue":a[23]||(a[23]=l=>D.value.path=l)},{append:s(()=>[t(u,{onClick:Te},{icon:s(()=>[t(r(i),{icon:"material-symbols:folder-open"})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(ne,{modelValue:W.value,"onUpdate:modelValue":a[30]||(a[30]=l=>W.value=l),title:e.$t("ftp_sftp.add_ftp_user"),width:"50%"},{footer:s(()=>[t(u,{onClick:a[29]||(a[29]=l=>W.value=!1)},{default:s(()=>[p(n(e.$t("ftp_sftp.cancel")),1)]),_:1}),t(u,{type:"primary",onClick:qe,disabled:!V.value.username||!V.value.password},{default:s(()=>[p(n(e.$t("ftp_sftp.add_user")),1)]),_:1},8,["disabled"])]),default:s(()=>[t(Q,{model:V.value,"label-position":"top"},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.username"),required:""},{default:s(()=>[t(U,{modelValue:V.value.username,"onUpdate:modelValue":a[26]||(a[26]=l=>V.value.username=l)},null,8,["modelValue"])]),_:1},8,["label"]),t(y,{label:e.$t("ftp_sftp.password"),required:""},{default:s(()=>[t(U,{modelValue:V.value.password,"onUpdate:modelValue":a[27]||(a[27]=l=>V.value.password=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1},8,["label"]),t(y,{label:e.$t("ftp_sftp.home_directory")},{default:s(()=>[t(U,{modelValue:V.value.homeDirectory,"onUpdate:modelValue":a[28]||(a[28]=l=>V.value.homeDirectory=l),placeholder:"/home/username"},{append:s(()=>[t(u,{onClick:Se},{default:s(()=>[t(r(i),{icon:"material-symbols:folder-open"})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(ne,{modelValue:j.value,"onUpdate:modelValue":a[35]||(a[35]=l=>j.value=l),title:e.$t("ftp_sftp.change_password"),width:"50%"},{footer:s(()=>[t(u,{onClick:a[34]||(a[34]=l=>j.value=!1)},{default:s(()=>[p(n(e.$t("ftp_sftp.cancel")),1)]),_:1}),t(u,{type:"primary",onClick:He,disabled:!$.value.newPassword||!$.value.confirmPassword||$.value.newPassword!==$.value.confirmPassword},{default:s(()=>[p(n(e.$t("ftp_sftp.change_password")),1)]),_:1},8,["disabled"])]),default:s(()=>[t(Q,{model:$.value,"label-position":"top"},{default:s(()=>[t(y,{label:e.$t("ftp_sftp.username")},{default:s(()=>[t(U,{modelValue:$.value.username,"onUpdate:modelValue":a[31]||(a[31]=l=>$.value.username=l),disabled:""},null,8,["modelValue"])]),_:1},8,["label"]),t(y,{label:e.$t("ftp_sftp.new_password"),required:""},{default:s(()=>[t(U,{modelValue:$.value.newPassword,"onUpdate:modelValue":a[32]||(a[32]=l=>$.value.newPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1},8,["label"]),t(y,{label:e.$t("ftp_sftp.confirm_password"),required:""},{default:s(()=>[t(U,{modelValue:$.value.confirmPassword,"onUpdate:modelValue":a[33]||(a[33]=l=>$.value.confirmPassword=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(ne,{modelValue:z.value,"onUpdate:modelValue":a[37]||(a[37]=l=>z.value=l),title:I.value,width:"60%"},{footer:s(()=>[t(u,{onClick:a[36]||(a[36]=l=>z.value=!1)},{default:s(()=>[p(n(e.$t("ftp_sftp.cancel")),1)]),_:1}),t(u,{type:"primary",onClick:Ue,disabled:!R.value},{default:s(()=>[p(n(e.$t("ftp_sftp.confirm")),1)]),_:1},8,["disabled"])]),default:s(()=>[t(Ge,{data:x.value,props:ke,load:De,lazy:"","node-key":"path",onNodeClick:Ce,"highlight-current":""},{default:s(({node:l,data:H})=>[f("span",zt,[t(r(i),{icon:H.isLeaf?"mdi:folder-outline":"mdi:folder-open-outline"},null,8,["icon"]),f("span",It,n(l.label),1)])]),_:1},8,["data"])]),_:1},8,["modelValue","title"])])}}},Rt=Ke(Nt,[["__scopeId","data-v-2f62ed64"]]);export{Rt as default};
