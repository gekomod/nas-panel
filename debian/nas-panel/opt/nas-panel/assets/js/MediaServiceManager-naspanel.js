import{_ as xe,u as ea,r as g,D as re,o as ye,H as aa,b as S,d as f,e as p,f as a,g as s,w as c,k as r,I as d,m as _,t as l,i as P,h as de,F as Y,l as Z,n as we,v as C,x as h,C as D}from"./index-naspanel.js";const sa={class:"media-service-manager"},ta={class:"media-header-panel"},la={class:"service-header"},ia={class:"service-icon-container"},na={class:"service-status-badge"},oa={class:"service-info"},ra={class:"service-title"},da={class:"service-meta"},ca={key:0,class:"version-info"},ua={class:"type-info"},va={class:"port-info"},ma={class:"update-time"},pa={key:0,class:"service-url"},ha=["href"],fa={class:"service-actions"},ga={class:"service-toggle"},_a={class:"toggle-label"},ba={class:"server-selector"},ya={class:"server-options"},wa=["onClick"],$a={class:"server-icon"},ka={class:"server-info"},Sa={class:"server-name"},Ca={key:0,class:"config-section"},Pa={class:"tab-content"},Va={class:"config-grid"},Ta={class:"config-group"},La={class:"config-group-header"},Ia={class:"config-item"},Ua={class:"config-label"},Aa={class:"config-hint"},Ba={class:"config-item"},Ea={class:"config-label"},Na={class:"config-item"},za={class:"config-label"},Ma={class:"config-switch-wrapper"},Ra={class:"config-hint"},Fa={class:"config-group"},Da={class:"config-group-header"},qa={class:"config-item"},Ha={class:"config-label"},ja={class:"config-item"},Oa={class:"config-label"},Wa={class:"config-switch-wrapper"},Ga={class:"config-hint"},Ja={class:"config-item"},Ka={class:"config-label"},Qa={class:"config-hint"},Xa={key:0,class:"config-group"},Ya={class:"config-group-header"},Za={class:"config-item"},xa={class:"config-label"},es={class:"config-item"},as={class:"config-label"},ss={class:"config-switch-wrapper"},ts={class:"config-hint"},ls={class:"libraries-section"},is={class:"section-header"},ns={class:"library-actions-header"},os={key:0,class:"loading-libraries"},rs={key:1,class:"empty-libraries"},ds={key:0,class:"empty-hint"},cs={key:2,class:"libraries-grid"},us={class:"library-header"},vs={class:"library-name"},ms={class:"library-path"},ps={class:"library-stats"},hs={key:0,class:"stat-item"},fs={key:1,class:"stat-item"},gs={key:2,class:"stat-item"},_s={class:"library-actions"},bs={class:"config-actions"},ys={class:"tab-content"},ws={class:"status-grid"},$s={class:"status-header"},ks={class:"status-details"},Ss={class:"status-item"},Cs={class:"status-item"},Ps={class:"status-value"},Vs={class:"status-item"},Ts={class:"status-item"},Ls={key:1,class:"status-value"},Is={class:"status-item"},Us={class:"status-value"},As={class:"status-item"},Bs={class:"status-value"},Es=["href"],Ns={class:"logs-header"},zs={class:"log-controls"},Ms={class:"logs-container"},Rs={key:0,class:"log-loading"},Fs={key:1,class:"log-output"},Ds={class:"logs-actions"},qs={class:"tab-content"},Hs={class:"stats-header"},js={class:"stats-grid"},Os={class:"stat-card"},Ws={class:"stat-header"},Gs={class:"stat-content"},Js={class:"resource-item"},Ks={class:"resource-value"},Qs={class:"resource-item"},Xs={class:"resource-value"},Ys={class:"stat-card"},Zs={class:"stat-header"},xs={class:"stat-badge"},et={class:"stat-content"},at={key:0,class:"empty-users"},st={key:1,class:"users-list"},tt={class:"user-avatar"},lt={class:"user-info"},it={class:"user-name"},nt={class:"user-activity"},ot={class:"user-session"},rt={class:"session-duration"},dt={class:"stat-card"},ct={class:"stat-header"},ut={class:"stat-badge"},vt={class:"stat-content"},mt={key:0,class:"empty-streams"},pt={key:1,class:"streams-info"},ht={class:"streams-list"},ft={class:"stream-user"},gt={class:"stream-quality"},_t={class:"quality-label"},bt={class:"streams-summary"},yt={class:"summary-item"},wt={class:"summary-label"},$t={class:"summary-value"},kt={class:"summary-item"},St={class:"summary-label"},Ct={class:"summary-value"},Pt={key:1,class:"install-section"},Vt={class:"install-content"},Tt={class:"install-icon"},Lt={class:"install-info"},It={class:"install-options"},Ut={class:"option-icon"},At={class:"option-content"},Bt={class:"option-icon"},Et={class:"option-content"},Nt={key:0,class:"install-config"},zt={class:"install-form"},Mt={key:0,class:"docker-options"},Rt={class:"install-actions"},Ft={__name:"MediaServiceManager",setup(Dt){const{t:n}=ea(),N=g("basic"),I=g(!1),x=g(!1),ee=g(!1),G=g(!1),ae=g(!1),J=g(!1),se=g(!1),te=g(null),ce=g(""),$e=g(!1);g(!1);const ue=g([{id:"emby",name:"Emby",icon:"mdi:emby",description:"Media server for organizing, playing, and streaming audio and video",defaultPort:8096,defaultPath:"/opt/emby"},{id:"jellyfin",name:"Jellyfin",icon:"mdi:jellyfin",description:"Free software media system that puts you in control of managing and streaming your media",defaultPort:8096,defaultPath:"/opt/jellyfin"},{id:"plex",name:"Plex",icon:"mdi:plex",description:"Media server and streaming platform",defaultPort:32400,defaultPath:"/opt/plex"}]),u=g(ue.value[0]),o=g({installed:!1,running:!1,installationType:null,version:"",port:null,containerId:null,url:null,uptime:null}),m=g({emby:{status:{installed:!1,running:!1,installationType:null,version:"",port:null,containerId:null,url:null,uptime:null},config:{port:8096,bindAddress:"0.0.0.0",sslEnabled:!1,libraryScanInterval:86400,transcodingEnabled:!0,maxStreams:5},dockerConfig:{restartPolicy:"unless-stopped",autoUpdate:!0},libraries:[],logs:"",stats:{},activeUsers:[],activeStreams:[],streamsStats:{}},jellyfin:{status:{installed:!1,running:!1,installationType:null,version:"",port:null,containerId:null,url:null,uptime:null},config:{port:8096,bindAddress:"0.0.0.0",sslEnabled:!1,libraryScanInterval:86400,transcodingEnabled:!0,maxStreams:5},dockerConfig:{restartPolicy:"unless-stopped",autoUpdate:!0},libraries:[],logs:"",stats:{},activeUsers:[],activeStreams:[],streamsStats:{}},plex:{status:{installed:!1,running:!1,installationType:null,version:"",port:null,containerId:null,url:null,uptime:null},config:{port:32400,bindAddress:"0.0.0.0",sslEnabled:!1,libraryScanInterval:86400,transcodingEnabled:!0,maxStreams:5},dockerConfig:{restartPolicy:"unless-stopped",autoUpdate:!0},libraries:[],logs:"",stats:{},activeUsers:[],activeStreams:[],streamsStats:{}}}),b=g({...m.value.emby.config}),T=g({...m.value.emby.dockerConfig}),U=g([]),L=g(""),K=g(100),V=g({}),A=g([]),B=g([]),z=g({}),M=g(null),y=g({type:null,path:"",port:8096,mediaPath:"/media",containerName:"",restartPolicy:"unless-stopped"}),ke=g({port:8096,sslEnabled:!1,bindAddress:"0.0.0.0",bindAddressEnabled:!0,autoStart:!0,libraryScan:!0,containerName:"",restartPolicy:"unless-stopped"}),ve=()=>{ce.value=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},Se=e=>{if(!e)return"Never";const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},Ce=e=>({movies:"Movies",tvshows:"TV Shows",tvshow:"TV Shows",series:"TV Shows",music:"Music",photos:"Photos",homevideos:"Home Videos",mixed:"Mixed"})[e]||e.charAt(0).toUpperCase()+e.slice(1),me=e=>m.value[e]?.status||{installed:!1,running:!1,installationType:null,version:"",port:null,containerId:null,url:null,uptime:null},Pe=e=>{const t=me(e);return t.running?"status-running":t.installed&&!t.running?"status-stopped":"status-unknown"},Ve=e=>{const t=me(e);return t.running?n("media.running"):t.installed&&!t.running?n("media.stopped"):n("media.notInstalled")},Te=async e=>{u.value=e,await q()},q=async()=>{const e=u.value.id;m.value[e]&&(o.value={...m.value[e].status},b.value={...m.value[e].config},T.value={...m.value[e].dockerConfig},U.value=[...m.value[e].libraries],L.value=m.value[e].logs,V.value={...m.value[e].stats},A.value=[...m.value[e].activeUsers],B.value=[...m.value[e].activeStreams],z.value={...m.value[e].streamsStats}),await Promise.all([H(),Be()]),o.value.running?(await X(),await Q()):(U.value=[],V.value={},A.value=[],B.value=[],z.value={}),N.value==="status"&&await j(),ve()},Le=e=>({movies:"mdi:movie",tvshows:"mdi:television",tvshow:"mdi:television",series:"mdi:television",music:"mdi:music",photos:"mdi:image",homevideos:"mdi:video",mixed:"mdi:folder-multiple"})[e]||"mdi:folder",pe=e=>{if(!e||e===0)return"0 B";const t=1024,v=["B","KB","MB","GB","TB"],k=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,k)).toFixed(2))+" "+v[k]},he=e=>e?e<50?"#67C23A":e<80?"#E6A23C":"#F56C6C":"#909399",Ie=e=>e?e.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2):"?",Ue=e=>{e&&navigator.clipboard.writeText(e).then(()=>h.success(n("common.copied"))).catch(()=>h.error(n("common.copyError")))},Ae=()=>{ke.value={port:b.value.port||u.value.defaultPort,sslEnabled:b.value.sslEnabled||!1,bindAddress:b.value.bindAddress||"0.0.0.0",bindAddressEnabled:!0,autoStart:o.value.running||!1,libraryScan:b.value.libraryScanInterval>0||!1,containerName:o.value.installationType==="docker"?`${u.value.id}-container`:"",restartPolicy:T.value.restartPolicy||"unless-stopped"},$e.value=!0},H=async()=>{try{I.value=!0;const e=u.value.id,v=(await C.get(`/api/media/${e}/status`)).data;return o.value=v,m.value[e]||(m.value[e]={status:{},config:{},dockerConfig:{},libraries:[],logs:"",stats:{},activeUsers:[],activeStreams:[],streamsStats:{}}),m.value[e].status={...v},ve(),v}catch(e){throw console.error("Failed to load service status:",e),h.error(n("media.failedToLoadStatus")),e}finally{I.value=!1}},Be=async()=>{if(o.value.installed)try{const e=u.value.id,v=(await C.get(`/api/media/${e}/config`)).data;b.value=v,m.value[e]&&(m.value[e].config={...v})}catch(e){console.error("Failed to load config:",e),h.error(n("media.failedToLoadConfig"))}},Q=async()=>{if(o.value.installed)try{J.value=!0;const e=u.value.id,v=(await C.get(`/api/media/${e}/libraries`)).data;U.value=v,m.value[e]&&(m.value[e].libraries=[...v])}catch(e){console.error("Failed to load libraries:",e),h.error(n("media.failedToLoadLibraries")),U.value=[]}finally{J.value=!1}},Ee=async()=>{try{const e=u.value.id,t=await C.post(`/api/media/${e}/libraries/refresh`);t.data.success&&(U.value=t.data.libraries,h.success(n("media.librariesRefreshed")),m.value[e]&&(m.value[e].libraries=[...t.data.libraries]))}catch(e){console.error("Failed to refresh libraries:",e),h.error(e.response?.data?.error||e.message)}},j=async()=>{if(o.value.installed)try{G.value=!0;const e=u.value.id,v=(await C.get(`/api/media/${e}/logs`,{params:{lines:K.value}})).data.logs;L.value=v,m.value[e]&&(m.value[e].logs=v)}catch(e){console.error("Failed to load logs:",e),L.value=n("media.failedToLoadLogs"),h.error(n("media.failedToLoadLogs"))}finally{G.value=!1}},X=async()=>{if(o.value.running)try{se.value=!0;const e=u.value.id,v=(await C.get(`/api/media/${e}/stats`)).data;V.value=v,A.value=v.activeUsers||[],B.value=v.activeStreams||[],z.value=v.streamsStats||{},m.value[e]&&(m.value[e].stats={...v},m.value[e].activeUsers=[...v.activeUsers||[]],m.value[e].activeStreams=[...v.activeStreams||[]],m.value[e].streamsStats={...v.streamsStats||{}})}catch(e){console.error("Failed to load stats:",e),V.value={},A.value=[],B.value=[],z.value={},h.error(n("media.failedToLoadStats"))}finally{se.value=!1}},Ne=async()=>{try{I.value=!0;const e=u.value.id,t=o.value.running?"stop":"start";(await C.post(`/api/media/${e}/${t}`)).data.success&&(h.success(n("media.serviceToggleSuccess",{action:t})),await H())}catch(e){o.value.running=!o.value.running,h.error(e.response?.data?.error||e.message)}finally{I.value=!1}},ze=async()=>{try{x.value=!0;const e=u.value.id;(await C.post(`/api/media/${e}/config`,{...b.value,docker:o.value.installationType==="docker"?T.value:void 0,restartRequired:!0})).data.success&&(h.success(n("media.settingsSaved")),m.value[e]&&(m.value[e].config={...b.value},o.value.installationType==="docker"&&(m.value[e].dockerConfig={...T.value})))}catch(e){h.error(e.response?.data?.error||e.message)}finally{x.value=!1}},Me=async()=>{try{await D.confirm(n("media.confirmResetSettings"),n("media.warning"),{confirmButtonText:n("media.confirm"),cancelButtonText:n("media.cancel"),type:"warning"});const e=u.value.id,t={port:u.value.defaultPort,bindAddress:"0.0.0.0",sslEnabled:!1,libraryScanInterval:86400,transcodingEnabled:!0,maxStreams:5};b.value=t,o.value.installationType==="docker"&&(T.value={restartPolicy:"unless-stopped",autoUpdate:!0}),h.success(n("media.settingsReset"))}catch(e){e!=="cancel"&&h.error(e.message)}},Re=async()=>{try{ee.value=!0;const e=u.value.id;(await C.post(`/api/media/${e}/restart`)).data.success&&(h.success(n("media.containerRestarted")),await H())}catch(e){h.error(e.response?.data?.error||e.message)}finally{ee.value=!1}},Fe=async()=>{try{if(!o.value.running){h.warning(n("media.startServiceFirst"));return}const{value:e}=await D.prompt(n("media.enterLibraryName"),n("media.addLibrary"),{confirmButtonText:n("media.add"),cancelButtonText:n("media.cancel"),inputPlaceholder:n("media.libraryNamePlaceholder"),inputValidator:F=>F?!0:n("media.libraryNameRequired")}),{value:t}=await D.prompt(n("media.enterLibraryPath"),n("media.libraryPath"),{confirmButtonText:n("media.add"),cancelButtonText:n("media.cancel"),inputPlaceholder:"/path/to/media",inputValue:"/media/"+e.toLowerCase().replace(/\s+/g,"-"),inputValidator:F=>F?F.startsWith("/")?!0:n("media.pathMustBeAbsolute"):n("media.libraryPathRequired")}),{value:v}=await D.prompt(n("media.selectLibraryType"),n("media.libraryType"),{confirmButtonText:n("media.add"),cancelButtonText:n("media.cancel"),inputType:"select",inputValue:"movies",inputOptions:[{value:"movies",label:n("media.movies")},{value:"tvshows",label:n("media.tvshows")},{value:"music",label:n("media.music")},{value:"photos",label:n("media.photos")},{value:"homevideos",label:n("media.homevideos")}]}),k={name:e,path:t,type:v},R=u.value.id;(await C.post(`/api/media/${R}/libraries`,k)).data.success&&(h.success(n("media.libraryAdded")),await Q())}catch(e){e!=="cancel"&&(console.error("Failed to add library:",e),h.error(e.response?.data?.error||e.message))}},De=async e=>{try{te.value=e;const t=u.value.id;(await C.post(`/api/media/${t}/libraries/${e}/scan`)).data.success&&(h.success(n("media.libraryScanStarted")),setTimeout(async()=>{await Q()},2e3))}catch(t){console.error("Failed to scan library:",t),h.error(t.response?.data?.error||t.message)}finally{te.value=null}},qe=async e=>{try{await D.confirm(n("media.confirmRemoveLibrary"),n("media.warning"),{confirmButtonText:n("media.confirm"),cancelButtonText:n("media.cancel"),type:"warning"});const t=u.value.id;(await C.delete(`/api/media/${t}/libraries/${e}`)).data.success&&(h.success(n("media.libraryRemoved")),await Q())}catch(t){t!=="cancel"&&(console.error("Failed to remove library:",t),h.error(t.response?.data?.error||t.message))}},He=()=>{if(!L.value)return;const e=L.value,t=new Blob([e],{type:"text/plain"}),v=URL.createObjectURL(t),k=document.createElement("a");k.href=v,k.download=`${u.value.id}-logs-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(v),h.success(n("media.logsDownloaded"))},je=async()=>{try{await D.confirm(n("media.confirmClearLogs"),n("media.warning"),{confirmButtonText:n("media.confirm"),cancelButtonText:n("media.cancel"),type:"warning"});const e=u.value.id;(await C.delete(`/api/media/${e}/logs`)).data.success&&(h.success(n("media.logsCleared")),L.value="",m.value[e]&&(m.value[e].logs=""))}catch(e){e!=="cancel"&&h.error(e.response?.data?.error||e.message)}},Oe=()=>{M.value=null,y.value={type:null,path:u.value.defaultPath,port:u.value.defaultPort,mediaPath:"/media",containerName:u.value.id,restartPolicy:"unless-stopped"}},fe=e=>{M.value=e,y.value.type=e,y.value.containerName=`${u.value.id}-${e}`},We=()=>{M.value=null,y.value={type:null,path:u.value.defaultPath,port:u.value.defaultPort,mediaPath:"/media",containerName:u.value.id,restartPolicy:"unless-stopped"}},Ge=async()=>{try{ae.value=!0;const e=u.value.id;if(!y.value.path){h.error(n("media.installPathRequired"));return}if(!y.value.port){h.error(n("media.portRequired"));return}if(!y.value.mediaPath){h.error(n("media.mediaPathRequired"));return}(await C.post(`/api/media/${e}/install`,y.value)).data.success&&(h.success(n("media.installSuccess")),M.value=null,await q())}catch(e){console.error("Installation failed:",e),h.error(e.response?.data?.error||e.message)}finally{ae.value=!1}},Je=async()=>{await q()},Ke=async()=>{await H()},Qe=async()=>{await X()};re(u,async e=>{await q()}),re(N,async e=>{e==="status"&&o.value.installed&&await j(),e==="stats"&&o.value.running&&await X()}),re(K,()=>{N.value==="status"&&o.value.installed&&j()});const Xe=async()=>{try{const t=(await C.get("/api/media/status/all")).data;for(const v in t)m.value[v]&&(m.value[v].status=t[v]);await q()}catch(e){console.error("Failed to load all servers status:",e)}};ye(async()=>{await Xe()});let le=null;return ye(()=>{le=setInterval(async()=>{o.value.installed&&(await H(),N.value==="stats"&&o.value.running&&await X())},3e4)}),aa(()=>{le&&clearInterval(le)}),(e,t)=>{const v=S("el-icon"),k=S("el-tag"),R=S("el-switch"),w=S("el-button"),F=S("el-button-group"),E=S("el-card"),ie=S("el-input-number"),$=S("el-option"),O=S("el-select"),ge=S("el-skeleton"),ne=S("el-tab-pane"),_e=S("el-progress"),Ye=S("el-tabs"),oe=S("el-input"),W=S("el-form-item"),Ze=S("el-form");return p(),f("div",sa,[a("div",ta,[s(E,{shadow:"hover",class:"service-card"},{default:c(()=>[a("div",la,[a("div",ia,[s(v,{size:"42",class:"service-icon"},{default:c(()=>[s(r(d),{icon:u.value.icon},null,8,["icon"])]),_:1}),a("div",na,[s(k,{type:o.value.running?"success":"danger",size:"small",class:"status-tag"},{default:c(()=>[s(r(d),{icon:o.value.running?"mdi:play-circle":"mdi:stop-circle",width:"12"},null,8,["icon"]),_(" "+l(o.value.running?e.$t("media.running"):e.$t("media.stopped")),1)]),_:1},8,["type"])])]),a("div",oa,[a("h2",ra,l(u.value.name),1),a("div",da,[o.value.version?(p(),f("span",ca,[s(r(d),{icon:"mdi:tag",width:"12"}),_(" v"+l(o.value.version),1)])):P("",!0),a("span",ua,[s(r(d),{icon:"mdi:cube-outline",width:"12"}),_(" "+l(o.value.installationType||"Not installed"),1)]),a("span",va,[s(r(d),{icon:"mdi:network-port",width:"12"}),_(" Port: "+l(o.value.port||u.value.defaultPort),1)]),a("span",ma,[s(r(d),{icon:"mdi:update",width:"12"}),_(" "+l(e.$t("common.update"))+": "+l(ce.value),1)])]),o.value.running&&o.value.url?(p(),f("div",pa,[a("a",{href:o.value.url||`http://localhost:${o.value.port||u.value.defaultPort}`,target:"_blank",class:"web-link"},[s(r(d),{icon:"mdi:open-in-new",width:"14"}),_(" "+l(e.$t("media.openWebInterface")),1)],8,ha)])):P("",!0)]),a("div",fa,[a("div",ga,[a("label",_a,l(e.$t("media.serviceState")),1),s(R,{modelValue:o.value.running,"onUpdate:modelValue":t[0]||(t[0]=i=>o.value.running=i),onChange:Ne,loading:I.value,"active-text":e.$t("media.enabled"),"inactive-text":e.$t("media.disabled"),disabled:!o.value.installed,"inline-prompt":"","active-color":"var(--el-color-success)","inactive-color":"var(--el-color-danger)"},null,8,["modelValue","loading","active-text","inactive-text","disabled"])]),s(F,{class:"service-buttons"},{default:c(()=>[s(w,{onClick:Je,loading:I.value,circle:"",class:"action-btn"},{default:c(()=>[s(r(d),{icon:"mdi:refresh",width:"14"})]),_:1},8,["loading"]),o.value.installed?(p(),de(w,{key:0,onClick:Ae,circle:"",type:"primary",class:"action-btn"},{default:c(()=>[s(r(d),{icon:"mdi:cog",width:"14"})]),_:1})):P("",!0),o.value.installed?P("",!0):(p(),de(w,{key:1,onClick:Oe,type:"primary",circle:"",class:"action-btn"},{default:c(()=>[s(r(d),{icon:"mdi:download",width:"14"})]),_:1}))]),_:1})])])]),_:1})]),s(E,{shadow:"hover",class:"server-selector-card"},{default:c(()=>[a("div",ba,[a("div",ya,[(p(!0),f(Y,null,Z(ue.value,i=>(p(),f("div",{key:i.id,class:we(["server-option",{active:u.value.id===i.id}]),onClick:be=>Te(i)},[a("div",$a,[s(r(d),{icon:i.icon,width:"24"},null,8,["icon"])]),a("div",ka,[a("span",Sa,l(i.name),1),a("span",{class:we(["server-status",Pe(i.id)])},l(Ve(i.id)),3)])],10,wa))),128))])])]),_:1}),o.value.installed?(p(),f("div",Ca,[s(Ye,{modelValue:N.value,"onUpdate:modelValue":t[11]||(t[11]=i=>N.value=i),type:"border-card",class:"compact-tabs"},{default:c(()=>[s(ne,{label:e.$t("media.basicSettings"),name:"basic"},{default:c(()=>[a("div",Pa,[s(E,{shadow:"hover",class:"compact-card"},{default:c(()=>[a("div",Va,[a("div",Ta,[a("div",La,[s(r(d),{icon:"mdi:network",width:"16"}),a("h4",null,l(e.$t("media.networkSettings")),1)]),a("div",Ia,[a("label",Ua,l(e.$t("media.port")),1),s(ie,{modelValue:b.value.port,"onUpdate:modelValue":t[1]||(t[1]=i=>b.value.port=i),min:1,max:65535,"controls-position":"right",class:"compact-input"},null,8,["modelValue"]),a("div",Aa,l(e.$t("media.portHint")),1)]),a("div",Ba,[a("label",Ea,l(e.$t("media.bindAddress")),1),s(O,{modelValue:b.value.bindAddress,"onUpdate:modelValue":t[2]||(t[2]=i=>b.value.bindAddress=i),placeholder:"Select bind address",class:"compact-input"},{default:c(()=>[s($,{label:"All interfaces (0.0.0.0)",value:"0.0.0.0"}),s($,{label:"Localhost only (127.0.0.1)",value:"127.0.0.1"})]),_:1},8,["modelValue"])]),a("div",Na,[a("label",za,l(e.$t("media.sslEnabled")),1),a("div",Ma,[s(R,{modelValue:b.value.sslEnabled,"onUpdate:modelValue":t[3]||(t[3]=i=>b.value.sslEnabled=i),"inline-prompt":"","active-text":e.$t("media.enabled"),"inactive-text":e.$t("media.disabled"),"active-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),a("div",Ra,l(e.$t("media.sslHint")),1)])]),a("div",Fa,[a("div",Da,[s(r(d),{icon:"mdi:movie-play",width:"16"}),a("h4",null,l(e.$t("media.mediaSettings")),1)]),a("div",qa,[a("label",Ha,l(e.$t("media.libraryScanInterval")),1),s(O,{modelValue:b.value.libraryScanInterval,"onUpdate:modelValue":t[4]||(t[4]=i=>b.value.libraryScanInterval=i),class:"compact-input"},{default:c(()=>[s($,{label:e.$t("media.disabled"),value:"0"},null,8,["label"]),s($,{label:e.$t("media.everyHour"),value:"3600"},null,8,["label"]),s($,{label:e.$t("media.every6Hours"),value:"21600"},null,8,["label"]),s($,{label:e.$t("media.every12Hours"),value:"43200"},null,8,["label"]),s($,{label:e.$t("media.daily"),value:"86400"},null,8,["label"])]),_:1},8,["modelValue"])]),a("div",ja,[a("label",Oa,l(e.$t("media.transcodingEnabled")),1),a("div",Wa,[s(R,{modelValue:b.value.transcodingEnabled,"onUpdate:modelValue":t[5]||(t[5]=i=>b.value.transcodingEnabled=i),"inline-prompt":"","active-text":e.$t("media.enabled"),"inactive-text":e.$t("media.disabled"),"active-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),a("div",Ga,l(e.$t("media.transcodingHint")),1)]),a("div",Ja,[a("label",Ka,l(e.$t("media.maxStreams")),1),s(ie,{modelValue:b.value.maxStreams,"onUpdate:modelValue":t[6]||(t[6]=i=>b.value.maxStreams=i),min:1,max:20,"controls-position":"right",class:"compact-input"},null,8,["modelValue"]),a("div",Qa,l(e.$t("media.maxStreamsHint")),1)])]),o.value.installationType==="docker"?(p(),f("div",Xa,[a("div",Ya,[s(r(d),{icon:"mdi:docker",width:"16"}),a("h4",null,l(e.$t("media.dockerSettings")),1)]),a("div",Za,[a("label",xa,l(e.$t("media.restartPolicy")),1),s(O,{modelValue:T.value.restartPolicy,"onUpdate:modelValue":t[7]||(t[7]=i=>T.value.restartPolicy=i),class:"compact-input"},{default:c(()=>[s($,{label:"no",value:"no"}),s($,{label:"always",value:"always"}),s($,{label:"on-failure",value:"on-failure"}),s($,{label:"unless-stopped",value:"unless-stopped"})]),_:1},8,["modelValue"])]),a("div",es,[a("label",as,l(e.$t("media.autoUpdate")),1),a("div",ss,[s(R,{modelValue:T.value.autoUpdate,"onUpdate:modelValue":t[8]||(t[8]=i=>T.value.autoUpdate=i),"inline-prompt":"","active-text":e.$t("media.enabled"),"inactive-text":e.$t("media.disabled"),"active-color":"var(--el-color-success)"},null,8,["modelValue","active-text","inactive-text"])]),a("div",ts,l(e.$t("media.autoUpdateHint")),1)])])):P("",!0)]),a("div",ls,[a("div",is,[s(r(d),{icon:"mdi:folder-multiple",width:"16"}),a("h4",null,l(e.$t("media.mediaLibraries")),1),a("div",ns,[s(w,{onClick:Ee,loading:J.value,size:"small",class:"refresh-btn"},{default:c(()=>[s(r(d),{icon:"mdi:refresh",width:"12"}),_(" "+l(e.$t("media.refresh")),1)]),_:1},8,["loading"]),s(w,{onClick:Fe,type:"primary",size:"small",class:"add-library-btn",disabled:!o.value.running},{default:c(()=>[s(r(d),{icon:"mdi:plus",width:"12"}),_(" "+l(e.$t("media.addLibrary")),1)]),_:1},8,["disabled"])])]),J.value?(p(),f("div",os,[s(ge,{rows:3,animated:""})])):U.value.length===0?(p(),f("div",rs,[s(r(d),{icon:"mdi:folder-off",width:"48"}),a("p",null,l(e.$t("media.noLibraries")),1),o.value.running?P("",!0):(p(),f("p",ds,l(e.$t("media.startServiceToManageLibraries")),1))])):(p(),f("div",cs,[(p(!0),f(Y,null,Z(U.value,i=>(p(),f("div",{key:i.id,class:"library-card"},[a("div",us,[s(r(d),{icon:Le(i.type),width:"20"},null,8,["icon"]),a("span",vs,l(i.name),1),s(k,{size:"small",class:"library-type"},{default:c(()=>[_(l(Ce(i.type)),1)]),_:2},1024)]),a("div",ms,[s(r(d),{icon:"mdi:folder",width:"14"}),_(" "+l(i.path),1)]),a("div",ps,[i.movies>0?(p(),f("div",hs,[s(r(d),{icon:"mdi:movie",width:"12"}),a("span",null,l(i.movies)+" "+l(e.$t("media.movies")),1)])):P("",!0),i.shows>0?(p(),f("div",fs,[s(r(d),{icon:"mdi:television",width:"12"}),a("span",null,l(i.shows)+" "+l(e.$t("media.shows")),1)])):P("",!0),i.lastScanned?(p(),f("div",gs,[s(r(d),{icon:"mdi:calendar-clock",width:"12"}),a("span",null,l(Se(i.lastScanned)),1)])):P("",!0)]),a("div",_s,[s(w,{onClick:be=>De(i.id),loading:te.value===i.id,size:"small",class:"scan-btn",disabled:!o.value.running},{default:c(()=>[s(r(d),{icon:"mdi:refresh",width:"12"}),_(" "+l(e.$t("media.scan")),1)]),_:2},1032,["onClick","loading","disabled"]),s(w,{onClick:be=>qe(i.id),size:"small",type:"danger",plain:"",disabled:!o.value.running},{default:c(()=>[s(r(d),{icon:"mdi:delete",width:"12"})]),_:2},1032,["onClick","disabled"])])]))),128))]))]),a("div",bs,[s(w,{type:"primary",onClick:ze,loading:x.value,size:"large",class:"save-btn"},{default:c(()=>[s(r(d),{icon:"mdi:content-save",width:"16"}),_(" "+l(e.$t("media.saveSettings")),1)]),_:1},8,["loading"]),s(w,{onClick:Me,size:"large",class:"reset-btn"},{default:c(()=>[s(r(d),{icon:"mdi:restore",width:"16"}),_(" "+l(e.$t("media.reset")),1)]),_:1}),o.value.installationType==="docker"&&o.value.running?(p(),de(w,{key:0,onClick:Re,loading:ee.value,size:"large",type:"warning",class:"restart-btn"},{default:c(()=>[s(r(d),{icon:"mdi:restart",width:"16"}),_(" "+l(e.$t("media.restartContainer")),1)]),_:1},8,["loading"])):P("",!0)])]),_:1})])]),_:1},8,["label"]),s(ne,{label:e.$t("media.serviceStatus"),name:"status"},{default:c(()=>[a("div",ys,[a("div",ws,[s(E,{shadow:"hover",class:"compact-card status-card"},{default:c(()=>[a("div",$s,[s(r(d),{icon:"mdi:information-outline",width:"20",class:"status-icon"}),a("h4",null,l(e.$t("media.serviceDetails")),1),s(w,{onClick:Ke,loading:I.value,size:"small",class:"refresh-btn"},{default:c(()=>[s(r(d),{icon:"mdi:refresh",width:"12"})]),_:1},8,["loading"])]),a("div",ks,[a("div",Ss,[a("label",null,l(e.$t("media.status")),1),s(k,{type:o.value.running?"success":"danger",class:"status-value-tag"},{default:c(()=>[s(r(d),{icon:o.value.running?"mdi:check-circle":"mdi:close-circle",width:"12"},null,8,["icon"]),_(" "+l(o.value.running?e.$t("media.running"):e.$t("media.stopped")),1)]),_:1},8,["type"])]),a("div",Cs,[a("label",null,l(e.$t("media.version")),1),a("span",Ps,l(o.value.version||"N/A"),1)]),a("div",Vs,[a("label",null,l(e.$t("media.installationType")),1),s(k,{class:"status-value-tag"},{default:c(()=>[_(l(o.value.installationType||"N/A"),1)]),_:1})]),a("div",Ts,[a("label",null,l(e.$t("media.containerId")),1),o.value.containerId?(p(),f("span",{key:0,class:"status-value copyable",onClick:t[9]||(t[9]=i=>Ue(o.value.containerId))},[_(l(o.value.containerId.substring(0,12))+" ",1),s(r(d),{icon:"mdi:content-copy",width:"12",class:"copy-icon"})])):(p(),f("span",Ls,"N/A"))]),a("div",Is,[a("label",null,l(e.$t("media.upTime")),1),a("span",Us,l(o.value.uptime||"N/A"),1)]),a("div",As,[a("label",null,l(e.$t("media.url")),1),a("span",Bs,[a("a",{href:o.value.url,target:"_blank",class:"service-link"},l(o.value.url||"N/A"),9,Es)])])])]),_:1}),s(E,{shadow:"hover",class:"compact-card logs-card"},{default:c(()=>[a("div",Ns,[s(r(d),{icon:"mdi:clipboard-text-outline",width:"20",class:"status-icon"}),a("h4",null,l(e.$t("media.serviceLogs")),1),a("div",zs,[s(O,{modelValue:K.value,"onUpdate:modelValue":t[10]||(t[10]=i=>K.value=i),size:"small",style:{width:"120px"},onChange:j},{default:c(()=>[s($,{label:"100 lines",value:100}),s($,{label:"500 lines",value:500}),s($,{label:"1000 lines",value:1e3})]),_:1},8,["modelValue"])])]),a("div",Ms,[G.value?(p(),f("pre",Rs,[t[19]||(t[19]=_("                    ")),s(ge,{rows:5,animated:""}),t[20]||(t[20]=_(`
                  `))])):(p(),f("pre",Fs,l(L.value),1))]),a("div",Ds,[s(w,{onClick:j,loading:G.value,size:"small",class:"log-action-btn"},{default:c(()=>[s(r(d),{icon:"mdi:refresh",width:"12"}),_(" "+l(e.$t("media.refreshLogs")),1)]),_:1},8,["loading"]),s(w,{onClick:He,size:"small",class:"log-action-btn",disabled:!L.value},{default:c(()=>[s(r(d),{icon:"mdi:download",width:"12"}),_(" "+l(e.$t("media.downloadLogs")),1)]),_:1},8,["disabled"]),s(w,{onClick:je,size:"small",type:"danger",plain:"",class:"log-action-btn",disabled:!L.value||!o.value.installed},{default:c(()=>[s(r(d),{icon:"mdi:delete",width:"12"}),_(" "+l(e.$t("media.clearLogs")),1)]),_:1},8,["disabled"])])]),_:1})])])]),_:1},8,["label"]),s(ne,{label:e.$t("media.statistics"),name:"stats",disabled:!o.value.running},{default:c(()=>[a("div",qs,[s(E,{shadow:"hover",class:"compact-card"},{default:c(()=>[a("div",Hs,[s(r(d),{icon:"mdi:chart-line",width:"20"}),a("h4",null,l(e.$t("media.realTimeStats")),1),s(w,{onClick:Qe,loading:se.value,size:"small",class:"refresh-btn"},{default:c(()=>[s(r(d),{icon:"mdi:refresh",width:"12"}),_(" "+l(e.$t("media.refresh")),1)]),_:1},8,["loading"])]),a("div",js,[a("div",Os,[a("div",Ws,[s(r(d),{icon:"mdi:cpu-64-bit",width:"20"}),a("h4",null,l(e.$t("media.systemResources")),1)]),a("div",Gs,[a("div",Js,[t[21]||(t[21]=a("label",null,"CPU",-1)),s(_e,{percentage:V.value.cpuPercent||0,"stroke-width":8,color:he(V.value.cpuPercent),format:i=>`${i}%`},null,8,["percentage","color","format"]),a("span",Ks,l(V.value.cpuPercent||0)+"%",1)]),a("div",Qs,[a("label",null,l(e.$t("media.memory")),1),s(_e,{percentage:V.value.memoryPercent||0,"stroke-width":8,color:he(V.value.memoryPercent),format:i=>`${i}%`},null,8,["percentage","color","format"]),a("span",Xs,l(pe(V.value.memoryUsed))+" / "+l(pe(V.value.memoryTotal)),1)])])]),a("div",Ys,[a("div",Zs,[s(r(d),{icon:"mdi:account-multiple",width:"20"}),a("h4",null,l(e.$t("media.activeUsers")),1),a("span",xs,l(A.value.length),1)]),a("div",et,[A.value.length===0?(p(),f("div",at,[s(r(d),{icon:"mdi:account-off",width:"32"}),a("p",null,l(e.$t("media.noActiveUsers")),1)])):(p(),f("div",st,[(p(!0),f(Y,null,Z(A.value,i=>(p(),f("div",{key:i.id,class:"user-item"},[a("div",tt,l(Ie(i.name)),1),a("div",lt,[a("span",it,l(i.name),1),a("span",nt,l(i.activity),1)]),a("div",ot,[a("span",rt,l(i.duration),1)])]))),128))]))])]),a("div",dt,[a("div",ct,[s(r(d),{icon:"mdi:play-circle",width:"20"}),a("h4",null,l(e.$t("media.activeStreams")),1),a("span",ut,l(B.value.length),1)]),a("div",vt,[B.value.length===0?(p(),f("div",mt,[s(r(d),{icon:"mdi:play-circle-outline",width:"32"}),a("p",null,l(e.$t("media.noActiveStreams")),1)])):(p(),f("div",pt,[a("div",ht,[(p(!0),f(Y,null,Z(B.value,i=>(p(),f("div",{key:i.id,class:"stream-item"},[a("div",ft,[s(r(d),{icon:"mdi:account",width:"14"}),_(" "+l(i.user),1)]),a("div",gt,[s(k,{size:"small",type:i.transcoding?"warning":"success"},{default:c(()=>[_(l(i.transcoding?e.$t("media.transcoding"):e.$t("media.directPlay")),1)]),_:2},1032,["type"]),a("span",_t,l(i.quality),1)])]))),128))]),a("div",bt,[a("div",yt,[a("span",wt,l(e.$t("media.directPlay"))+":",1),a("span",$t,l(z.value.directPlay||0),1)]),a("div",kt,[a("span",St,l(e.$t("media.transcoding"))+":",1),a("span",Ct,l(z.value.transcoding||0),1)])])]))])])])]),_:1})])]),_:1},8,["label","disabled"])]),_:1},8,["modelValue"])])):(p(),f("div",Pt,[s(E,{shadow:"hover",class:"install-card"},{default:c(()=>[a("div",Vt,[a("div",Tt,[s(r(d),{icon:u.value.icon,width:"64"},null,8,["icon"])]),a("div",Lt,[a("h3",null,l(e.$t("media.installTitle",{name:u.value.name})),1),a("p",null,l(u.value.description),1),a("div",It,[a("div",{class:"install-option",onClick:t[12]||(t[12]=i=>fe("docker"))},[a("div",Ut,[s(r(d),{icon:"mdi:docker",width:"32"})]),a("div",At,[t[23]||(t[23]=a("h4",null,"Docker",-1)),a("p",null,l(e.$t("media.dockerInstallDesc")),1),s(k,{type:"success",size:"small"},{default:c(()=>t[22]||(t[22]=[_("Recommended")])),_:1,__:[22]})])]),a("div",{class:"install-option",onClick:t[13]||(t[13]=i=>fe("native"))},[a("div",Bt,[s(r(d),{icon:"mdi:server",width:"32"})]),a("div",Et,[t[24]||(t[24]=a("h4",null,"Native",-1)),a("p",null,l(e.$t("media.nativeInstallDesc")),1)])])]),M.value?(p(),f("div",Nt,[a("h4",null,l(e.$t("media.installationConfiguration")),1),a("div",zt,[s(Ze,{"label-position":"top"},{default:c(()=>[s(W,{label:e.$t("media.installPath"),required:""},{default:c(()=>[s(oe,{modelValue:y.value.path,"onUpdate:modelValue":t[14]||(t[14]=i=>y.value.path=i),placeholder:u.value.defaultPath},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(W,{label:e.$t("media.port"),required:""},{default:c(()=>[s(ie,{modelValue:y.value.port,"onUpdate:modelValue":t[15]||(t[15]=i=>y.value.port=i),min:1,max:65535,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"]),s(W,{label:e.$t("media.mediaPath"),required:""},{default:c(()=>[s(oe,{modelValue:y.value.mediaPath,"onUpdate:modelValue":t[16]||(t[16]=i=>y.value.mediaPath=i),placeholder:"/media"},null,8,["modelValue"])]),_:1},8,["label"]),M.value==="docker"?(p(),f("div",Mt,[s(W,{label:e.$t("media.containerName")},{default:c(()=>[s(oe,{modelValue:y.value.containerName,"onUpdate:modelValue":t[17]||(t[17]=i=>y.value.containerName=i),placeholder:u.value.id},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(W,{label:e.$t("media.restartPolicy")},{default:c(()=>[s(O,{modelValue:y.value.restartPolicy,"onUpdate:modelValue":t[18]||(t[18]=i=>y.value.restartPolicy=i),style:{width:"100%"}},{default:c(()=>[s($,{label:"always",value:"always"}),s($,{label:"unless-stopped",value:"unless-stopped"}),s($,{label:"on-failure",value:"on-failure"}),s($,{label:"no",value:"no"})]),_:1},8,["modelValue"])]),_:1},8,["label"])])):P("",!0)]),_:1})]),a("div",Rt,[s(w,{onClick:We,class:"cancel-btn"},{default:c(()=>[_(l(e.$t("media.cancel")),1)]),_:1}),s(w,{type:"primary",onClick:Ge,loading:ae.value,class:"install-btn"},{default:c(()=>[s(r(d),{icon:"mdi:download",width:"16"}),_(" "+l(e.$t("media.install")),1)]),_:1},8,["loading"])])])):P("",!0)])])]),_:1})]))])}}},Ht=xe(Ft,[["__scopeId","data-v-54a6213f"]]);export{Ht as default};
