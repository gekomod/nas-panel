const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/DockerContainers-naspanel.js","assets/js/index-naspanel.js","assets/css/index-naspanel.css","assets/js/ContainerStats-naspanel.js","assets/css/ContainerStats-naspanel.css","assets/css/DockerContainers-naspanel.css","assets/js/DockerImages-naspanel.js","assets/css/DockerImages-naspanel.css","assets/js/DockerNetworks-naspanel.js","assets/css/DockerNetworks-naspanel.css","assets/js/DockerVolumes-naspanel.js","assets/css/DockerVolumes-naspanel.css","assets/js/DockerCompose-naspanel.js","assets/css/DockerCompose-naspanel.css","assets/js/DockerInstall-naspanel.js","assets/css/DockerInstall-naspanel.css","assets/js/DockerSettings-naspanel.js","assets/css/DockerSettings-naspanel.css","assets/js/DockerBackup-naspanel.js","assets/js/DockerBuilder-naspanel.js","assets/css/DockerBuilder-naspanel.css"])))=>i.map(i=>d[i]);
import{r as u,c as $,D as me,J as fe,o as pe,b as g,d as v,e as i,g as e,i as h,w as o,f as l,n as J,k as s,I as d,m as _,t as D,h as z,F as ke,K as f,v as C,x as w,L as p,M as ge}from"./index-naspanel.js";const he={key:0,class:"docker-dashboard"},ye={class:"status-header"},De={class:"status-info"},we={class:"status-title"},Ce={class:"status-meta"},be={key:0,class:"version"},Ee={class:"updated"},Ie={class:"action-buttons"},Ve={key:0,class:"health-section"},Se={class:"health-header"},Le={key:0,class:"health-loading"},Te={key:1,class:"health-content"},Fe={class:"health-info"},Re={class:"health-title"},Ae={key:0,class:"health-subtitle"},ze={class:"health-stats"},Be={class:"stat-item"},Pe={class:"stat-value"},Ne={class:"stat-item"},$e={class:"stat-value"},xe={key:0,class:"stat-item"},Oe={class:"stat-value"},He={key:0,class:"health-actions"},Me={key:0,class:"tabs-container"},Ue={key:1,class:"settings-loading"},Ke={key:1,class:"loading-fallback"},je={__name:"DockerStatus",setup(Ye){const j=f(()=>p(()=>import("./DockerContainers-naspanel.js"),__vite__mapDeps([0,1,2,3,4,5])).catch(a=>(console.error("Failed to load DockerContainers:",a),{template:"<div>Error loading Containers component</div>"}))),q=f(()=>p(()=>import("./DockerImages-naspanel.js"),__vite__mapDeps([6,1,2,7])).catch(a=>(console.error("Failed to load DockerImages:",a),{template:"<div>Error loading Images component</div>"}))),G=f(()=>p(()=>import("./DockerNetworks-naspanel.js"),__vite__mapDeps([8,1,2,9])).catch(a=>(console.error("Failed to load DockerNetworks:",a),{template:"<div>Error loading Networks component</div>"}))),Q=f(()=>p(()=>import("./DockerVolumes-naspanel.js"),__vite__mapDeps([10,1,2,11])).catch(a=>(console.error("Failed to load DockerVolumes:",a),{template:"<div>Error loading Volumes component</div>"}))),W=f(()=>p(()=>import("./DockerCompose-naspanel.js"),__vite__mapDeps([12,1,2,13])).catch(a=>(console.error("Failed to load DockerCompose:",a),{template:"<div>Error loading Compose component</div>"}))),X=f(()=>p(()=>import("./DockerInstall-naspanel.js"),__vite__mapDeps([14,1,2,15])).catch(a=>(console.error("Failed to load DockerInstall:",a),{template:"<div>Error loading Install component</div>"}))),Z=f(()=>p(()=>import("./ContainerStats-naspanel.js"),__vite__mapDeps([3,1,2,4])).catch(a=>(console.error("Failed to load ContainerStats:",a),{template:"<div>Error loading Stats component</div>"}))),ee=f(()=>p(()=>import("./DockerSettings-naspanel.js"),__vite__mapDeps([16,1,2,17])).catch(a=>(console.error("Failed to load DockerSettings:",a),{template:"<div>Error loading Settings component</div>"}))),te=f(()=>p(()=>import("./DockerBackup-naspanel.js"),__vite__mapDeps([18,1,2])).catch(a=>(console.error("Failed to load DockerBackup:",a),{template:"<div>Error loading Backup component</div>"}))),ae=f(()=>p(()=>import("./DockerBuilder-naspanel.js"),__vite__mapDeps([19,1,2,20])).catch(a=>(console.error("Failed to load DockerBuilder:",a),{template:"<div>Error loading Builder component</div>"}))),x=u(!0),n=u({installed:!1,version:null,status:"unknown",info:""}),c=u({healthy:!1,containersCount:0,timestamp:null,error:null,recovered:!1}),I=u(null),O=u(!0),b=u(!1),V=u(!1),S=u("containers"),L=u(!1),F=u(!1),H=u(""),M=u(Date.now()),B=u(0),R=u(0);ge("reloadKey",R);const U=$(()=>n.value.installed?n.value.status==="active"?"success":"warning":"danger"),oe=$(()=>n.value.installed?n.value.status==="active"?"mdi:check-circle":"mdi:alert-circle":"mdi:docker-off"),se=$(()=>n.value.installed?n.value.status==="active"?"Running":"Stopped":"Not Installed"),T=async()=>{try{O.value=!0;const a=await C.get("/services/docker/status",{timeout:5e3});n.value=a.data,M.value=Date.now(),n.value.installed&&n.value.status==="active"&&await A()}catch(a){console.error("Failed to fetch Docker status:",a),n.value={installed:!1,status:"unknown",version:null,info:"Unable to connect to Docker service"}}finally{O.value=!1}},A=async()=>{if(!(!n.value.installed||n.value.status!=="active"))try{b.value=!0;const a=await C.get("/services/docker/health",{timeout:8e3});c.value=a.data}catch(a){c.value={healthy:!1,error:a.message||"Health check failed",timestamp:Date.now()}}finally{b.value=!1}},P=async a=>{try{V.value=!0,await C.post(`/services/docker/${a}`),w.success(`Docker service ${a}ed successfully`),await T(),R.value++,n.value.installed&&a!=="stop"&&setTimeout(()=>{N()},1500)}catch(t){w.error(`Failed to ${a} Docker service`),console.error(t)}finally{V.value=!1}},le=async()=>{try{b.value=!0,await C.post("/services/docker/restart"),w.success("Docker restart initiated"),setTimeout(async()=>{await T(),await A()},3e3)}catch(a){w.error("Failed to restart Docker"),console.error(a)}finally{b.value=!1}},ne=async a=>{try{await C.post(`/services/docker/container/${a}/restart`),w.success("Container restarted successfully"),R.value++}catch(t){w.error("Failed to restart container"),console.error(t)}},re=a=>{H.value=a,F.value=!0},N=async()=>{try{const a=await C.get("/services/docker/config");I.value=a.data,B.value++}catch(a){console.error("Failed to fetch Docker configuration:",a),I.value={daemonPort:2375,ipv6Enabled:!1,loggingDriver:"json-file",maxConcurrentDownloads:3,dataRoot:"/var/lib/docker"},B.value++}},ie=async a=>{try{await C.post("/services/docker/config",a),await N(),w.success("Docker settings saved successfully"),R.value++}catch(t){throw w.error("Failed to save Docker settings"),console.error(t),t}},K=a=>{if(!a)return"Never";const t=new Date(a),k=new Date-t;return k<6e4?"Just now":k<36e5?`${Math.floor(k/6e4)}m ago`:k<864e5?`${Math.floor(k/36e5)}h ago`:t.toLocaleDateString()},de=()=>{L.value=!1,T()};return me(S,a=>{a==="settings"&&n.value.installed&&!I.value&&N()}),fe(()=>{setTimeout(()=>{x.value=!1},100)}),pe(async()=>{await T(),setInterval(T,3e4),setInterval(()=>{n.value.installed&&n.value.status==="active"&&A()},6e4)}),(a,t)=>{const r=g("el-icon"),k=g("el-tag"),E=g("el-button"),ce=g("el-button-group"),ue=g("el-divider"),ve=g("el-card"),y=g("el-tab-pane"),_e=g("el-tabs"),Y=g("el-dialog");return x.value?(i(),v("div",Ke,[e(r,{class:"loading-icon"},{default:o(()=>[e(s(d),{icon:"mdi:loading"})]),_:1}),t[21]||(t[21]=l("span",null,"Loading Docker Dashboard...",-1))])):(i(),v("div",he,[e(ve,{shadow:"never",class:"main-status-card"},{default:o(()=>[l("div",ye,[l("div",{class:J(["status-badge",U.value])},[e(r,{size:"28",class:"docker-icon"},{default:o(()=>[e(s(d),{icon:"mdi:docker"})]),_:1})],2),l("div",De,[l("div",we,[t[8]||(t[8]=l("h3",null,"Docker Engine",-1)),e(k,{type:U.value,size:"small",effect:"dark",round:""},{default:o(()=>[e(r,{size:14},{default:o(()=>[e(s(d),{icon:oe.value},null,8,["icon"])]),_:1}),_(" "+D(se.value),1)]),_:1},8,["type"])]),l("div",Ce,[n.value.version?(i(),v("span",be,[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:tag"})]),_:1}),_(" v"+D(n.value.version),1)])):h("",!0),l("span",Ee,[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:clock-outline"})]),_:1}),_(" "+D(K(M.value)),1)])])]),l("div",Ie,[e(ce,null,{default:o(()=>[n.value.installed?(i(),v(ke,{key:1},[n.value.status!=="active"?(i(),z(E,{key:0,type:"success",onClick:t[1]||(t[1]=m=>P("start")),loading:V.value,size:"small"},{default:o(()=>[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:play"})]),_:1}),t[10]||(t[10]=_(" Start "))]),_:1,__:[10]},8,["loading"])):h("",!0),e(E,{type:"warning",onClick:t[2]||(t[2]=m=>P("restart")),loading:V.value,size:"small"},{default:o(()=>[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:restart"})]),_:1}),t[11]||(t[11]=_(" Restart "))]),_:1,__:[11]},8,["loading"]),e(E,{type:"danger",onClick:t[3]||(t[3]=m=>P("stop")),loading:V.value,size:"small"},{default:o(()=>[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:stop"})]),_:1}),t[12]||(t[12]=_(" Stop "))]),_:1,__:[12]},8,["loading"])],64)):(i(),z(E,{key:0,type:"primary",onClick:t[0]||(t[0]=m=>L.value=!0),plain:"",size:"small"},{icon:o(()=>[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:download"})]),_:1})]),default:o(()=>[t[9]||(t[9]=_(" Install "))]),_:1,__:[9]}))]),_:1})])]),n.value.installed&&n.value.status==="active"?(i(),v("div",Ve,[l("div",Se,[l("h4",null,[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:heart-pulse"})]),_:1}),t[13]||(t[13]=_(" Health Status "))]),e(E,{onClick:A,loading:b.value,size:"small",text:"",circle:""},{default:o(()=>[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:refresh"})]),_:1})]),_:1},8,["loading"])]),b.value?(i(),v("div",Le,[e(r,{class:"is-loading"},{default:o(()=>[e(s(d),{icon:"mdi:loading"})]),_:1}),t[14]||(t[14]=l("span",null,"Checking health...",-1))])):(i(),v("div",Te,[l("div",{class:J(["health-status",c.value.healthy?"healthy":"unhealthy"])},[e(r,{size:24,class:"health-icon"},{default:o(()=>[e(s(d),{icon:c.value.healthy?"mdi:check-circle":"mdi:alert-circle"},null,8,["icon"])]),_:1}),l("div",Fe,[l("div",Re,D(c.value.healthy?"All systems operational":"Issues detected"),1),!c.value.healthy&&c.value.error?(i(),v("div",Ae,D(c.value.error),1)):h("",!0)]),e(k,{type:c.value.healthy?"success":"danger",size:"small"},{default:o(()=>[_(D(c.value.healthy?"HEALTHY":"UNHEALTHY"),1)]),_:1},8,["type"])],2),e(ue),l("div",ze,[l("div",Be,[t[15]||(t[15]=l("div",{class:"stat-label"},"Containers",-1)),l("div",Pe,D(c.value.containersCount||0),1)]),l("div",Ne,[t[16]||(t[16]=l("div",{class:"stat-label"},"Last Check",-1)),l("div",$e,D(K(c.value.timestamp)),1)]),c.value.recovered?(i(),v("div",xe,[t[18]||(t[18]=l("div",{class:"stat-label"},"Recovered",-1)),l("div",Oe,[e(k,{type:"success",size:"small"},{default:o(()=>t[17]||(t[17]=[_("Yes")])),_:1,__:[17]})])])):h("",!0)]),c.value.healthy?h("",!0):(i(),v("div",He,[e(E,{onClick:le,type:"warning",size:"small"},{default:o(()=>[e(r,null,{default:o(()=>[e(s(d),{icon:"mdi:restart"})]),_:1}),t[19]||(t[19]=_(" Restart Docker Service "))]),_:1,__:[19]})]))]))])):h("",!0)]),_:1}),n.value.installed?(i(),v("div",Me,[e(_e,{modelValue:S.value,"onUpdate:modelValue":t[4]||(t[4]=m=>S.value=m),type:"border-card",class:"docker-tabs"},{default:o(()=>[e(y,{label:"Containers",name:"containers"},{default:o(()=>[e(s(j),{onRestartContainer:ne,onShowStats:re})]),_:1}),e(y,{label:"Images",name:"images"},{default:o(()=>[e(s(q))]),_:1}),e(y,{label:"Networks",name:"networks"},{default:o(()=>[e(s(G))]),_:1}),e(y,{label:"Volumes",name:"volumes"},{default:o(()=>[e(s(Q))]),_:1}),e(y,{label:"Compose",name:"compose"},{default:o(()=>[e(s(W))]),_:1}),e(y,{label:"Builder",name:"builder"},{default:o(()=>[e(s(ae))]),_:1}),e(y,{label:"Backup",name:"backup"},{default:o(()=>[e(s(te))]),_:1}),e(y,{label:"Settings",name:"settings"},{default:o(()=>[I.value&&S.value==="settings"?(i(),z(s(ee),{key:B.value,config:I.value,onSave:ie},null,8,["config"])):S.value==="settings"?(i(),v("div",Ue,[e(r,{class:"is-loading"},{default:o(()=>[e(s(d),{icon:"mdi:loading"})]),_:1}),t[20]||(t[20]=_(" Loading Docker settings... "))])):h("",!0)]),_:1})]),_:1},8,["modelValue"])])):h("",!0),e(Y,{modelValue:L.value,"onUpdate:modelValue":t[6]||(t[6]=m=>L.value=m),title:"Install Docker",width:"500px","close-on-click-modal":!1},{default:o(()=>[e(s(X),{onInstalled:de,onClose:t[5]||(t[5]=m=>L.value=!1)})]),_:1},8,["modelValue"]),e(Y,{modelValue:F.value,"onUpdate:modelValue":t[7]||(t[7]=m=>F.value=m),title:"Container Stats",width:"95%",top:"2vh",height:"90vh","destroy-on-close":""},{default:o(()=>[F.value?(i(),z(s(Z),{key:0,"container-id":H.value},null,8,["container-id"])):h("",!0)]),_:1},8,["modelValue"])]))}}};export{je as default};
