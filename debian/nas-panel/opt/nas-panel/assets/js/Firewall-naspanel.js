import{_ as _e,s as le,r as z,o as ye,v as D,x as y,b as u,A as be,d as L,e as _,h as x,w as t,f as r,m as n,F as oe,i as Q,g as e,t as c,k as o,I as i,B as ke,l as we,c as se,n as m,C as Ae}from"./index-naspanel.js";import{u as Fe}from"./useTheme-naspanel.js";const We={class:"docker-ufw-content"},Be={class:"status-section"},Ie={__name:"DockerUfwIntegration",setup(he){const d=le({docker:{installed:!1,running:!1},ufwDocker:{installed:!1}}),U=z([]),P=z([]),W=z(!1),E=z(!1);ye(()=>{B(),G(),j()});const B=async()=>{try{const p=await D.get("/network/docker/status");Object.assign(d,p.data)}catch{y.error("Błąd sprawdzania statusu Dockera")}},J=async()=>{try{E.value=!0;const p=await D.post("/network/docker/install-ufw-docker");p.data.success?(y.success("ufw-docker zainstalowany pomyślnie"),d.ufwDocker.installed=!0):y.error("Błąd instalacji: "+p.data.error)}catch{y.error("Błąd instalacji ufw-docker")}finally{E.value=!1}},G=async()=>{try{W.value=!0;const p=await D.get("/network/docker/containers");p.data.success&&(U.value=p.data.containers)}catch{y.error("Błąd ładowania kontenerów")}finally{W.value=!1}},j=async()=>{try{const p=await D.get("/network/docker/ufw-rules");p.data.success&&(P.value=p.data.rules)}catch(p){console.error("Błąd ładowania reguł UFW",p)}},I=async(p,h)=>{try{const b=await D.post("/network/docker/ufw-rule",{containerName:p,port:h,protocol:"tcp"});b.data.success?(y.success(`Dodano regułę UFW dla ${p}:${h}`),j()):y.error("Błąd: "+b.data.error)}catch{y.error("Błąd dodawania reguły UFW")}},O=async()=>{try{const p=await D.get("/network/docker/debug-rules");console.log("Debug rules:",p.data.results),y.info("Dane debugowania w konsoli")}catch{y.error("Błąd debugowania")}};return(p,h)=>{const b=u("el-alert"),g=u("el-tag"),k=u("el-button"),v=u("el-table-column"),K=u("el-table"),N=u("el-tab-pane"),H=u("el-tabs"),X=be("loading");return _(),L("div",We,[d.docker.installed?d.docker.running?(_(),L(oe,{key:2},[r("div",Be,[e(g,{type:d.ufwDocker.installed?"success":"warning"},{default:t(()=>[n(" ufw-docker: "+c(d.ufwDocker.installed?"Zainstalowany":"Nie zainstalowany"),1)]),_:1},8,["type"]),d.ufwDocker.installed?Q("",!0):(_(),x(k,{key:0,type:"primary",size:"small",onClick:J,loading:E.value},{default:t(()=>[e(o(i),{icon:"mdi:download",width:"16"}),h[2]||(h[2]=n(" Zainstaluj ufw-docker "))]),_:1,__:[2]},8,["loading"]))]),d.ufwDocker.installed?(_(),x(H,{key:0,type:"border-card"},{default:t(()=>[e(N,{label:"Kontenery"},{default:t(()=>[ke((_(),x(K,{data:U.value},{default:t(()=>[e(v,{prop:"name",label:"Nazwa kontenera"}),e(v,{prop:"image",label:"Obraz"}),e(v,{label:"Porty",width:"200"},{default:t(({row:C})=>[(_(!0),L(oe,null,we(C.exposedPorts,A=>(_(),x(g,{key:A,size:"small",class:"port-tag",onClick:Y=>I(C.name,A)},{default:t(()=>[n(c(A)+"/tcp ",1)]),_:2},1032,["onClick"]))),128))]),_:1}),e(v,{label:"Akcje",width:"120"},{default:t(({row:C})=>[(_(!0),L(oe,null,we(C.exposedPorts,A=>(_(),x(k,{key:A,size:"small",onClick:Y=>I(C.name,A)},{default:t(()=>[e(o(i),{icon:"mdi:plus",width:"14"}),n(" "+c(A),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},8,["data"])),[[X,W.value]])]),_:1}),e(N,{label:"Reguły UFW"},{default:t(()=>[e(K,{data:P.value},{default:t(()=>[e(v,{prop:"id",label:"ID",width:"80"}),e(v,{prop:"target",label:"Cel"}),e(v,{prop:"port",label:"Port"}),e(v,{label:"Akcja"},{default:t(({row:C})=>[e(g,{type:C.action==="allow"?"success":"danger"},{default:t(()=>[n(c(C.action),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"comment",label:"Komentarz"})]),_:1},8,["data"])]),_:1}),e(N,{label:"Reguły Docker UFW",name:"docker-rules"},{default:t(()=>[P.value.length===0?(_(),x(b,{key:0,type:"info",title:"Brak reguł Docker UFW","show-icon":""},{default:t(()=>[h[4]||(h[4]=r("p",null,"Nie znaleziono reguł UFW dla Docker. Możesz dodać reguły używając przycisków powyżej.",-1)),e(k,{onClick:O,size:"small"},{default:t(()=>h[3]||(h[3]=[n("Debuguj reguły")])),_:1,__:[3]})]),_:1,__:[4]})):(_(),x(K,{key:1,data:P.value},{default:t(()=>[e(v,{prop:"id",label:"ID",width:"80"}),e(v,{label:"Akcja",width:"100"},{default:t(({row:C})=>[e(g,{type:C.action==="allow"?"success":"danger"},{default:t(()=>[n(c(C.action),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"container",label:"Kontener"}),e(v,{prop:"port",label:"Port",width:"100"}),e(v,{prop:"protocol",label:"Protokół",width:"100"}),e(v,{prop:"comment",label:"Opis"})]),_:1},8,["data"]))]),_:1})]),_:1})):Q("",!0)],64)):(_(),x(b,{key:1,type:"warning",title:"Docker nie jest uruchomiony","show-icon":""},{default:t(()=>h[1]||(h[1]=[r("p",null,[n("Usługa Docker nie jest aktywna. Uruchom: "),r("code",null,"sudo systemctl start docker")],-1)])),_:1,__:[1]})):(_(),x(b,{key:0,type:"warning",title:"Docker nie jest zainstalowany","show-icon":""},{default:t(()=>h[0]||(h[0]=[r("p",null,"Aby korzystać z integracji Docker-UFW, musisz zainstalować Dockera.",-1)])),_:1,__:[0]}))])}}},Ee=_e(Ie,[["__scopeId","data-v-c680bb3a"]]),Oe={class:"widget-header"},Ne={class:"header-left"},$e={class:"header-icon"},Se={class:"header-right"},Ze={class:"firewall-status"},Me={class:"firewall-content"},Le={class:"tab-label"},Je={class:"rules-container"},Ke={class:"rules-toolbar"},qe={class:"action-buttons"},Qe={class:"port-value"},Ge={class:"address-value"},He={class:"address-value"},Xe={class:"comment-text"},Ye={key:0,class:"table-footer"},el={class:"result-count"},ll={key:0,class:"filter-info"},tl={class:"tab-label"},al={class:"tab-content"},ol={class:"tab-label"},sl={class:"tab-content"},nl={class:"tab-label"},il={class:"tab-content"},rl={class:"stat-card-header"},dl={class:"stat-card-header"},ul={class:"tab-label"},cl={class:"tab-content"},pl={class:"dialog-header"},ml={class:"dialog-footer"},fl={class:"dialog-header"},gl={class:"dialog-footer"},wl={__name:"Firewall",setup(he){const{isDarkMode:d}=Fe(),U=z(!1),P=z([]),W=z(!1),E=z(!1),B=z(!1),J=z(null),G=z("all"),j=z(""),I=z(!1),O=z(!1),p=z(null),h=z(null),b=le({name:"",protocol:"tcp",port:80,source:"any",action:"allow"}),g=le({chain:"INPUT",protocol:"tcp",dport:80,source:"",destination:"",target:"ACCEPT",comment:""}),k=le({totalRules:0,ufwRules:0,iptablesRules:0,blockedConnections:0,allowedConnections:0,lastActivity:""}),v={name:[{required:!0,message:"Nazwa reguły jest wymagana",trigger:"blur"}],protocol:[{required:!0,message:"Wybierz protokół",trigger:"change"}]},K={chain:[{required:!0,message:"Wybierz łańcuch",trigger:"change"}],target:[{required:!0,message:"Wybierz akcję",trigger:"change"}]},N=se(()=>{if(!j.value)return P.value;const s=j.value.toLowerCase();return P.value.filter(l=>(l.protocol||"").toLowerCase().includes(s)||(l.port||"").toString().includes(s)||(l.source||"").toLowerCase().includes(s)||(l.target||"").toLowerCase().includes(s)||(l.comment||"").toLowerCase().includes(s))}),H=se(()=>P.value.filter(s=>s.source==="ufw")),X=se(()=>P.value.filter(s=>s.source==="iptables")),C=s=>["allow","ACCEPT"].includes(s)?"success":["deny","DROP","REJECT"].includes(s)?"danger":"info",A=s=>["allow","ACCEPT"].includes(s)?"mdi:check-circle":["deny","DROP","REJECT"].includes(s)?"mdi:block-helper":"mdi:information",Y=s=>({allow:"Zezwól",ACCEPT:"Zezwól",deny:"Blokuj",DROP:"Odrzuć",REJECT:"Odrzuć"})[s]||s;ye(()=>{ve(),$(),ze()});const ve=async()=>{try{const s=await D.get("/network/firewall/status");U.value=s.data.enabled}catch(s){y.error("Błąd pobierania statusu zapory: "+s.message)}},$=async()=>{try{W.value=!0;const s=await D.get("/network/firewall/rules");let l=[],S=[],w={total:0,ufw:0,iptables:0};s.data.success?(s.data.data&&s.data.data.ufw?l=Array.isArray(s.data.data.ufw)?s.data.data.ufw.map(T=>({...T,source:"ufw"})):[]:Array.isArray(s.data.data)&&(l=s.data.data.map(T=>({...T,source:"ufw"}))),s.data.data&&s.data.data.iptables&&(S=Array.isArray(s.data.data.iptables)?s.data.data.iptables.map(T=>({...T,source:"iptables"})):[]),s.data.counts?w=s.data.counts:w={total:l.length+S.length,ufw:l.length,iptables:S.length}):Array.isArray(s.data)&&(l=s.data.map(T=>({...T,source:"ufw"})),w={total:l.length,ufw:l.length,iptables:0}),P.value=[...l,...S],k.totalRules=w.total,k.ufwRules=w.ufw,k.iptablesRules=w.iptables}catch(s){console.error("Błąd pobierania reguł:",s),y.error("Błąd pobierania reguł zapory: "+s.message),P.value=[],k.totalRules=0,k.ufwRules=0,k.iptablesRules=0}finally{W.value=!1}},ze=async()=>{try{const s=await D.get("/network/firewall/stats");Object.assign(k,s.data)}catch(s){console.error("Błąd pobierania statystyk:",s)}},xe=async()=>{try{E.value=!0;const s=U.value?"enable":"disable";await D.post(`/network/firewall/status/${s}`),y.success(`Zapora ${U.value?"włączona":"wyłączona"}`),$()}catch(s){U.value=!U.value,y.error(`Błąd podczas zmiany stanu zapory: ${s.message}`)}finally{E.value=!1}},ne=s=>{s==="ufw"?(ie(),I.value=!0):(re(),O.value=!0)},Ce=async()=>{try{B.value=!0,await p.value?.validate();const s=await D.post("/network/firewall/rules",b);y.success("Reguła UFW dodana pomyślnie"),I.value=!1,ie(),$()}catch(s){s.response?.data?.error?y.error("Błąd: "+s.response.data.error):s!=="cancel"&&y.error("Błąd dodawania reguły UFW: "+s.message)}finally{B.value=!1}},Re=async()=>{try{B.value=!0,await h.value?.validate();const s=await D.post("/network/iptables/rules",g);y.success("Reguła iptables dodana pomyślnie"),O.value=!1,re(),$()}catch(s){s.response?.data?.error?y.error("Błąd: "+s.response.data.error):s!=="cancel"&&y.error("Błąd dodawania reguły iptables: "+s.message)}finally{B.value=!1}},De=async s=>{try{await Ae.confirm("Czy na pewno chcesz usunąć tę regułę?","Potwierdzenie usunięcia",{type:"warning",confirmButtonText:"Usuń",cancelButtonText:"Anuluj"}),J.value=s.id||s.num,s.source==="ufw"?await D.delete(`/network/firewall/rules/${s.id}`):await D.delete(`/network/iptables/rules/${s.chain}/${s.num}`),y.success("Reguła usunięta pomyślnie"),$()}catch(l){l!=="cancel"&&y.error("Błąd usuwania reguły: "+l.message)}finally{J.value=null}},ie=()=>{Object.assign(b,{name:"",protocol:"tcp",port:80,source:"any",action:"allow"}),p.value?.clearValidate()},re=()=>{Object.assign(g,{chain:"INPUT",protocol:"tcp",dport:80,source:"",destination:"",target:"ACCEPT",comment:""}),h.value?.clearValidate()};return(s,l)=>{const S=u("el-switch"),w=u("el-tag"),T=u("el-badge"),Z=u("el-input"),F=u("el-button"),f=u("el-table-column"),Ue=u("el-icon"),te=u("el-table"),q=u("el-tab-pane"),de=u("el-alert"),M=u("el-descriptions-item"),ue=u("el-descriptions"),ae=u("el-card"),ce=u("el-col"),Ve=u("el-row"),Pe=u("el-tabs"),V=u("el-form-item"),R=u("el-option"),ee=u("el-select"),pe=u("el-input-number"),me=u("el-radio-button"),je=u("el-radio-group"),fe=u("el-form"),ge=u("el-dialog"),Te=be("loading");return _(),x(ae,{class:m(["firewall-widget modern-card",{"dark-mode":o(d)}]),shadow:"hover"},{header:t(()=>[r("div",Oe,[r("div",Ne,[r("div",$e,[e(o(i),{icon:"mdi:firewall"})]),l[22]||(l[22]=r("div",{class:"header-text"},[r("h1",null,"Zapora sieciowa"),r("p",{class:"subtitle"},"Zarządzaj regułami firewall UFW i iptables")],-1))]),r("div",Se,[r("div",Ze,[e(S,{modelValue:U.value,"onUpdate:modelValue":l[0]||(l[0]=a=>U.value=a),class:"firewall-switch","active-text":"Wł.","inactive-text":"Wył.",onChange:xe,loading:E.value},null,8,["modelValue","loading"]),e(w,{type:U.value?"success":"danger",class:"status-tag",effect:"dark"},{default:t(()=>[e(o(i),{icon:U.value?"mdi:shield-check":"mdi:shield-off",width:"14",style:{"margin-right":"4px"}},null,8,["icon"]),n(" "+c(U.value?"Aktywna":"Nieaktywna"),1)]),_:1},8,["type"])])])])]),default:t(()=>[r("div",Me,[e(Pe,{modelValue:G.value,"onUpdate:modelValue":l[5]||(l[5]=a=>G.value=a),type:"card",class:m(["modern-tabs",{"dark-mode":o(d)}])},{default:t(()=>[e(q,{name:"all"},{label:t(()=>[r("span",Le,[e(o(i),{icon:"mdi:format-list-bulleted"}),l[23]||(l[23]=n(" Wszystkie reguły ")),e(T,{value:k.totalRules,max:99,class:"tab-badge"},null,8,["value"])])]),default:t(()=>[r("div",Je,[r("div",Ke,[e(Z,{modelValue:j.value,"onUpdate:modelValue":l[1]||(l[1]=a=>j.value=a),placeholder:"Szukaj reguł...",clearable:"",size:"large",class:m(["search-input",{"dark-mode":o(d)}])},{prefix:t(()=>[e(o(i),{icon:"mdi:magnify"})]),_:1},8,["modelValue","class"]),r("div",qe,[e(F,{type:"primary",size:"large",onClick:l[2]||(l[2]=a=>ne("ufw")),class:"add-button"},{default:t(()=>[e(o(i),{icon:"mdi:plus"}),l[24]||(l[24]=n(" Dodaj UFW "))]),_:1,__:[24]}),e(F,{type:"warning",size:"large",onClick:l[3]||(l[3]=a=>ne("iptables")),class:"add-button"},{default:t(()=>[e(o(i),{icon:"mdi:plus"}),l[25]||(l[25]=n(" Dodaj iptables "))]),_:1,__:[25]}),e(F,{type:"info",size:"large",onClick:$,loading:W.value},{default:t(()=>[e(o(i),{icon:"mdi:refresh"}),l[26]||(l[26]=n(" Odśwież "))]),_:1,__:[26]},8,["loading"])])]),ke((_(),x(te,{data:N.value,style:{width:"100%"},"empty-text":j.value?"Brak wyników wyszukiwania":"Brak reguł zapory",class:m(["rules-table",{"dark-mode":o(d)}]),stripe:"",height:"400"},{default:t(()=>[e(f,{label:"Typ",width:"90",fixed:"left"},{default:t(({row:a})=>[e(w,{type:a.source==="ufw"?"primary":"warning",class:"source-tag",size:"small",effect:"dark"},{default:t(()=>[e(o(i),{icon:a.source==="ufw"?"mdi:shield-check":"mdi:network",width:"12",style:{"margin-right":"4px"}},null,8,["icon"]),n(" "+c(a.source?a.source.toUpperCase():"?"),1)]),_:2},1032,["type"])]),_:1}),e(f,{label:"Protokół",width:"100"},{default:t(({row:a})=>[e(w,{class:"protocol-tag",size:"small"},{default:t(()=>[a.protocol==="tcp"||a.protocol==="udp"?(_(),x(o(i),{key:0,icon:a.protocol==="tcp"?"mdi:lan":"mdi:cast",width:"12",style:{"margin-right":"4px"}},null,8,["icon"])):Q("",!0),n(" "+c(a.protocol||"all"),1)]),_:2},1024)]),_:1}),e(f,{label:"Port",width:"90"},{default:t(({row:a})=>[r("span",Qe,[e(o(i),{icon:"mdi:ethernet-port",width:"14",style:{"margin-right":"4px"}}),n(" "+c(a.port||"any"),1)])]),_:1}),e(f,{label:"Źródło","min-width":"120"},{default:t(({row:a})=>[r("span",Ge,[e(o(i),{icon:"mdi:arrow-right-bold",width:"12",style:{"margin-right":"4px"}}),n(" "+c(a.source_ip||a.source||"any"),1)])]),_:1}),e(f,{label:"Cel","min-width":"120"},{default:t(({row:a})=>[r("span",He,[e(o(i),{icon:"mdi:target",width:"12",style:{"margin-right":"4px"}}),n(" "+c(a.destination||a.target||"any"),1)])]),_:1}),e(f,{label:"Akcja",width:"100"},{default:t(({row:a})=>[e(w,{type:C(a.target||a.action),class:"action-tag",size:"small",effect:"dark"},{default:t(()=>[e(o(i),{icon:A(a.target||a.action),width:"12",style:{"margin-right":"4px"}},null,8,["icon"]),n(" "+c(Y(a.target||a.action)),1)]),_:2},1032,["type"])]),_:1}),e(f,{label:"Komentarz","min-width":"150","show-overflow-tooltip":""},{default:t(({row:a})=>[r("span",Xe,[e(o(i),{icon:"mdi:message-text",width:"12",style:{"margin-right":"4px",opacity:"0.7"}}),n(" "+c(a.comment||"—"),1)])]),_:1}),e(f,{label:"Operacje",width:"80",fixed:"right"},{default:t(({row:a})=>[e(F,{type:"danger",size:"small",circle:"",onClick:_l=>De(a),disabled:!a.source,class:"delete-button",loading:J.value===(a.id||a.num)},{default:t(()=>[e(Ue,null,{default:t(()=>[e(o(i),{icon:"mdi:delete"})]),_:1})]),_:2},1032,["onClick","disabled","loading"])]),_:1})]),_:1},8,["data","empty-text","class"])),[[Te,W.value]]),N.value.length>0?(_(),L("div",Ye,[r("span",el,[e(o(i),{icon:"mdi:information",width:"14",style:{"margin-right":"6px"}}),n(" Znaleziono "+c(N.value.length)+" reguł ",1)]),j.value?(_(),L("div",ll,[e(w,{size:"small"},{default:t(()=>[e(o(i),{icon:"mdi:filter",width:"12",style:{"margin-right":"4px"}}),n(' Filtrowanie: "'+c(j.value)+'" ',1)]),_:1}),e(F,{link:"",onClick:l[4]||(l[4]=a=>j.value="")},{default:t(()=>[e(o(i),{icon:"mdi:close-circle",width:"14",style:{"margin-right":"4px"}}),l[27]||(l[27]=n(" Wyczyść "))]),_:1,__:[27]})])):Q("",!0)])):Q("",!0)])]),_:1}),e(q,{name:"ufw"},{label:t(()=>[r("span",tl,[e(o(i),{icon:"mdi:shield-check"}),l[28]||(l[28]=n(" Tylko UFW ")),e(T,{value:k.ufwRules,max:99,class:"tab-badge"},null,8,["value"])])]),default:t(()=>[r("div",al,[H.value.length===0?(_(),x(de,{key:0,type:"info",title:"Brak reguł UFW","show-icon":"",closable:!1},{icon:t(()=>[e(o(i),{icon:"mdi:information"})]),default:t(()=>[l[29]||(l[29]=r("p",null,"Nie znaleziono reguł zapory UFW. Dodaj pierwszą regułę korzystając z przycisku powyżej.",-1))]),_:1,__:[29]})):(_(),x(te,{key:1,data:H.value,style:{width:"100%"},stripe:"",height:"400",class:m({"dark-mode":o(d)})},{default:t(()=>[e(f,{label:"Typ",width:"100"},{default:t(({row:a})=>[e(w,{type:"primary",effect:"dark"},{default:t(()=>[e(o(i),{icon:"mdi:shield-check",width:"12",style:{"margin-right":"4px"}}),l[30]||(l[30]=n(" UFW "))]),_:1,__:[30]})]),_:1}),e(f,{prop:"id",label:"ID",width:"80"}),e(f,{label:"Protokół",width:"120"},{default:t(({row:a})=>[e(w,null,{default:t(()=>[n(c(a.protocol||"all"),1)]),_:2},1024)]),_:1}),e(f,{prop:"port",label:"Port",width:"120"}),e(f,{prop:"target",label:"Cel"}),e(f,{label:"Akcja",width:"120"},{default:t(({row:a})=>[e(w,{type:C(a.action),effect:"dark"},{default:t(()=>[n(c(Y(a.action)),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"comment",label:"Komentarz"})]),_:1},8,["data","class"]))])]),_:1}),e(q,{name:"iptables"},{label:t(()=>[r("span",ol,[e(o(i),{icon:"mdi:network"}),l[31]||(l[31]=n(" Tylko iptables ")),e(T,{value:k.iptablesRules,max:99,class:"tab-badge"},null,8,["value"])])]),default:t(()=>[r("div",sl,[X.value.length===0?(_(),x(de,{key:0,type:"info",title:"Brak reguł iptables","show-icon":"",closable:!1},{icon:t(()=>[e(o(i),{icon:"mdi:information"})]),default:t(()=>[l[32]||(l[32]=r("p",null,"Nie znaleziono reguł iptables. Dodaj pierwszą regułę korzystając z przycisku powyżej.",-1))]),_:1,__:[32]})):(_(),x(te,{key:1,data:X.value,style:{width:"100%"},stripe:"",height:"400",class:m({"dark-mode":o(d)})},{default:t(()=>[e(f,{label:"Typ",width:"100"},{default:t(({row:a})=>[e(w,{type:"warning",effect:"dark"},{default:t(()=>[e(o(i),{icon:"mdi:network",width:"12",style:{"margin-right":"4px"}}),l[33]||(l[33]=n(" IPTABLES "))]),_:1,__:[33]})]),_:1}),e(f,{prop:"chain",label:"Łańcuch",width:"100"}),e(f,{prop:"num",label:"Nr",width:"60"}),e(f,{label:"Protokół",width:"100"},{default:t(({row:a})=>[n(c(a.protocol||"all"),1)]),_:1}),e(f,{label:"Źródło"},{default:t(({row:a})=>[n(c(a.source||"any"),1)]),_:1}),e(f,{label:"Cel"},{default:t(({row:a})=>[n(c(a.destination||"any"),1)]),_:1}),e(f,{label:"Akcja",width:"100"},{default:t(({row:a})=>[e(w,{type:C(a.target),effect:"dark"},{default:t(()=>[n(c(a.target),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"options",label:"Opcje","show-overflow-tooltip":""})]),_:1},8,["data","class"]))])]),_:1}),e(q,{name:"stats"},{label:t(()=>[r("span",nl,[e(o(i),{icon:"mdi:chart-box"}),l[34]||(l[34]=n(" Statystyki "))])]),default:t(()=>[r("div",il,[e(Ve,{gutter:20},{default:t(()=>[e(ce,{span:12},{default:t(()=>[e(ae,{shadow:"never",class:m(["stat-card",{"dark-mode":o(d)}])},{header:t(()=>[r("div",rl,[e(o(i),{icon:"mdi:chart-pie"}),l[35]||(l[35]=r("span",null,"Podsumowanie reguł",-1))])]),default:t(()=>[e(ue,{column:1,border:""},{default:t(()=>[e(M,{label:"Wszystkie reguły"},{default:t(()=>[e(w,{type:"info",effect:"dark"},{default:t(()=>[e(o(i),{icon:"mdi:format-list-bulleted",width:"12",style:{"margin-right":"4px"}}),n(" "+c(k.totalRules||0),1)]),_:1})]),_:1}),e(M,{label:"Reguły UFW"},{default:t(()=>[e(w,{type:"primary",effect:"dark"},{default:t(()=>[e(o(i),{icon:"mdi:shield-check",width:"12",style:{"margin-right":"4px"}}),n(" "+c(k.ufwRules||0),1)]),_:1})]),_:1}),e(M,{label:"Reguły iptables"},{default:t(()=>[e(w,{type:"warning",effect:"dark"},{default:t(()=>[e(o(i),{icon:"mdi:network",width:"12",style:{"margin-right":"4px"}}),n(" "+c(k.iptablesRules||0),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])]),_:1}),e(ce,{span:12},{default:t(()=>[e(ae,{shadow:"never",class:m(["stat-card",{"dark-mode":o(d)}])},{header:t(()=>[r("div",dl,[e(o(i),{icon:"mdi:connection"}),l[36]||(l[36]=r("span",null,"Statystyki połączeń",-1))])]),default:t(()=>[e(ue,{column:1,border:""},{default:t(()=>[e(M,{label:"Zablokowane połączenia"},{default:t(()=>[e(w,{type:"danger",effect:"dark"},{default:t(()=>[e(o(i),{icon:"mdi:block-helper",width:"12",style:{"margin-right":"4px"}}),n(" "+c(k.blockedConnections||0),1)]),_:1})]),_:1}),e(M,{label:"Dozwolone połączenia"},{default:t(()=>[e(w,{type:"success",effect:"dark"},{default:t(()=>[e(o(i),{icon:"mdi:check-circle",width:"12",style:{"margin-right":"4px"}}),n(" "+c(k.allowedConnections||0),1)]),_:1})]),_:1}),e(M,{label:"Ostatnia aktywność"},{default:t(()=>[e(o(i),{icon:"mdi:clock-outline",width:"14",style:{"margin-right":"6px",opacity:"0.7"}}),n(" "+c(k.lastActivity||"Brak danych"),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})]),_:1})])]),_:1}),e(q,{name:"docker"},{label:t(()=>[r("span",ul,[e(o(i),{icon:"mdi:docker"}),l[37]||(l[37]=n(" Docker & UFW "))])]),default:t(()=>[r("div",cl,[e(Ee)])]),_:1})]),_:1},8,["modelValue","class"])]),e(ge,{modelValue:I.value,"onUpdate:modelValue":l[12]||(l[12]=a=>I.value=a),title:"Dodaj nową regułę UFW",width:"500px","close-on-click-modal":!1,class:m({"dark-mode":o(d)})},{header:t(()=>[r("div",pl,[e(o(i),{icon:"mdi:shield-plus",width:"24",style:{"margin-right":"12px"}}),l[38]||(l[38]=r("span",null,"Dodaj nową regułę UFW",-1))])]),footer:t(()=>[r("div",ml,[e(F,{onClick:l[11]||(l[11]=a=>I.value=!1),class:m({"dark-mode":o(d)})},{default:t(()=>[e(o(i),{icon:"mdi:close-circle",width:"16",style:{"margin-right":"4px"}}),l[45]||(l[45]=n(" Anuluj "))]),_:1,__:[45]},8,["class"]),e(F,{type:"primary",onClick:Ce,loading:B.value,class:m({"dark-mode":o(d)})},{default:t(()=>[e(o(i),{icon:"mdi:check",width:"16",style:{"margin-right":"4px"}}),l[46]||(l[46]=n(" Dodaj regułę "))]),_:1,__:[46]},8,["loading","class"])])]),default:t(()=>[e(fe,{model:b,rules:v,ref_key:"ufwRuleForm",ref:p,"label-width":"140px"},{default:t(()=>[e(V,{label:"Nazwa reguły",prop:"name"},{default:t(()=>[e(Z,{modelValue:b.name,"onUpdate:modelValue":l[6]||(l[6]=a=>b.name=a),placeholder:"Nazwa identyfikująca regułę",class:m({"dark-mode":o(d)})},null,8,["modelValue","class"])]),_:1}),e(V,{label:"Protokół",prop:"protocol"},{default:t(()=>[e(ee,{modelValue:b.protocol,"onUpdate:modelValue":l[7]||(l[7]=a=>b.protocol=a),placeholder:"Wybierz protokół",class:m({"dark-mode":o(d)})},{default:t(()=>[e(R,{label:"TCP",value:"tcp"},{default:t(()=>[e(o(i),{icon:"mdi:lan",width:"16",style:{"margin-right":"8px"}}),l[39]||(l[39]=n(" TCP "))]),_:1,__:[39]}),e(R,{label:"UDP",value:"udp"},{default:t(()=>[e(o(i),{icon:"mdi:cast",width:"16",style:{"margin-right":"8px"}}),l[40]||(l[40]=n(" UDP "))]),_:1,__:[40]}),e(R,{label:"ICMP",value:"icmp"},{default:t(()=>[e(o(i),{icon:"mdi:satellite-uplink",width:"16",style:{"margin-right":"8px"}}),l[41]||(l[41]=n(" ICMP "))]),_:1,__:[41]}),e(R,{label:"Wszystkie",value:"all"},{default:t(()=>[e(o(i),{icon:"mdi:all-inclusive",width:"16",style:{"margin-right":"8px"}}),l[42]||(l[42]=n(" Wszystkie "))]),_:1,__:[42]})]),_:1},8,["modelValue","class"])]),_:1}),e(V,{label:"Port",prop:"port"},{default:t(()=>[e(pe,{modelValue:b.port,"onUpdate:modelValue":l[8]||(l[8]=a=>b.port=a),min:1,max:65535,"controls-position":"right",placeholder:"Numer portu",class:m({"dark-mode":o(d)})},null,8,["modelValue","class"])]),_:1}),e(V,{label:"Źródło (IP/CIDR)",prop:"source"},{default:t(()=>[e(Z,{modelValue:b.source,"onUpdate:modelValue":l[9]||(l[9]=a=>b.source=a),placeholder:"np. 192.168.1.0/24 lub any",class:m({"dark-mode":o(d)})},null,8,["modelValue","class"])]),_:1}),e(V,{label:"Akcja",prop:"action"},{default:t(()=>[e(je,{modelValue:b.action,"onUpdate:modelValue":l[10]||(l[10]=a=>b.action=a)},{default:t(()=>[e(me,{value:"allow"},{default:t(()=>[e(o(i),{icon:"mdi:check-circle",width:"16",style:{"margin-right":"4px"}}),l[43]||(l[43]=n(" Zezwól "))]),_:1,__:[43]}),e(me,{value:"deny"},{default:t(()=>[e(o(i),{icon:"mdi:block-helper",width:"16",style:{"margin-right":"4px"}}),l[44]||(l[44]=n(" Blokuj "))]),_:1,__:[44]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","class"]),e(ge,{modelValue:O.value,"onUpdate:modelValue":l[21]||(l[21]=a=>O.value=a),title:"Dodaj nową regułę iptables",width:"600px","close-on-click-modal":!1,class:m({"dark-mode":o(d)})},{header:t(()=>[r("div",fl,[e(o(i),{icon:"mdi:network-plus",width:"24",style:{"margin-right":"12px"}}),l[47]||(l[47]=r("span",null,"Dodaj nową regułę iptables",-1))])]),footer:t(()=>[r("div",gl,[e(F,{onClick:l[20]||(l[20]=a=>O.value=!1),class:m({"dark-mode":o(d)})},{default:t(()=>[e(o(i),{icon:"mdi:close-circle",width:"16",style:{"margin-right":"4px"}}),l[58]||(l[58]=n(" Anuluj "))]),_:1,__:[58]},8,["class"]),e(F,{type:"primary",onClick:Re,loading:B.value,class:m({"dark-mode":o(d)})},{default:t(()=>[e(o(i),{icon:"mdi:check",width:"16",style:{"margin-right":"4px"}}),l[59]||(l[59]=n(" Dodaj regułę "))]),_:1,__:[59]},8,["loading","class"])])]),default:t(()=>[e(fe,{model:g,rules:K,ref_key:"iptablesRuleForm",ref:h,"label-width":"140px"},{default:t(()=>[e(V,{label:"Łańcuch",prop:"chain"},{default:t(()=>[e(ee,{modelValue:g.chain,"onUpdate:modelValue":l[13]||(l[13]=a=>g.chain=a),placeholder:"Wybierz łańcuch",class:m({"dark-mode":o(d)})},{default:t(()=>[e(R,{label:"INPUT",value:"INPUT"},{default:t(()=>[e(o(i),{icon:"mdi:arrow-right-bold",width:"16",style:{"margin-right":"8px"}}),l[48]||(l[48]=n(" INPUT "))]),_:1,__:[48]}),e(R,{label:"OUTPUT",value:"OUTPUT"},{default:t(()=>[e(o(i),{icon:"mdi:arrow-left-bold",width:"16",style:{"margin-right":"8px"}}),l[49]||(l[49]=n(" OUTPUT "))]),_:1,__:[49]}),e(R,{label:"FORWARD",value:"FORWARD"},{default:t(()=>[e(o(i),{icon:"mdi:swap-horizontal",width:"16",style:{"margin-right":"8px"}}),l[50]||(l[50]=n(" FORWARD "))]),_:1,__:[50]})]),_:1},8,["modelValue","class"])]),_:1}),e(V,{label:"Protokół",prop:"protocol"},{default:t(()=>[e(ee,{modelValue:g.protocol,"onUpdate:modelValue":l[14]||(l[14]=a=>g.protocol=a),placeholder:"Wybierz protokół",class:m({"dark-mode":o(d)})},{default:t(()=>[e(R,{label:"TCP",value:"tcp"},{default:t(()=>[e(o(i),{icon:"mdi:lan",width:"16",style:{"margin-right":"8px"}}),l[51]||(l[51]=n(" TCP "))]),_:1,__:[51]}),e(R,{label:"UDP",value:"udp"},{default:t(()=>[e(o(i),{icon:"mdi:cast",width:"16",style:{"margin-right":"8px"}}),l[52]||(l[52]=n(" UDP "))]),_:1,__:[52]}),e(R,{label:"ICMP",value:"icmp"},{default:t(()=>[e(o(i),{icon:"mdi:satellite-uplink",width:"16",style:{"margin-right":"8px"}}),l[53]||(l[53]=n(" ICMP "))]),_:1,__:[53]}),e(R,{label:"Wszystkie",value:"all"},{default:t(()=>[e(o(i),{icon:"mdi:all-inclusive",width:"16",style:{"margin-right":"8px"}}),l[54]||(l[54]=n(" Wszystkie "))]),_:1,__:[54]})]),_:1},8,["modelValue","class"])]),_:1}),e(V,{label:"Port docelowy",prop:"dport"},{default:t(()=>[e(pe,{modelValue:g.dport,"onUpdate:modelValue":l[15]||(l[15]=a=>g.dport=a),min:1,max:65535,"controls-position":"right",placeholder:"Numer portu",class:m({"dark-mode":o(d)})},null,8,["modelValue","class"])]),_:1}),e(V,{label:"Źródło (IP/CIDR)",prop:"source"},{default:t(()=>[e(Z,{modelValue:g.source,"onUpdate:modelValue":l[16]||(l[16]=a=>g.source=a),placeholder:"np. 192.168.1.0/24",class:m({"dark-mode":o(d)})},null,8,["modelValue","class"])]),_:1}),e(V,{label:"Cel (IP/CIDR)",prop:"destination"},{default:t(()=>[e(Z,{modelValue:g.destination,"onUpdate:modelValue":l[17]||(l[17]=a=>g.destination=a),placeholder:"np. 192.168.1.10",class:m({"dark-mode":o(d)})},null,8,["modelValue","class"])]),_:1}),e(V,{label:"Akcja",prop:"target"},{default:t(()=>[e(ee,{modelValue:g.target,"onUpdate:modelValue":l[18]||(l[18]=a=>g.target=a),placeholder:"Wybierz akcję",class:m({"dark-mode":o(d)})},{default:t(()=>[e(R,{label:"ACCEPT",value:"ACCEPT"},{default:t(()=>[e(o(i),{icon:"mdi:check-circle",width:"16",style:{"margin-right":"8px"}}),l[55]||(l[55]=n(" ACCEPT "))]),_:1,__:[55]}),e(R,{label:"DROP",value:"DROP"},{default:t(()=>[e(o(i),{icon:"mdi:block-helper",width:"16",style:{"margin-right":"8px"}}),l[56]||(l[56]=n(" DROP "))]),_:1,__:[56]}),e(R,{label:"REJECT",value:"REJECT"},{default:t(()=>[e(o(i),{icon:"mdi:cancel",width:"16",style:{"margin-right":"8px"}}),l[57]||(l[57]=n(" REJECT "))]),_:1,__:[57]})]),_:1},8,["modelValue","class"])]),_:1}),e(V,{label:"Komentarz",prop:"comment"},{default:t(()=>[e(Z,{modelValue:g.comment,"onUpdate:modelValue":l[19]||(l[19]=a=>g.comment=a),placeholder:"Opis reguły",type:"textarea",rows:2,class:m({"dark-mode":o(d)})},null,8,["modelValue","class"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","class"])]),_:1},8,["class"])}}},kl=_e(wl,[["__scopeId","data-v-1ba64f1a"]]);export{kl as default};
