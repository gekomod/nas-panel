import{_ as ze,x as Ve,r as c,y as j,k as $e,c as R,o as A,h as u,a as s,w as t,b as r,l as p,I as _,g as d,t as v,e as ae,F as Se,q as k,E as f,s as I}from"./index-DxMqavst.js";const Ce={webdav:{title:"WebDAV",status:"Status",running:"Running",stopped:"Stopped",version:"Version",port:"Port",protocol:"Protocol",disk_name:"Disk name",mount_point:"Mount point",size:"Size",fs_type:"Filesystem type",yes:"Yes",no:"No",status_running:"WebDAV service is running",status_stopped:"WebDAV service is stopped",stop_service:"Stop service",start_service:"Start service",restart_service:"Restart service",basic_config:"Basic configuration",enable_service:"Enable WebDAV service",nfs_versions:"NFS versions",disk_selection:"Disk selection",advanced_settings:"Advanced settings",allow_anonymous:"Allow anonymous access",read_only:"Read only",max_connections:"Maximum connections",save_config:"Save configuration",reset:"Reset",connection_info:"Connection information",server_address:"Server address",connection_url:"Connection URL",success:"Success",error:"Error",status_fetch_error:"Error fetching service status",disks_fetch_error:"Error fetching disks list",config_fetch_error:"Error fetching configuration",config_saved:"Configuration saved successfully",config_save_error:"Error saving configuration",service_started:"Service started successfully",service_stopped:"Service stopped successfully",service_toggle_error:"Error toggling service status",service_restarted:"Service restarted successfully",service_restart_error:"Error restarting service",copied_to_clipboard:"Copied to clipboard",select_directory:"Select directory",actions:"Actions",cancel:"Cancel",confirm:"Confirm",shared:"Shared",no_disks_found:"No disks available",disk_fetch_error:"Error fetching disks list",directories_added:"Selected directories have been added",no_directories_selected:"No directories selected",browse:"Browse",toggle_disk_share:"Toggle disk sharing"}},De={webdav:{title:"WebDAV",status:"Status",running:"Działa",stopped:"Zatrzymany",version:"Wersja",port:"Port",protocol:"Protokół",disk_name:"Nazwa dysku",mount_point:"Punkt montowania",size:"Rozmiar",fs_type:"Typ systemu plików",yes:"Tak",no:"Nie",status_running:"Usługa WebDAV jest uruchomiona",status_stopped:"Usługa WebDAV jest zatrzymana",stop_service:"Zatrzymaj usługę",start_service:"Uruchom usługę",restart_service:"Zrestartuj usługę",basic_config:"Podstawowa konfiguracja",enable_service:"Włącz usługę WebDAV",nfs_versions:"Wersje NFS",disk_selection:"Wybór dysków",advanced_settings:"Zaawansowane ustawienia",allow_anonymous:"Zezwalaj na dostęp anonimowy",read_only:"Tylko do odczytu",max_connections:"Maksymalna liczba połączeń",save_config:"Zapisz konfigurację",reset:"Resetuj",connection_info:"Informacje o połączeniu",server_address:"Adres serwera",connection_url:"URL połączenia",success:"Sukces",error:"Błąd",status_fetch_error:"Błąd podczas pobierania statusu usługi",disks_fetch_error:"Błąd podczas pobierania listy dysków",config_fetch_error:"Błąd podczas pobierania konfiguracji",config_saved:"Konfiguracja zapisana pomyślnie",config_save_error:"Błąd podczas zapisywania konfiguracji",service_started:"Usługa uruchomiona pomyślnie",service_stopped:"Usługa zatrzymana pomyślnie",service_toggle_error:"Błąd podczas zmiany statusu usługi",service_restarted:"Usługa zrestartowana pomyślnie",service_restart_error:"Błąd podczas restartowania usługi",copied_to_clipboard:"Skopiowano do schowka",select_directory:"Wybierz katalog",actions:"Akcje",cancel:"Anuluj",confirm:"Potwierdź",shared:"Udostępniony",no_disks_found:"Brak dostępnych dysków",disk_fetch_error:"Błąd podczas pobierania listy dysków",directories_added:"Wybrane katalogi zostały dodane",no_directories_selected:"Nie wybrano żadnych katalogów",browse:"Przeglądaj",toggle_disk_share:"Przełącz udostępnianie dysku"}},Be={class:"webdav-container"},Ue={class:"card-header"},Ae={key:0,class:"loading-spinner"},Ne={key:1,class:"status-content"},Ee={class:"action-buttons"},We={class:"config-section"},je={class:"config-section"},Te={class:"nfs-versions"},Le={class:"disk-list"},Pe={class:"advanced-settings"},Fe={class:"config-actions"},Me={class:"card-header"},Re={class:"connection-info"},Ie={class:"custom-tree-node"},Ze={style:{"margin-left":"6px"}},qe={__name:"Webdav",setup(Oe){const{t:l,mergeLocaleMessage:Z}=Ve();Z("en",Ce),Z("pl",De);const q=c(!1),S=c([]);c([]);const C=c(["v3","v4"]),w=c(!0),y=c(!1),T=c(!1),L=c(!1),O=c("basic"),D=c(!1),H=c([]),P=c(null),m=c([]),se=c({label:"name",children:"children",isLeaf:"isLeaf",disabled:"disabled"}),z=c({installed:!1,version:"unknown",running:!1,active:!1}),o=c({enabled:!1,port:8080,protocol:"http",allowAnonymous:!1,readOnly:!1,maxConnections:50,shares:[],auth:{enabled:!0,users:[]},nfs:{enabled:!1,versions:["v3","v4"]}}),te=j(()=>z.value.running?"success":"danger"),oe=j(()=>z.value.running?"mdi:check-circle":"mdi:alert-circle"),ne=j(()=>z.value.running?l("webdav.running"):l("webdav.stopped")),K=window.location.hostname,G=j(()=>`${o.value.protocol}://${K}:${o.value.port}`),le=e=>{navigator.clipboard.writeText(e),I.success(l("webdav.copied_to_clipboard"))},Y=async()=>{try{y.value=!0;const e=z.value.running?"stop":"start",a=await k.post("/services/webdav/toggle",{action:e});a.data.success&&(await F(),f.success({title:l("webdav.success"),message:a.data.message}))}catch(e){f.error({title:l("webdav.error"),message:e.response?.data?.error||l("webdav.service_toggle_error")})}finally{y.value=!1}},re=async()=>{try{y.value=!0;const e=await k.post("/services/webdav/toggle",{action:"restart"});e.data.success&&(await F(),f.success({title:l("webdav.success"),message:e.data.message}))}catch(e){f.error({title:l("webdav.error"),message:e.response?.data?.error||l("webdav.service_restart_error")})}finally{y.value=!1}},ie=async()=>{try{T.value=!0;const e={...o.value,nfs:{enabled:C.value.length>0,versions:C.value}},a=await k.post("/services/webdav/config",{config:e});a.data.success&&(f.success({title:l("webdav.success"),message:a.data.message}),await M())}catch(e){f.error({title:l("webdav.error"),message:e.response?.data?.error||l("webdav.config_save_error")})}finally{T.value=!1}},de=async()=>{try{L.value=!0,await M(!0),f.success({title:l("webdav.success"),message:l("webdav.config_reset")})}catch{f.error({title:l("webdav.error"),message:l("webdav.config_reset_error")})}finally{L.value=!1}},F=async()=>{try{w.value=!0;const e=await k.get("/services/webdav/status");z.value=e.data,q.value=e.data.running}catch{f.error({title:l("webdav.error"),message:l("webdav.status_fetch_error")})}finally{w.value=!1}},M=async(e=!1)=>{try{w.value=!0;const a=await k.get("/services/webdav/config");a.data.success&&(o.value=a.data.config,C.value=a.data.config.nfs?.versions||["v3","v4"],await ce())}catch{f.error({title:l("webdav.error"),message:l("webdav.config_fetch_error")})}finally{w.value=!1}},ce=async()=>{try{w.value=!0;const e=await k.get("/services/webdav/available-disks");if(e.data.success)S.value=e.data.data.map(a=>({name:a.name,path:a.mountpoint,size:be(a.size),fsType:a.fstype||"unknown",model:a.model,isSystem:a.isSystem,shared:o.value.shares?.some(i=>i.path===a.mountpoint)||!1})),S.value.length===0&&f.warning({title:l("webdav.warning"),message:l("webdav.no_disks_found"),duration:5e3});else throw new Error(e.data.error||"No disks available")}catch(e){console.error("Error fetching disks:",e),f.error({title:l("webdav.error"),message:l("webdav.disk_fetch_error"),duration:5e3})}finally{w.value=!1}},ue=e=>{o.value.shares||(o.value.shares=[]),e.shared?o.value.shares.some(a=>a.path===e.path)||o.value.shares.push({path:e.path,alias:e.name,read_only:!1,auth_required:!0}):(o.value.shares=o.value.shares.filter(a=>a.path!==e.path),m.value.length>0&&(m.value=m.value.filter(a=>!a.startsWith(e.path))))},ve=e=>{P.value=e,H.value=[{name:e.path,path:e.path,isLeaf:!1,children:[]}],m.value=[],D.value=!0},pe=async(e,a)=>{if(e.level===0)return a([{name:P.value.path,path:P.value.path,isLeaf:!1}]);try{const h=(await k.post("/api/filesystems/list-directories",{path:e.data.path})).data.directories.map(b=>({name:b.name,path:b.path,isLeaf:b.isLeaf}));a(h)}catch(i){console.error("Error loading directories:",i),a([])}},_e=(e,{checkedKeys:a})=>{m.value=a},fe=()=>{if(m.value.length>0){o.value.shares||(o.value.shares=[]),m.value.forEach(a=>{o.value.shares.some(i=>i.path===a)||o.value.shares.push({path:a,alias:a.split("/").pop(),read_only:!1,auth_required:!0})});const e=S.value.map(a=>a.path);m.value.forEach(a=>{if(e.includes(a)){const i=S.value.find(h=>h.path===a);i&&(i.shared=!0)}}),D.value=!1,I.success(l("webdav.directories_added"))}else I.warning(l("webdav.no_directories_selected"))},be=e=>{if(!e)return"0 B";const a=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,i)).toFixed(1))} ${a[i]}`};return $e(()=>{F(),M()}),(e,a)=>{const i=r("el-icon"),h=r("el-tag"),b=r("el-descriptions-item"),J=r("el-descriptions"),g=r("el-button"),V=r("el-card"),N=r("el-switch"),Q=r("el-input-number"),B=r("el-form-item"),X=r("el-radio-button"),me=r("el-radio-group"),x=r("el-form"),E=r("el-tab-pane"),U=r("el-checkbox"),ge=r("el-checkbox-group"),$=r("el-table-column"),ee=r("el-tooltip"),we=r("el-table"),ye=r("el-tabs"),he=r("el-tree"),ke=r("el-dialog");return A(),R(Se,null,[u("div",Be,[s(V,{shadow:"hover",class:"status-card"},{header:t(()=>[u("div",Ue,[s(i,{size:"24",class:"webdav-icon"},{default:t(()=>[s(p(_),{icon:"mdi:web"})]),_:1}),a[11]||(a[11]=u("span",null,"WebDAV Service",-1))])]),default:t(()=>[w.value?(A(),R("div",Ae,[s(i,{size:32,class:"is-loading"},{default:t(()=>[s(p(_),{icon:"mdi:loading"})]),_:1})])):(A(),R("div",Ne,[s(J,{column:1,border:""},{default:t(()=>[s(b,{label:e.$t("webdav.status")},{default:t(()=>[s(h,{type:te.value},{default:t(()=>[s(i,{size:16},{default:t(()=>[s(p(_),{icon:oe.value},null,8,["icon"])]),_:1}),d(" "+v(ne.value),1)]),_:1},8,["type"])]),_:1},8,["label"]),s(b,{label:e.$t("webdav.version")},{default:t(()=>[d(v(z.value.version||"unknown"),1)]),_:1},8,["label"]),s(b,{label:e.$t("webdav.port")},{default:t(()=>[d(v(o.value.port),1)]),_:1},8,["label"]),s(b,{label:e.$t("webdav.protocol")},{default:t(()=>[d(v(o.value.protocol.toUpperCase()),1)]),_:1},8,["label"])]),_:1}),u("div",Ee,[q.value?(A(),ae(g,{key:1,type:"danger",onClick:Y,loading:y.value,plain:"",round:""},{icon:t(()=>[s(i,null,{default:t(()=>[s(p(_),{icon:"mdi:stop"})]),_:1})]),default:t(()=>[d(" "+v(e.$t("webdav.stop_service")),1)]),_:1},8,["loading"])):(A(),ae(g,{key:0,type:"success",onClick:Y,loading:y.value,plain:"",round:""},{icon:t(()=>[s(i,null,{default:t(()=>[s(p(_),{icon:"mdi:play"})]),_:1})]),default:t(()=>[d(" "+v(e.$t("webdav.start_service")),1)]),_:1},8,["loading"])),s(g,{type:"warning",onClick:re,loading:y.value,plain:"",round:""},{icon:t(()=>[s(i,null,{default:t(()=>[s(p(_),{icon:"mdi:restart"})]),_:1})]),default:t(()=>[d(" "+v(e.$t("webdav.restart_service")),1)]),_:1},8,["loading"])])]))]),_:1}),s(ye,{modelValue:O.value,"onUpdate:modelValue":a[7]||(a[7]=n=>O.value=n),class:"config-tabs"},{default:t(()=>[s(E,{label:e.$t("webdav.basic_config"),name:"basic"},{default:t(()=>[s(V,{shadow:"hover",class:"config-card"},{default:t(()=>[u("div",We,[s(N,{modelValue:o.value.enabled,"onUpdate:modelValue":a[0]||(a[0]=n=>o.value.enabled=n),"active-text":e.$t("webdav.enable_service"),"inline-prompt":"","active-color":"#13ce66"},null,8,["modelValue","active-text"])]),u("div",je,[s(x,{"label-position":"top"},{default:t(()=>[s(B,{label:e.$t("webdav.port")},{default:t(()=>[s(Q,{modelValue:o.value.port,"onUpdate:modelValue":a[1]||(a[1]=n=>o.value.port=n),min:1,max:65535,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"]),s(B,{label:e.$t("webdav.protocol")},{default:t(()=>[s(me,{modelValue:o.value.protocol,"onUpdate:modelValue":a[2]||(a[2]=n=>o.value.protocol=n)},{default:t(()=>[s(X,{value:"http"},{default:t(()=>a[12]||(a[12]=[d("HTTP")])),_:1,__:[12]}),s(X,{value:"https"},{default:t(()=>a[13]||(a[13]=[d("HTTPS")])),_:1,__:[13]})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})])]),_:1})]),_:1},8,["label"]),s(E,{label:e.$t("webdav.nfs_versions"),name:"nfs"},{default:t(()=>[s(V,{shadow:"hover",class:"config-card"},{default:t(()=>[u("div",Te,[s(ge,{modelValue:C.value,"onUpdate:modelValue":a[3]||(a[3]=n=>C.value=n)},{default:t(()=>[s(U,{value:"v2"},{default:t(()=>a[14]||(a[14]=[d("NFSv2")])),_:1,__:[14]}),s(U,{value:"v3"},{default:t(()=>a[15]||(a[15]=[d("NFSv3")])),_:1,__:[15]}),s(U,{value:"v4"},{default:t(()=>a[16]||(a[16]=[d("NFSv4")])),_:1,__:[16]}),s(U,{value:"v4_1"},{default:t(()=>a[17]||(a[17]=[d("NFSv4.1")])),_:1,__:[17]}),s(U,{value:"v4_2"},{default:t(()=>a[18]||(a[18]=[d("NFSv4.2")])),_:1,__:[18]})]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["label"]),s(E,{label:e.$t("webdav.disk_selection"),name:"disks"},{default:t(()=>[s(V,{shadow:"hover",class:"config-card"},{default:t(()=>[u("div",Le,[s(we,{data:S.value,style:{width:"100%"}},{default:t(()=>[s($,{prop:"name",label:e.$t("webdav.disk_name")},null,8,["label"]),s($,{prop:"path",label:e.$t("webdav.mount_point")},null,8,["label"]),s($,{prop:"size",label:e.$t("webdav.size")},null,8,["label"]),s($,{prop:"fsType",label:e.$t("webdav.fs_type")},null,8,["label"]),s($,{label:e.$t("webdav.shared"),width:"120"},{default:t(n=>[s(ee,{content:e.$t("webdav.toggle_disk_share"),placement:"top"},{default:t(()=>[s(N,{modelValue:n.row.shared,"onUpdate:modelValue":W=>n.row.shared=W,onChange:W=>ue(n.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["content"])]),_:1},8,["label"]),s($,{label:e.$t("webdav.actions"),width:"120"},{default:t(n=>[s(ee,{content:e.$t("webdav.browse"),placement:"top"},{default:t(()=>[s(g,{size:"small",onClick:W=>ve(n.row),circle:""},{default:t(()=>[s(p(_),{icon:"mdi:magnify"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])])]),_:1})]),_:1},8,["label"]),s(E,{label:e.$t("webdav.advanced_settings"),name:"advanced"},{default:t(()=>[s(V,{shadow:"hover",class:"config-card"},{default:t(()=>[u("div",Pe,[s(x,{"label-position":"top"},{default:t(()=>[s(B,{label:e.$t("webdav.allow_anonymous")},{default:t(()=>[s(N,{modelValue:o.value.allowAnonymous,"onUpdate:modelValue":a[4]||(a[4]=n=>o.value.allowAnonymous=n),"inline-prompt":"","active-text":e.$t("webdav.yes"),"inactive-text":e.$t("webdav.no")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"]),s(B,{label:e.$t("webdav.read_only")},{default:t(()=>[s(N,{modelValue:o.value.readOnly,"onUpdate:modelValue":a[5]||(a[5]=n=>o.value.readOnly=n),"inline-prompt":"","active-text":e.$t("webdav.yes"),"inactive-text":e.$t("webdav.no")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"]),s(B,{label:e.$t("webdav.max_connections")},{default:t(()=>[s(Q,{modelValue:o.value.maxConnections,"onUpdate:modelValue":a[6]||(a[6]=n=>o.value.maxConnections=n),min:1,"controls-position":"right"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"]),u("div",Fe,[s(g,{type:"primary",onClick:ie,loading:T.value,round:""},{default:t(()=>[s(p(_),{icon:"mdi:content-save"}),d(" "+v(e.$t("webdav.save_config")),1)]),_:1},8,["loading"]),s(g,{onClick:de,loading:L.value,round:""},{default:t(()=>[s(p(_),{icon:"mdi:backup-restore"}),d(" "+v(e.$t("webdav.reset")),1)]),_:1},8,["loading"])]),s(V,{shadow:"hover",class:"connection-card"},{header:t(()=>[u("div",Me,[s(p(_),{icon:"mdi:connection"}),u("span",null,v(e.$t("webdav.connection_info")),1)])]),default:t(()=>[u("div",Re,[s(J,{column:1},{default:t(()=>[s(b,{label:e.$t("webdav.server_address")},{default:t(()=>[s(h,null,{default:t(()=>[d(v(p(K)),1)]),_:1})]),_:1},8,["label"]),s(b,{label:e.$t("webdav.connection_url")},{default:t(()=>[s(h,{type:"info"},{default:t(()=>[d(v(G.value)+" ",1),s(i,{class:"copy-icon",onClick:a[8]||(a[8]=n=>le(G.value))},{default:t(()=>[s(p(_),{icon:"mdi:content-copy"})]),_:1})]),_:1})]),_:1},8,["label"])]),_:1})])]),_:1})]),s(ke,{modelValue:D.value,"onUpdate:modelValue":a[10]||(a[10]=n=>D.value=n),title:e.$t("webdav.select_directory"),width:"60%"},{footer:t(()=>[s(g,{onClick:a[9]||(a[9]=n=>D.value=!1)},{default:t(()=>[d(v(e.$t("webdav.cancel")),1)]),_:1}),s(g,{type:"primary",onClick:fe},{default:t(()=>[d(v(e.$t("webdav.confirm")),1)]),_:1})]),default:t(()=>[s(he,{data:H.value,props:se.value,load:pe,lazy:"","show-checkbox":"","node-key":"path",onCheck:_e},{default:t(({node:n,data:W})=>[u("span",Ie,[s(p(_),{icon:n.isLeaf?"mdi:folder-outline":"mdi:folder-open-outline"},null,8,["icon"]),u("span",Ze,v(n.label),1)])]),_:1},8,["data","props"])]),_:1},8,["modelValue","title"])],64)}}},Ke=ze(qe,[["__scopeId","data-v-cce7fccb"]]);export{Ke as default};
